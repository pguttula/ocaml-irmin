test/list/outlist.ml
==>
[{pstr_desc =
   Pstr_modtype
    {pmtd_name = {txt = "ATOM"};
     pmtd_type =
      Some
       {pmty_desc =
         Pmty_signature
          [{psig_desc =
             Psig_type (Recursive,
              [{ptype_name = {txt = "t"}; ptype_params = [];
                ptype_cstrs = []; ptype_kind = Ptype_abstract;
                ptype_private = Public; ptype_manifest = None}])};
           {psig_desc =
             Psig_value
              {pval_name = {txt = "t"};
               pval_type =
                {ptyp_desc =
                  Ptyp_constr
                   ({txt = Ldot (Ldot (Lident "Irmin", "Type"), "t")},
                   [{ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])}])};
               pval_prim = []}};
           {psig_desc =
             Psig_value
              {pval_name = {txt = "to_string"};
               pval_type =
                {ptyp_desc =
                  Ptyp_arrow (Nolabel,
                   {ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])},
                   {ptyp_desc = Ptyp_constr ({txt = Lident "string"}, [])})};
               pval_prim = []}};
           {psig_desc =
             Psig_value
              {pval_name = {txt = "of_string"};
               pval_type =
                {ptyp_desc =
                  Ptyp_arrow (Nolabel,
                   {ptyp_desc = Ptyp_constr ({txt = Lident "string"}, [])},
                   {ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])})};
               pval_prim = []}};
           {psig_desc =
             Psig_include
              {pincl_mod =
                {pmty_desc =
                  Pmty_with
                   ({pmty_desc =
                      Pmty_ident {txt = Ldot (Lident "Msigs", "RESOLVEABLE")}},
                   [Pwith_typesubst ({txt = Lident "t"},
                     {ptype_name = {txt = "t"}; ptype_params = [];
                      ptype_cstrs = []; ptype_kind = Ptype_abstract;
                      ptype_private = Public;
                      ptype_manifest =
                       Some
                        {ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])}})])}}}]}}};
 {pstr_desc =
   Pstr_module
    {pmb_name = {txt = "List"};
     pmb_expr =
      {pmod_desc =
        Pmod_functor ({txt = "Atom"},
         Some {pmty_desc = Pmty_ident {txt = Lident "ATOM"}},
         {pmod_desc =
           Pmod_structure
            [{pstr_desc =
               Pstr_type (Recursive,
                [{ptype_name = {txt = "atom"}; ptype_params = [];
                  ptype_cstrs = []; ptype_kind = Ptype_abstract;
                  ptype_private = Public;
                  ptype_manifest =
                   Some
                    {ptyp_desc =
                      Ptyp_constr ({txt = Ldot (Lident "Atom", "t")}, [])};
                  ptype_attributes =
                   [({txt = "derive"},
                     PStr
                      [{pstr_desc =
                         Pstr_eval
                          ({pexp_desc = Pexp_ident {txt = Lident "ezjsonm"}},
                          ...)}])]}])};
             {pstr_desc =
               Pstr_type (Recursive,
                [{ptype_name = {txt = "t"}; ptype_params = [];
                  ptype_cstrs = []; ptype_kind = Ptype_abstract;
                  ptype_private = Public;
                  ptype_manifest =
                   Some
                    {ptyp_desc =
                      Ptyp_constr ({txt = Lident "list"},
                       [{ptyp_desc = Ptyp_constr ({txt = Lident "atom"}, [])}])};
                  ptype_attributes =
                   [({txt = "derive"},
                     PStr
                      [{pstr_desc =
                         Pstr_eval
                          ({pexp_desc = Pexp_ident {txt = Lident "versioned"}},
                          ...)}])]}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "empty"}};
                  pvb_expr =
                   {pexp_desc = Pexp_construct ({txt = Lident "[]"}, None)}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "length"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc =
                        Ppat_constraint ({ppat_desc = Ppat_var {txt = "x"}},
                         {ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])})},
                      {pexp_desc =
                        Pexp_apply
                         ({pexp_desc =
                            Pexp_ident {txt = Ldot (Lident "List", "length")}},
                         [(Nolabel,
                           {pexp_desc = Pexp_ident {txt = Lident "x"}})])})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "split_at"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "l"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "i"}},
                         {pexp_desc =
                           Pexp_ifthenelse
                            ({pexp_desc =
                               Pexp_apply
                                ({pexp_desc = Pexp_ident {txt = Lident ">"}},
                                [(Nolabel,
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt =
                                           Ldot (Lident "List", "length")}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "l"}})])});
                                 (Nolabel,
                                  {pexp_desc = Pexp_ident {txt = Lident "i"}})])},
                            {pexp_desc =
                              Pexp_let (Recursive,
                               [{pvb_pat =
                                  {ppat_desc = Ppat_var {txt = "aux"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_fun (Nolabel, None,
                                     {ppat_desc = Ppat_var {txt = "xs"}},
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc = Ppat_var {txt = "i"}},
                                        {pexp_desc =
                                          Pexp_fun (Nolabel, None,
                                           {ppat_desc =
                                             Ppat_var {txt = "acc"}},
                                           {pexp_desc =
                                             Pexp_ifthenelse
                                              ({pexp_desc =
                                                 Pexp_apply
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident ">="}},
                                                  [(Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "i"}});
                                                   (Nolabel,
                                                    {pexp_desc =
                                                      Pexp_constant
                                                       (Pconst_integer ("0",
                                                         None))})])},
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "aux"}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Ldot
                                                             (Lident "List",
                                                             "tl")}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "xs"}})])});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident "-"}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "i"}});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_constant
                                                           (Pconst_integer
                                                             ("1", None))})])});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_construct
                                                      ({txt = Lident "::"},
                                                      Some
                                                       {pexp_desc =
                                                         Pexp_tuple
                                                          [{pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "List",
                                                                    "hd")}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "xs"}})])};
                                                           {pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "acc"}}]})})])},
                                              Some
                                               {pexp_desc =
                                                 Pexp_tuple
                                                  [{pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "acc"}};
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "xs"}}]})})})})}}],
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident {txt = Lident "aux"}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "l"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "i"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_construct ({txt = Lident "[]"},
                                       None)})])})},
                            Some
                             {pexp_desc =
                               Pexp_apply
                                ({pexp_desc =
                                   Pexp_ident {txt = Lident "raise"}},
                                [(Nolabel,
                                  {pexp_desc =
                                    Pexp_construct
                                     ({txt = Lident "Invalid_argument"},
                                     Some
                                      {pexp_desc =
                                        Pexp_constant
                                         (Pconst_string
                                           ("out of bound index", None))})})])})})})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "insert"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "l"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "i"}},
                         {pexp_desc =
                           Pexp_fun (Nolabel, None,
                            {ppat_desc = Ppat_var {txt = "a"}},
                            {pexp_desc =
                              Pexp_ifthenelse
                               ({pexp_desc =
                                  Pexp_apply
                                   ({pexp_desc =
                                      Pexp_ident {txt = Lident "="}},
                                   [(Nolabel,
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident
                                            {txt =
                                              Ldot (Lident "List", "length")}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "l"}})])});
                                    (Nolabel,
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "i"}})])},
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident
                                      {txt = Ldot (Lident "List", "append")}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "l"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_construct ({txt = Lident "::"},
                                       Some
                                        {pexp_desc =
                                          Pexp_tuple
                                           [{pexp_desc =
                                              Pexp_ident {txt = Lident "a"}};
                                            {pexp_desc =
                                              Pexp_construct
                                               ({txt = Lident "[]"}, None)}]})})])},
                               Some
                                {pexp_desc =
                                  Pexp_let (Nonrecursive,
                                   [{pvb_pat =
                                      {ppat_desc =
                                        Ppat_tuple
                                         [{ppat_desc = Ppat_var {txt = "rxs"}};
                                          {ppat_desc = Ppat_var {txt = "ys"}}]};
                                     pvb_expr =
                                      {pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident
                                             {txt = Lident "split_at"}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "l"}});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "i"}})])}}],
                                   {pexp_desc =
                                     Pexp_let (Nonrecursive,
                                      [{pvb_pat =
                                         {ppat_desc = Ppat_var {txt = "ixs"}};
                                        pvb_expr =
                                         {pexp_desc =
                                           Pexp_match
                                            ({pexp_desc =
                                               Pexp_ident
                                                {txt = Lident "rxs"}},
                                            [{pc_lhs =
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "[]"}, None)};
                                              pc_guard = None;
                                              pc_rhs =
                                               {pexp_desc =
                                                 Pexp_construct
                                                  ({txt = Lident "::"},
                                                  Some
                                                   {pexp_desc =
                                                     Pexp_tuple
                                                      [{pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident "a"}};
                                                       {pexp_desc =
                                                         Pexp_construct
                                                          ({txt = Lident "[]"},
                                                          None)}]})}};
                                             {pc_lhs =
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "::"},
                                                  Some
                                                   {ppat_desc =
                                                     Ppat_tuple
                                                      [{ppat_desc =
                                                         Ppat_var {txt = "x"}};
                                                       {ppat_desc =
                                                         Ppat_construct
                                                          ({txt = Lident "[]"},
                                                          None)}]})};
                                              pc_guard = None;
                                              pc_rhs =
                                               {pexp_desc =
                                                 Pexp_construct
                                                  ({txt = Lident "::"},
                                                  Some
                                                   {pexp_desc =
                                                     Pexp_tuple
                                                      [{pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident "x"}};
                                                       {pexp_desc =
                                                         Pexp_construct
                                                          ({txt = Lident "::"},
                                                          Some
                                                           {pexp_desc =
                                                             Pexp_tuple
                                                              [{pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "a"}};
                                                               {pexp_desc =
                                                                 Pexp_construct
                                                                  ({txt =
                                                                    Lident
                                                                    "[]"},
                                                                  None)}]})}]})}};
                                             {pc_lhs =
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "::"},
                                                  Some
                                                   {ppat_desc =
                                                     Ppat_tuple
                                                      [{ppat_desc =
                                                         Ppat_var {txt = "x"}};
                                                       {ppat_desc =
                                                         Ppat_var {txt = "y"}}]})};
                                              pc_guard = None;
                                              pc_rhs =
                                               {pexp_desc =
                                                 Pexp_construct
                                                  ({txt = Lident "::"},
                                                  Some
                                                   {pexp_desc =
                                                     Pexp_tuple
                                                      [{pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident "x"}};
                                                       {pexp_desc =
                                                         Pexp_construct
                                                          ({txt = Lident "::"},
                                                          Some
                                                           {pexp_desc =
                                                             Pexp_tuple
                                                              [{pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "a"}};
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "y"}}]})}]})}}])}}],
                                      {pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident
                                             {txt =
                                               Ldot (Lident "List",
                                                "rev_append")}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "ixs"}});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "ys"}})])})})})})})})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "get"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "l"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "i"}},
                         {pexp_desc =
                           Pexp_apply
                            ({pexp_desc =
                               Pexp_ident {txt = Ldot (Lident "List", "nth")}},
                            [(Nolabel,
                              {pexp_desc = Pexp_ident {txt = Lident "l"}});
                             (Nolabel,
                              {pexp_desc = Pexp_ident {txt = Lident "i"}})])})})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "set"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "l"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "i"}},
                         {pexp_desc =
                           Pexp_fun (Nolabel, None,
                            {ppat_desc = Ppat_var {txt = "a"}},
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat =
                                  {ppat_desc =
                                    Ppat_tuple
                                     [{ppat_desc = Ppat_var {txt = "rxs"}};
                                      {ppat_desc = Ppat_var {txt = "ys"}}]};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "split_at"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "l"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "i"}})])}}],
                               {pexp_desc =
                                 Pexp_let (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "sxs"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_construct ({txt = Lident "::"},
                                        Some
                                         {pexp_desc =
                                           Pexp_tuple
                                            [{pexp_desc =
                                               Pexp_ident {txt = Lident "a"}};
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt =
                                                      Ldot (Lident "List",
                                                       "tl")}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "rxs"}})])}]})}}],
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt =
                                           Ldot (Lident "List", "rev_append")}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "sxs"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "ys"}})])})})})})})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "delete"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "l"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "i"}},
                         {pexp_desc =
                           Pexp_let (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc = Ppat_var {txt = "rxs"}};
                                   {ppat_desc = Ppat_var {txt = "ys"}}]};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident {txt = Lident "split_at"}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "l"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "i"}})])}}],
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat =
                                  {ppat_desc = Ppat_var {txt = "dxs"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt = Ldot (Lident "List", "tl")}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "rxs"}})])}}],
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident
                                      {txt =
                                        Ldot (Lident "List", "rev_append")}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "dxs"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "ys"}})])})})})})}}])};
             {pstr_desc =
               Pstr_type (Recursive,
                [{ptype_name = {txt = "edit"}; ptype_params = [];
                  ptype_cstrs = [];
                  ptype_kind =
                   Ptype_variant
                    [{pcd_name = {txt = "Ins"};
                      pcd_args =
                       Pcstr_tuple
                        [{ptyp_desc = Ptyp_constr ({txt = Lident "int"}, [])};
                         {ptyp_desc = Ptyp_constr ({txt = Lident "atom"}, [])}];
                      pcd_res = None};
                     {pcd_name = {txt = "Del"};
                      pcd_args =
                       Pcstr_tuple
                        [{ptyp_desc = Ptyp_constr ({txt = Lident "int"}, [])};
                         {ptyp_desc = Ptyp_constr ({txt = Lident "atom"}, [])}];
                      pcd_res = None};
                     {pcd_name = {txt = "Rep"};
                      pcd_args =
                       Pcstr_tuple
                        [{ptyp_desc = Ptyp_constr ({txt = Lident "int"}, [])};
                         {ptyp_desc = Ptyp_constr ({txt = Lident "atom"}, [])};
                         {ptyp_desc = Ptyp_constr ({txt = Lident "atom"}, [])}];
                      pcd_res = None}];
                  ptype_private = Public; ptype_manifest = None}])};
             {pstr_desc =
               Pstr_type (Recursive,
                [{ptype_name = {txt = "patch"}; ptype_params = [];
                  ptype_cstrs = []; ptype_kind = Ptype_abstract;
                  ptype_private = Public;
                  ptype_manifest =
                   Some
                    {ptyp_desc =
                      Ptyp_constr ({txt = Lident "list"},
                       [{ptyp_desc = Ptyp_constr ({txt = Lident "edit"}, [])}])}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "edit_to_string"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "atom_to_string"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Ins"},
                               Some
                                {ppat_desc =
                                  Ppat_tuple
                                   [{ppat_desc = Ppat_var {txt = "i"}};
                                    {ppat_desc = Ppat_var {txt = "a"}}]})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident
                                   {txt = Ldot (Lident "Printf", "sprintf")}},
                               [(Nolabel,
                                 {pexp_desc =
                                   Pexp_constant
                                    (Pconst_string ("Ins (%i, %s)", None))});
                                (Nolabel,
                                 {pexp_desc = Pexp_ident {txt = Lident "i"}});
                                (Nolabel,
                                 {pexp_desc =
                                   Pexp_apply
                                    ({pexp_desc =
                                       Pexp_ident
                                        {txt = Lident "atom_to_string"}},
                                    [(Nolabel,
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "a"}})])})])}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Del"},
                               Some
                                {ppat_desc =
                                  Ppat_tuple
                                   [{ppat_desc = Ppat_var {txt = "i"}};
                                    {ppat_desc = Ppat_var {txt = "a"}}]})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident
                                   {txt = Ldot (Lident "Printf", "sprintf")}},
                               [(Nolabel,
                                 {pexp_desc =
                                   Pexp_constant
                                    (Pconst_string ("Del (%i, %s)", None))});
                                (Nolabel,
                                 {pexp_desc = Pexp_ident {txt = Lident "i"}});
                                (Nolabel,
                                 {pexp_desc =
                                   Pexp_apply
                                    ({pexp_desc =
                                       Pexp_ident
                                        {txt = Lident "atom_to_string"}},
                                    [(Nolabel,
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "a"}})])})])}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Rep"},
                               Some
                                {ppat_desc =
                                  Ppat_tuple
                                   [{ppat_desc = Ppat_var {txt = "i"}};
                                    {ppat_desc = Ppat_var {txt = "a"}};
                                    {ppat_desc = Ppat_var {txt = "b"}}]})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident
                                   {txt = Ldot (Lident "Printf", "sprintf")}},
                               [(Nolabel,
                                 {pexp_desc =
                                   Pexp_constant
                                    (Pconst_string ("Rep (%i, %s, %s)", None))});
                                (Nolabel,
                                 {pexp_desc = Pexp_ident {txt = Lident "i"}});
                                (Nolabel,
                                 {pexp_desc =
                                   Pexp_apply
                                    ({pexp_desc =
                                       Pexp_ident
                                        {txt = Lident "atom_to_string"}},
                                    [(Nolabel,
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "a"}})])});
                                (Nolabel,
                                 {pexp_desc =
                                   Pexp_apply
                                    ({pexp_desc =
                                       Pexp_ident
                                        {txt = Lident "atom_to_string"}},
                                    [(Nolabel,
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "b"}})])})])}}]})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "op_diff"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "xs"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "ys"}},
                         {pexp_desc =
                           Pexp_let (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "cache"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident
                                      {txt = Ldot (Lident "Array", "init")}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_apply
                                       ({pexp_desc =
                                          Pexp_ident {txt = Lident "+"}},
                                       [(Nolabel,
                                         {pexp_desc =
                                           Pexp_apply
                                            ({pexp_desc =
                                               Pexp_ident
                                                {txt = Lident "length"}},
                                            [(Nolabel,
                                              {pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "xs"}})])});
                                        (Nolabel,
                                         {pexp_desc =
                                           Pexp_constant
                                            (Pconst_integer ("1", None))})])});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_fun (Nolabel, None,
                                       {ppat_desc = Ppat_any},
                                       {pexp_desc =
                                         Pexp_apply
                                          ({pexp_desc =
                                             Pexp_ident
                                              {txt =
                                                Ldot (Lident "Array", "make")}},
                                          [(Nolabel,
                                            {pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "+"}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Lident "length"}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "ys"}})])});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_constant
                                                    (Pconst_integer ("1",
                                                      None))})])});
                                           (Nolabel,
                                            {pexp_desc =
                                              Pexp_construct
                                               ({txt = Lident "None"}, None)})])})})])}}],
                            {pexp_desc =
                              Pexp_let (Recursive,
                               [{pvb_pat =
                                  {ppat_desc = Ppat_var {txt = "loop"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_fun (Nolabel, None,
                                     {ppat_desc = Ppat_var {txt = "i"}},
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc = Ppat_var {txt = "j"}},
                                        {pexp_desc =
                                          Pexp_let (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "cache_i"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt =
                                                       Ldot (Lident "Array",
                                                        "unsafe_get")}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "cache"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "i"}})])}}],
                                           {pexp_desc =
                                             Pexp_let (Nonrecursive,
                                              [{pvb_pat =
                                                 {ppat_desc =
                                                   Ppat_var {txt = "min3"}};
                                                pvb_expr =
                                                 {pexp_desc =
                                                   Pexp_fun (Nolabel, None,
                                                    {ppat_desc =
                                                      Ppat_var {txt = "x"}},
                                                    {pexp_desc =
                                                      Pexp_fun (Nolabel,
                                                       None,
                                                       {ppat_desc =
                                                         Ppat_var {txt = "y"}},
                                                       {pexp_desc =
                                                         Pexp_fun (Nolabel,
                                                          None,
                                                          {ppat_desc =
                                                            Ppat_var
                                                             {txt = "z"}},
                                                          {pexp_desc =
                                                            Pexp_let
                                                             (Nonrecursive,
                                                             [{pvb_pat =
                                                                {ppat_desc =
                                                                  Ppat_var
                                                                   {txt =
                                                                    "m'"}};
                                                               pvb_expr =
                                                                {pexp_desc =
                                                                  Pexp_fun
                                                                   (Nolabel,
                                                                   None,
                                                                   {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "a"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "al"}}]},
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "b"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "bl"}}]},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ifthenelse
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "<"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}})])},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "al"}}]},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "bl"}}]})})})}}],
                                                             {pexp_desc =
                                                               Pexp_apply
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m'"}},
                                                                [(Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m'"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})])});
                                                                 (Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "z"}})])})})})})}}],
                                              {pexp_desc =
                                                Pexp_match
                                                 ({pexp_desc =
                                                    Pexp_apply
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Ldot
                                                            (Lident "Array",
                                                            "unsafe_get")}},
                                                     [(Nolabel,
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "cache_i"}});
                                                      (Nolabel,
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident "j"}})])},
                                                 [{pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_construct
                                                       ({txt = Lident "Some"},
                                                       Some
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "v"}})};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "v"}}};
                                                  {pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_construct
                                                       ({txt = Lident "None"},
                                                       None)};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_let (Nonrecursive,
                                                       [{pvb_pat =
                                                          {ppat_desc =
                                                            Ppat_var
                                                             {txt = "res"}};
                                                         pvb_expr =
                                                          {pexp_desc =
                                                            Pexp_match
                                                             ({pexp_desc =
                                                                Pexp_tuple
                                                                 [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}};
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "j"}}]},
                                                             [{pc_lhs =
                                                                {ppat_desc =
                                                                  Ppat_tuple
                                                                   [{ppat_desc
                                                                    =
                                                                    Ppat_constant
                                                                    (Pconst_integer
                                                                    ("0",
                                                                    None))};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_constant
                                                                    (Pconst_integer
                                                                    ("0",
                                                                    None))}]};
                                                               pc_guard =
                                                                None;
                                                               pc_rhs =
                                                                {pexp_desc =
                                                                  Pexp_tuple
                                                                   [{pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("0",
                                                                    None))};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "[]"},
                                                                    None)}]}};
                                                              {pc_lhs =
                                                                {ppat_desc =
                                                                  Ppat_tuple
                                                                   [{ppat_desc
                                                                    =
                                                                    Ppat_constant
                                                                    (Pconst_integer
                                                                    ("0",
                                                                    None))};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "j"}}]};
                                                               pc_guard =
                                                                None;
                                                               pc_rhs =
                                                                {pexp_desc =
                                                                  Pexp_let
                                                                   (Nonrecursive,
                                                                   [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "d"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "e"}}]};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "loop"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("0",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "j"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])})])}}],
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "d"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Ins"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "get"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ys"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "j"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])})])}]})};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "e"}}]})}]})}};
                                                              {pc_lhs =
                                                                {ppat_desc =
                                                                  Ppat_tuple
                                                                   [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "i"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_constant
                                                                    (Pconst_integer
                                                                    ("0",
                                                                    None))}]};
                                                               pc_guard =
                                                                None;
                                                               pc_rhs =
                                                                {pexp_desc =
                                                                  Pexp_let
                                                                   (Nonrecursive,
                                                                   [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "d"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "e"}}]};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "loop"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("0",
                                                                    None))})])}}],
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "d"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Del"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "get"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "xs"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])})])}]})};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "e"}}]})}]})}};
                                                              {pc_lhs =
                                                                {ppat_desc =
                                                                  Ppat_any};
                                                               pc_guard =
                                                                None;
                                                               pc_rhs =
                                                                {pexp_desc =
                                                                  Pexp_let
                                                                   (Nonrecursive,
                                                                   [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "xsim1"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "get"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "xs"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])})])}}],
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "ysim1"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "get"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ys"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "j"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "d"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "e"}}]};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "loop"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "j"}})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "r1"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "d"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Del"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "xsim1"}}]})};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "e"}}]})}]}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "d"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "e"}}]};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "loop"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "j"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "r2"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "d"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Ins"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ysim1"}}]})};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "e"}}]})}]}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "d"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "e"}}]};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "loop"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "j"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "r3"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ifthenelse
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "xsim1"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ysim1"}})])},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "d"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "e"}}]},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "d"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Rep"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "xsim1"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ysim1"}}]})};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "e"}}]})}]})}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "min3"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "r1"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "r2"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "r3"}})])})})})})})})})})}}])}}],
                                                       {pexp_desc =
                                                         Pexp_sequence
                                                          ({pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Array",
                                                                    "unsafe_set")}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "cache_i"}});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "j"}});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_construct
                                                                   ({txt =
                                                                    Lident
                                                                    "Some"},
                                                                   Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "res"}})})])},
                                                          {pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "res"}})})}}])})})})})}}],
                               {pexp_desc =
                                 Pexp_let (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc =
                                       Ppat_tuple
                                        [{ppat_desc = Ppat_any};
                                         {ppat_desc = Ppat_var {txt = "e"}}]};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "loop"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "length"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "xs"}})])});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "length"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "ys"}})])})])}}],
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt = Ldot (Lident "List", "rev")}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "e"}})])})})})})})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "index"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_function
                      [{pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Ins"},
                            Some
                             {ppat_desc =
                               Ppat_tuple
                                [{ppat_desc = Ppat_var {txt = "i"}};
                                 {ppat_desc = Ppat_any}]})};
                        pc_guard = None;
                        pc_rhs = {pexp_desc = Pexp_ident {txt = Lident "i"}}};
                       {pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Del"},
                            Some
                             {ppat_desc =
                               Ppat_tuple
                                [{ppat_desc = Ppat_var {txt = "i"}};
                                 {ppat_desc = Ppat_any}]})};
                        pc_guard = None;
                        pc_rhs = {pexp_desc = Pexp_ident {txt = Lident "i"}}};
                       {pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Rep"},
                            Some
                             {ppat_desc =
                               Ppat_tuple
                                [{ppat_desc = Ppat_var {txt = "i"}};
                                 {ppat_desc = Ppat_any};
                                 {ppat_desc = Ppat_any}]})};
                        pc_guard = None;
                        pc_rhs = {pexp_desc = Pexp_ident {txt = Lident "i"}}}]}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "shift_edit"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "o"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Ins"},
                               Some
                                {ppat_desc =
                                  Ppat_tuple
                                   [{ppat_desc = Ppat_var {txt = "i"}};
                                    {ppat_desc = Ppat_var {txt = "x"}}]})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_construct ({txt = Lident "Ins"},
                               Some
                                {pexp_desc =
                                  Pexp_tuple
                                   [{pexp_desc =
                                      Pexp_apply
                                       ({pexp_desc =
                                          Pexp_ident {txt = Lident "+"}},
                                       [(Nolabel,
                                         {pexp_desc =
                                           Pexp_ident {txt = Lident "i"}});
                                        (Nolabel,
                                         {pexp_desc =
                                           Pexp_ident {txt = Lident "o"}})])};
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "x"}}]})}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Del"},
                               Some
                                {ppat_desc =
                                  Ppat_tuple
                                   [{ppat_desc = Ppat_var {txt = "i"}};
                                    {ppat_desc = Ppat_var {txt = "x"}}]})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_construct ({txt = Lident "Del"},
                               Some
                                {pexp_desc =
                                  Pexp_tuple
                                   [{pexp_desc =
                                      Pexp_apply
                                       ({pexp_desc =
                                          Pexp_ident {txt = Lident "+"}},
                                       [(Nolabel,
                                         {pexp_desc =
                                           Pexp_ident {txt = Lident "i"}});
                                        (Nolabel,
                                         {pexp_desc =
                                           Pexp_ident {txt = Lident "o"}})])};
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "x"}}]})}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Rep"},
                               Some
                                {ppat_desc =
                                  Ppat_tuple
                                   [{ppat_desc = Ppat_var {txt = "i"}};
                                    {ppat_desc = Ppat_var {txt = "x"}};
                                    {ppat_desc = Ppat_var {txt = "x'"}}]})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_construct ({txt = Lident "Rep"},
                               Some
                                {pexp_desc =
                                  Pexp_tuple
                                   [{pexp_desc =
                                      Pexp_apply
                                       ({pexp_desc =
                                          Pexp_ident {txt = Lident "+"}},
                                       [(Nolabel,
                                         {pexp_desc =
                                           Pexp_ident {txt = Lident "i"}});
                                        (Nolabel,
                                         {pexp_desc =
                                           Pexp_ident {txt = Lident "o"}})])};
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "x"}};
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "x'"}}]})}}]})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "shift_patch"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "acc"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "o"}},
                         {pexp_desc =
                           Pexp_function
                            [{pc_lhs =
                               {ppat_desc =
                                 Ppat_construct ({txt = Lident "[]"}, None)};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident
                                      {txt = Ldot (Lident "List", "rev")}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "acc"}})])}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_construct ({txt = Lident "::"},
                                  Some
                                   {ppat_desc =
                                     Ppat_tuple
                                      [{ppat_desc = Ppat_var {txt = "e"}};
                                       {ppat_desc = Ppat_var {txt = "tl"}}]})};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident {txt = Lident "shift_patch"}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_construct ({txt = Lident "::"},
                                       Some
                                        {pexp_desc =
                                          Pexp_tuple
                                           [{pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "shift_edit"}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "o"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "e"}})])};
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "acc"}}]})});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "o"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "tl"}})])}}]})})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "offset"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_function
                      [{pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Ins"},
                            Some {ppat_desc = Ppat_any})};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_constant (Pconst_integer ("1", None))}};
                       {pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Del"},
                            Some {ppat_desc = Ppat_any})};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_constant (Pconst_integer ("-1", None))}};
                       {pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Rep"},
                            Some {ppat_desc = Ppat_any})};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_constant (Pconst_integer ("0", None))}}]}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "op_transform"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "p"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "q"}},
                         {pexp_desc =
                           Pexp_let (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "cons2"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc =
                                    Ppat_tuple
                                     [{ppat_desc = Ppat_var {txt = "x"}};
                                      {ppat_desc = Ppat_var {txt = "y"}}]},
                                  {pexp_desc =
                                    Pexp_fun (Nolabel, None,
                                     {ppat_desc =
                                       Ppat_tuple
                                        [{ppat_desc = Ppat_var {txt = "xs"}};
                                         {ppat_desc = Ppat_var {txt = "ys"}}]},
                                     {pexp_desc =
                                       Pexp_tuple
                                        [{pexp_desc =
                                           Pexp_construct
                                            ({txt = Lident "::"},
                                            Some
                                             {pexp_desc =
                                               Pexp_tuple
                                                [{pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "x"}};
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "xs"}}]})};
                                         {pexp_desc =
                                           Pexp_construct
                                            ({txt = Lident "::"},
                                            Some
                                             {pexp_desc =
                                               Pexp_tuple
                                                [{pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "y"}};
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "ys"}}]})}]})})}}],
                            {pexp_desc =
                              Pexp_let (Recursive,
                               [{pvb_pat =
                                  {ppat_desc = Ppat_var {txt = "go"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_fun (Nolabel, None,
                                     {ppat_desc = Ppat_var {txt = "xs"}},
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc = Ppat_var {txt = "a"}},
                                        {pexp_desc =
                                          Pexp_fun (Nolabel, None,
                                           {ppat_desc = Ppat_var {txt = "ys"}},
                                           {pexp_desc =
                                             Pexp_fun (Nolabel, None,
                                              {ppat_desc =
                                                Ppat_var {txt = "b"}},
                                              {pexp_desc =
                                                Pexp_match
                                                 ({pexp_desc =
                                                    Pexp_tuple
                                                     [{pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "xs"}};
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "a"}};
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "ys"}};
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "b"}}]},
                                                 [{pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_tuple
                                                       [{ppat_desc =
                                                          Ppat_construct
                                                           ({txt =
                                                              Lident "[]"},
                                                           None)};
                                                        {ppat_desc = Ppat_any};
                                                        {ppat_desc =
                                                          Ppat_construct
                                                           ({txt =
                                                              Lident "[]"},
                                                           None)};
                                                        {ppat_desc = Ppat_any}]};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_tuple
                                                       [{pexp_desc =
                                                          Pexp_construct
                                                           ({txt =
                                                              Lident "[]"},
                                                           None)};
                                                        {pexp_desc =
                                                          Pexp_construct
                                                           ({txt =
                                                              Lident "[]"},
                                                           None)}]}};
                                                  {pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_tuple
                                                       [{ppat_desc =
                                                          Ppat_var
                                                           {txt = "xs"}};
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "a"}};
                                                        {ppat_desc =
                                                          Ppat_construct
                                                           ({txt =
                                                              Lident "[]"},
                                                           None)};
                                                        {ppat_desc = Ppat_any}]};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_tuple
                                                       [{pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "shift_patch"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_construct
                                                                ({txt =
                                                                   Lident
                                                                    "[]"},
                                                                None)});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "a"}});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "xs"}})])};
                                                        {pexp_desc =
                                                          Pexp_construct
                                                           ({txt =
                                                              Lident "[]"},
                                                           None)}]}};
                                                  {pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_tuple
                                                       [{ppat_desc =
                                                          Ppat_construct
                                                           ({txt =
                                                              Lident "[]"},
                                                           None)};
                                                        {ppat_desc = Ppat_any};
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "ys"}};
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "b"}}]};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_tuple
                                                       [{pexp_desc =
                                                          Pexp_construct
                                                           ({txt =
                                                              Lident "[]"},
                                                           None)};
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "shift_patch"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_construct
                                                                ({txt =
                                                                   Lident
                                                                    "[]"},
                                                                None)});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "b"}});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "ys"}})])}]}};
                                                  {pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_tuple
                                                       [{ppat_desc =
                                                          Ppat_construct
                                                           ({txt =
                                                              Lident "::"},
                                                           Some
                                                            {ppat_desc =
                                                              Ppat_tuple
                                                               [{ppat_desc =
                                                                  Ppat_var
                                                                   {txt = "x"}};
                                                                {ppat_desc =
                                                                  Ppat_var
                                                                   {txt =
                                                                    "xs"}}]})};
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "a"}};
                                                        {ppat_desc =
                                                          Ppat_construct
                                                           ({txt =
                                                              Lident "::"},
                                                           Some
                                                            {ppat_desc =
                                                              Ppat_tuple
                                                               [{ppat_desc =
                                                                  Ppat_var
                                                                   {txt = "y"}};
                                                                {ppat_desc =
                                                                  Ppat_var
                                                                   {txt =
                                                                    "ys"}}]})};
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "b"}}]};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_ifthenelse
                                                       ({pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "<"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_apply
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "index"}},
                                                                [(Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}})])});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_apply
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "index"}},
                                                                [(Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})])})])},
                                                       {pexp_desc =
                                                         Pexp_let
                                                          (Nonrecursive,
                                                          [{pvb_pat =
                                                             {ppat_desc =
                                                               Ppat_tuple
                                                                [{ppat_desc =
                                                                   Ppat_var
                                                                    {txt =
                                                                    "p'"}};
                                                                 {ppat_desc =
                                                                   Ppat_var
                                                                    {txt =
                                                                    "q'"}}]};
                                                            pvb_expr =
                                                             {pexp_desc =
                                                               Pexp_apply
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "go"}},
                                                                [(Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "xs"}});
                                                                 (Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}});
                                                                 (Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ys"}}]})});
                                                                 (Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "offset"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}})])})])})])}}],
                                                          {pexp_desc =
                                                            Pexp_tuple
                                                             [{pexp_desc =
                                                                Pexp_construct
                                                                 ({txt =
                                                                    Lident
                                                                    "::"},
                                                                 Some
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "shift_edit"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "p'"}}]})};
                                                              {pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "q'"}}]})},
                                                       Some
                                                        {pexp_desc =
                                                          Pexp_ifthenelse
                                                           ({pexp_desc =
                                                              Pexp_apply
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    ">"}},
                                                               [(Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "index"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}})])});
                                                                (Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "index"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})])})])},
                                                           {pexp_desc =
                                                             Pexp_let
                                                              (Nonrecursive,
                                                              [{pvb_pat =
                                                                 {ppat_desc =
                                                                   Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "p'"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "q'"}}]};
                                                                pvb_expr =
                                                                 {pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "go"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "xs"}}]})});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "offset"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})])})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ys"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}})])}}],
                                                              {pexp_desc =
                                                                Pexp_tuple
                                                                 [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "p'"}};
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "shift_edit"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "q'"}}]})}]})},
                                                           Some
                                                            {pexp_desc =
                                                              Pexp_match
                                                               ({pexp_desc =
                                                                  Pexp_tuple
                                                                   [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}}]},
                                                               [{pc_lhs =
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_any};
                                                                 pc_guard =
                                                                  Some
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})])};
                                                                 pc_rhs =
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "go"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "xs"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "offset"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})])})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ys"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "offset"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}})])})])})])}};
                                                                {pc_lhs =
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Ins"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "i"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "nx"}}]})};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Ins"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_any};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "ny"}}]})}]};
                                                                 pc_guard =
                                                                  None;
                                                                 pc_rhs =
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "n"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Atom",
                                                                    "resolve")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "nx"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ny"}})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cons2"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Rep"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ny"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "n"}}]})};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Rep"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "nx"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "n"}}]})}]});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "go"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "xs"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "offset"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})])})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ys"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "offset"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}})])})])})])})])})}};
                                                                {pc_lhs =
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Rep"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "i"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "anc"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "nx"}}]})};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Rep"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_any};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "ny"}}]})}]};
                                                                 pc_guard =
                                                                  None;
                                                                 pc_rhs =
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "n"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Atom",
                                                                    "merge3")}},
                                                                    [(Labelled
                                                                    "ancestor",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "anc"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "nx"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ny"}})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cons2"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Rep"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ny"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "n"}}]})};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Rep"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "nx"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "n"}}]})}]});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "go"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "xs"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ys"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}})])})])})}};
                                                                {pc_lhs =
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Ins"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any})};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any}]};
                                                                 pc_guard =
                                                                  None;
                                                                 pc_rhs =
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "p'"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "q'"}}]};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "go"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "xs"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ys"}}]})});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "offset"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}})])})])})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "shift_edit"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "p'"}}]})};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "q'"}}]})}};
                                                                {pc_lhs =
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_any};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Ins"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any})}]};
                                                                 pc_guard =
                                                                  None;
                                                                 pc_rhs =
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "p'"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "q'"}}]};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "go"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "xs"}}]})});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "offset"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})])})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ys"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "p'"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "shift_edit"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "q'"}}]})}]})}};
                                                                {pc_lhs =
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Rep"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "i"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "nx"}}]})};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Del"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any})}]};
                                                                 pc_guard =
                                                                  None;
                                                                 pc_rhs =
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "p'"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "q'"}}]};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "go"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "xs"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "offset"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})])})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ys"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "p'"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Del"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "nx"}}]})};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "q'"}}]})}]})}};
                                                                {pc_lhs =
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Del"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any})};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Rep"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "i"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "ny"}}]})}]};
                                                                 pc_guard =
                                                                  None;
                                                                 pc_rhs =
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "p'"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "q'"}}]};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "go"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "xs"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ys"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "offset"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}})])})])})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Del"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "i"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}})])};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ny"}}]})};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "p'"}}]})};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "q'"}}]})}};
                                                                {pc_lhs =
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Del"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any})};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Del"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any})}]};
                                                                 pc_guard =
                                                                  None;
                                                                 pc_rhs =
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "go"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "xs"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "offset"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})])})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ys"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "offset"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}})])})])})])}}])})})}}])})})})})}}],
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident {txt = Lident "go"}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "p"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_constant
                                       (Pconst_integer ("0", None))});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "q"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_constant
                                       (Pconst_integer ("0", None))})])})})})})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "apply"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "off"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "s"}},
                         {pexp_desc =
                           Pexp_function
                            [{pc_lhs =
                               {ppat_desc =
                                 Ppat_construct ({txt = Lident "[]"}, None)};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc = Pexp_ident {txt = Lident "s"}}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_construct ({txt = Lident "::"},
                                  Some
                                   {ppat_desc =
                                     Ppat_tuple
                                      [{ppat_desc =
                                         Ppat_construct
                                          ({txt = Lident "Ins"},
                                          Some
                                           {ppat_desc =
                                             Ppat_tuple
                                              [{ppat_desc =
                                                 Ppat_var {txt = "pos"}};
                                               {ppat_desc =
                                                 Ppat_var {txt = "c"}}]})};
                                       {ppat_desc = Ppat_var {txt = "tl"}}]})};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_let (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "s'"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "insert"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "s"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident {txt = Lident "+"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "pos"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "off"}})])});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "c"}})])}}],
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "apply"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_apply
                                          ({pexp_desc =
                                             Pexp_ident {txt = Lident "+"}},
                                          [(Nolabel,
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "off"}});
                                           (Nolabel,
                                            {pexp_desc =
                                              Pexp_constant
                                               (Pconst_integer ("1", None))})])});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "s'"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "tl"}})])})}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_construct ({txt = Lident "::"},
                                  Some
                                   {ppat_desc =
                                     Ppat_tuple
                                      [{ppat_desc =
                                         Ppat_construct
                                          ({txt = Lident "Rep"},
                                          Some
                                           {ppat_desc =
                                             Ppat_tuple
                                              [{ppat_desc =
                                                 Ppat_var {txt = "pos"}};
                                               {ppat_desc = Ppat_any};
                                               {ppat_desc =
                                                 Ppat_var {txt = "x'"}}]})};
                                       {ppat_desc = Ppat_var {txt = "tl"}}]})};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_let (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "s'"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "set"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "s"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident {txt = Lident "+"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "pos"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "off"}})])});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "x'"}})])}}],
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "apply"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "off"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "s'"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "tl"}})])})}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_construct ({txt = Lident "::"},
                                  Some
                                   {ppat_desc =
                                     Ppat_tuple
                                      [{ppat_desc =
                                         Ppat_construct
                                          ({txt = Lident "Del"},
                                          Some
                                           {ppat_desc =
                                             Ppat_tuple
                                              [{ppat_desc =
                                                 Ppat_var {txt = "pos"}};
                                               {ppat_desc = Ppat_any}]})};
                                       {ppat_desc = Ppat_var {txt = "tl"}}]})};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_let (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "s'"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "delete"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "s"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident {txt = Lident "+"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "pos"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "off"}})])})])}}],
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "apply"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_apply
                                          ({pexp_desc =
                                             Pexp_ident {txt = Lident "-"}},
                                          [(Nolabel,
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "off"}});
                                           (Nolabel,
                                            {pexp_desc =
                                              Pexp_constant
                                               (Pconst_integer ("1", None))})])});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "s'"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "tl"}})])})}}]})})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "apply"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "s"}},
                      {pexp_desc =
                        Pexp_try
                         ({pexp_desc =
                            Pexp_apply
                             ({pexp_desc = Pexp_ident {txt = Lident "apply"}},
                             [(Nolabel,
                               {pexp_desc =
                                 Pexp_constant (Pconst_integer ("0", None))});
                              (Nolabel,
                               {pexp_desc = Pexp_ident {txt = Lident "s"}})])},
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct
                               ({txt = Lident "Invalid_argument"},
                               Some {ppat_desc = Ppat_any})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident {txt = Lident "raise"}},
                               [(Nolabel,
                                 {pexp_desc =
                                   Pexp_construct
                                    ({txt = Lident "Invalid_argument"},
                                    Some
                                     {pexp_desc =
                                       Pexp_constant
                                        (Pconst_string ("incompatible patch",
                                          None))})})])}}])})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "merge3"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Labelled "ancestor", None,
                      {ppat_desc = Ppat_var {txt = "ancestor"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "l"}},
                         {pexp_desc =
                           Pexp_fun (Nolabel, None,
                            {ppat_desc = Ppat_var {txt = "r"}},
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat = {ppat_desc = Ppat_var {txt = "p"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "op_diff"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "ancestor"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "l"}})])}}],
                               {pexp_desc =
                                 Pexp_let (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "q"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident
                                            {txt = Lident "op_diff"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident
                                             {txt = Lident "ancestor"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "r"}})])}}],
                                  {pexp_desc =
                                    Pexp_let (Nonrecursive,
                                     [{pvb_pat =
                                        {ppat_desc =
                                          Ppat_tuple
                                           [{ppat_desc = Ppat_any};
                                            {ppat_desc =
                                              Ppat_var {txt = "q'"}}]};
                                       pvb_expr =
                                        {pexp_desc =
                                          Pexp_apply
                                           ({pexp_desc =
                                              Pexp_ident
                                               {txt = Lident "op_transform"}},
                                           [(Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "p"}});
                                            (Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "q"}})])}}],
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "apply"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "l"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "q'"}})])})})})})})})}}])}]})};
     pmb_attributes = [({txt = "derive_versioned"}, PStr [])]}};
 {pstr_desc =
   Pstr_open
    {popen_lid = {txt = Ldot (Lident "Lwt", "Infix")};
     popen_override = Fresh}};
 {pstr_desc =
   Pstr_open
    {popen_lid = {txt = Lident "Irmin_unix"}; popen_override = Fresh}};
 {pstr_desc =
   Pstr_modtype
    {pmtd_name = {txt = "Config"};
     pmtd_type =
      Some
       {pmty_desc =
         Pmty_signature
          [{psig_desc =
             Psig_value
              {pval_name = {txt = "root"};
               pval_type =
                {ptyp_desc = Ptyp_constr ({txt = Lident "string"}, [])};
               pval_prim = []}};
           {psig_desc =
             Psig_value
              {pval_name = {txt = "shared"};
               pval_type =
                {ptyp_desc = Ptyp_constr ({txt = Lident "string"}, [])};
               pval_prim = []}};
           {psig_desc =
             Psig_value
              {pval_name = {txt = "init"};
               pval_type =
                {ptyp_desc =
                  Ptyp_arrow (Nolabel,
                   {ptyp_desc = Ptyp_constr ({txt = Lident "unit"}, [])},
                   {ptyp_desc = Ptyp_constr ({txt = Lident "unit"}, [])})};
               pval_prim = []}}]}}};
 {pstr_desc =
   Pstr_module
    {pmb_name = {txt = "MakeVersioned"};
     pmb_expr =
      {pmod_desc =
        Pmod_functor ({txt = "Config"},
         Some {pmty_desc = Pmty_ident {txt = Lident "Config"}},
         {pmod_desc =
           Pmod_functor ({txt = "Atom"},
            Some
             {pmty_desc =
               Pmty_ident {txt = Ldot (Lident "Mvector_list", "ATOM")}},
            {pmod_desc =
              Pmod_structure
               [{pstr_desc =
                  Pstr_module
                   {pmb_name = {txt = "OM"};
                    pmb_expr =
                     {pmod_desc =
                       Pmod_apply
                        ({pmod_desc =
                           Pmod_ident
                            {txt = Ldot (Lident "Mvector_list", "Make")}},
                        {pmod_desc = Pmod_ident {txt = Lident "Atom"}})}}};
                {pstr_desc =
                  Pstr_module
                   {pmb_name = {txt = "K"};
                    pmb_expr =
                     {pmod_desc =
                       Pmod_ident
                        {txt = Ldot (Ldot (Lident "Irmin", "Hash"), "SHA1")}}}};
                {pstr_desc =
                  Pstr_value (Nonrecursive,
                   [{pvb_pat = {ppat_desc = Ppat_var {txt = "from_just"}};
                     pvb_expr =
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Some"},
                               Some {ppat_desc = Ppat_var {txt = "x"}})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc = Pexp_ident {txt = Lident "x"}}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "None"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident {txt = Lident "failwith"}},
                               [(Nolabel,
                                 {pexp_desc =
                                   Pexp_constant
                                    (Pconst_string
                                      ("Expected Some. Got None.", None))})])}}]}}])};
                {pstr_desc =
                  Pstr_type (Recursive,
                   [{ptype_name = {txt = "vt"}; ptype_params = [];
                     ptype_cstrs = []; ptype_kind = Ptype_abstract;
                     ptype_private = Public;
                     ptype_manifest =
                      Some
                       {ptyp_desc =
                         Ptyp_constr ({txt = Lident "list"},
                          [{ptyp_desc =
                             Ptyp_constr ({txt = Ldot (Lident "OM", "atom")},
                              [])}])}}])};
                {pstr_desc =
                  Pstr_module
                   {pmb_name = {txt = "M"};
                    pmb_expr =
                     {pmod_desc =
                       Pmod_structure
                        [{pstr_desc =
                           Pstr_module
                            {pmb_name = {txt = "AO_value"};
                             pmb_expr =
                              {pmod_desc =
                                Pmod_structure
                                 [{pstr_desc =
                                    Pstr_type (Recursive,
                                     [{ptype_name = {txt = "t"};
                                       ptype_params = []; ptype_cstrs = [];
                                       ptype_kind = Ptype_abstract;
                                       ptype_private = Public;
                                       ptype_manifest =
                                        Some
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "vt"},
                                            [])}}])};
                                  {pstr_desc =
                                    Pstr_value (Nonrecursive,
                                     [{pvb_pat =
                                        {ppat_desc = Ppat_var {txt = "t"}};
                                       pvb_expr =
                                        {pexp_desc =
                                          Pexp_open (Fresh,
                                           {txt =
                                             Ldot (Lident "Irmin", "Type")},
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "list"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt =
                                                     Ldot (Lident "Atom",
                                                      "t")}})])})}}])};
                                  {pstr_desc =
                                    Pstr_value (Nonrecursive,
                                     [{pvb_pat =
                                        {ppat_desc = Ppat_var {txt = "pp"}};
                                       pvb_expr =
                                        {pexp_desc =
                                          Pexp_apply
                                           ({pexp_desc =
                                              Pexp_ident
                                               {txt =
                                                 Ldot
                                                  (Ldot (Lident "Irmin",
                                                    "Type"),
                                                  "pp_json")}},
                                           [(Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "t"}})])}}])};
                                  {pstr_desc =
                                    Pstr_value (Nonrecursive,
                                     [{pvb_pat =
                                        {ppat_desc =
                                          Ppat_var {txt = "of_string"}};
                                       pvb_expr =
                                        {pexp_desc =
                                          Pexp_fun (Nolabel, None,
                                           {ppat_desc = Ppat_var {txt = "s"}},
                                           {pexp_desc =
                                             Pexp_let (Nonrecursive,
                                              [{pvb_pat =
                                                 {ppat_desc =
                                                   Ppat_var {txt = "decoder"}};
                                                pvb_expr =
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Ldot
                                                           (Lident "Jsonm",
                                                           "decoder")}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_variant
                                                         ("String",
                                                         Some
                                                          {pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "s"}})})])}}],
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt =
                                                       Ldot
                                                        (Ldot
                                                          (Lident "Irmin",
                                                          "Type"),
                                                        "decode_json")}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "t"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "decoder"}})])})})}}])}]}}};
                         {pstr_desc =
                           Pstr_module
                            {pmb_name = {txt = "AO_store"};
                             pmb_expr =
                              {pmod_desc =
                                Pmod_structure
                                 [{pstr_desc =
                                    Pstr_module
                                     {pmb_name = {txt = "S"};
                                      pmb_expr =
                                       {pmod_desc =
                                         Pmod_apply
                                          ({pmod_desc =
                                             Pmod_apply
                                              ({pmod_desc =
                                                 Pmod_ident
                                                  {txt =
                                                    Ldot (Lident "Irmin_git",
                                                     "AO")}},
                                              {pmod_desc =
                                                Pmod_ident
                                                 {txt =
                                                   Ldot (Lident "Git_unix",
                                                    "FS")}})},
                                          {pmod_desc =
                                            Pmod_ident
                                             {txt = Lident "AO_value"}})}}};
                                  {pstr_desc =
                                    Pstr_include
                                     {pincl_mod =
                                       {pmod_desc =
                                         Pmod_ident {txt = Lident "S"}}}};
                                  {pstr_desc =
                                    Pstr_value (Nonrecursive,
                                     [{pvb_pat =
                                        {ppat_desc =
                                          Ppat_var {txt = "create"}};
                                       pvb_expr =
                                        {pexp_desc =
                                          Pexp_fun (Nolabel, None,
                                           {ppat_desc =
                                             Ppat_var {txt = "config"}},
                                           {pexp_desc =
                                             Pexp_let (Nonrecursive,
                                              [{pvb_pat =
                                                 {ppat_desc =
                                                   Ppat_var {txt = "level"}};
                                                pvb_expr =
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Ldot
                                                           (Ldot
                                                             (Ldot
                                                               (Lident
                                                                 "Irmin",
                                                               "Private"),
                                                             "Conf"),
                                                           "key")}},
                                                    [(Labelled "doc",
                                                      {pexp_desc =
                                                        Pexp_constant
                                                         (Pconst_string
                                                           ("The Zlib compression level.",
                                                           None))});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_constant
                                                         (Pconst_string
                                                           ("level", None))});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_open (Fresh,
                                                         {txt =
                                                           Ldot
                                                            (Ldot
                                                              (Lident "Irmin",
                                                              "Private"),
                                                            "Conf")},
                                                         {pexp_desc =
                                                           Pexp_apply
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "some"}},
                                                            [(Nolabel,
                                                              {pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "int"}})])})});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_construct
                                                         ({txt =
                                                            Lident "None"},
                                                         None)})])}}],
                                              {pexp_desc =
                                                Pexp_let (Nonrecursive,
                                                 [{pvb_pat =
                                                    {ppat_desc =
                                                      Ppat_var {txt = "root"}};
                                                   pvb_expr =
                                                    {pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Ldot
                                                              (Ldot
                                                                (Ldot
                                                                  (Lident
                                                                    "Irmin",
                                                                  "Private"),
                                                                "Conf"),
                                                              "get")}},
                                                       [(Nolabel,
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "config"}});
                                                        (Nolabel,
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Ldot
                                                               (Ldot
                                                                 (Ldot
                                                                   (Lident
                                                                    "Irmin",
                                                                   "Private"),
                                                                 "Conf"),
                                                               "root")}})])}}],
                                                 {pexp_desc =
                                                   Pexp_let (Nonrecursive,
                                                    [{pvb_pat =
                                                       {ppat_desc =
                                                         Ppat_var
                                                          {txt = "level"}};
                                                      pvb_expr =
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Ldot
                                                                 (Ldot
                                                                   (Ldot
                                                                    (Lident
                                                                    "Irmin",
                                                                    "Private"),
                                                                   "Conf"),
                                                                 "get")}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "config"}});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "level"}})])}}],
                                                    {pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Ldot
                                                              (Ldot
                                                                (Lident
                                                                  "Git_unix",
                                                                "FS"),
                                                              "create")}},
                                                       [(Optional "root",
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "root"}});
                                                        (Optional "level",
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "level"}});
                                                        (Nolabel,
                                                         {pexp_desc =
                                                           Pexp_construct
                                                            ({txt =
                                                               Lident "()"},
                                                            None)})])})})})})}}])};
                                  {pstr_desc =
                                    Pstr_value (Nonrecursive,
                                     [{pvb_pat =
                                        {ppat_desc =
                                          Ppat_var {txt = "create"}};
                                       pvb_expr =
                                        {pexp_desc =
                                          Pexp_fun (Nolabel, None,
                                           {ppat_desc =
                                             Ppat_construct
                                              ({txt = Lident "()"}, None)},
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "@@"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "create"}});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt =
                                                         Ldot
                                                          (Lident "Irmin_git",
                                                          "config")}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Ldot
                                                           (Lident "Config",
                                                           "shared")}})])})])})}}])}]}}};
                         {pstr_desc =
                           Pstr_type (Recursive,
                            [{ptype_name = {txt = "t"}; ptype_params = [];
                              ptype_cstrs = []; ptype_kind = Ptype_abstract;
                              ptype_private = Public;
                              ptype_manifest =
                               Some
                                {ptyp_desc =
                                  Ptyp_constr
                                   ({txt = Ldot (Lident "K", "t")}, [])}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "of_adt"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc =
                                    Ppat_constraint
                                     ({ppat_desc = Ppat_var {txt = "a"}},
                                     {ptyp_desc =
                                       Ptyp_constr
                                        ({txt = Ldot (Lident "OM", "t")}, 
                                        [])})},
                                  {pexp_desc =
                                    Pexp_constraint
                                     ({pexp_desc =
                                        Pexp_let (Nonrecursive,
                                         [{pvb_pat =
                                            {ppat_desc =
                                              Ppat_var {txt = "aostore"}};
                                           pvb_expr =
                                            {pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt =
                                                     Ldot (Lident "AO_store",
                                                      "create")}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_construct
                                                    ({txt = Lident "()"},
                                                    None)})])}}],
                                         {pexp_desc =
                                           Pexp_let (Nonrecursive,
                                            [{pvb_pat =
                                               {ppat_desc =
                                                 Ppat_var
                                                  {txt = "aostore_add"}};
                                              pvb_expr =
                                               {pexp_desc =
                                                 Pexp_fun (Nolabel, None,
                                                  {ppat_desc =
                                                    Ppat_var {txt = "value"}},
                                                  {pexp_desc =
                                                    Pexp_apply
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident ">>="}},
                                                     [(Nolabel,
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "aostore"}});
                                                      (Nolabel,
                                                       {pexp_desc =
                                                         Pexp_fun (Nolabel,
                                                          None,
                                                          {ppat_desc =
                                                            Ppat_var
                                                             {txt =
                                                               "ao_store"}},
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Ldot
                                                                    (
                                                                    Lident
                                                                    "AO_store",
                                                                    "add")}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "ao_store"}});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "value"}})])})})])})}}],
                                            {pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "=<<"}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt =
                                                      Lident "aostore_add"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Ldot (Lident "Lwt",
                                                           "return")}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "a"}})])})])})})},
                                     {ptyp_desc =
                                       Ptyp_constr
                                        ({txt = Ldot (Lident "Lwt", "t")},
                                        [{ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [])}])})})}}])};
                         {pstr_desc =
                           Pstr_value (Recursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "to_adt"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc =
                                    Ppat_constraint
                                     ({ppat_desc = Ppat_var {txt = "k"}},
                                     {ptyp_desc =
                                       Ptyp_constr ({txt = Lident "t"}, [])})},
                                  {pexp_desc =
                                    Pexp_constraint
                                     ({pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident {txt = Lident ">>="}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt =
                                                    Ldot (Lident "AO_store",
                                                     "create")}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_construct
                                                   ({txt = Lident "()"},
                                                   None)})])});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_fun (Nolabel, None,
                                              {ppat_desc =
                                                Ppat_var {txt = "ao_store"}},
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident ">>="}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Ldot
                                                             (Lident
                                                               "AO_store",
                                                             "find")}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident
                                                              "ao_store"}});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "k"}})])});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_fun (Nolabel, None,
                                                      {ppat_desc =
                                                        Ppat_var {txt = "t"}},
                                                      {pexp_desc =
                                                        Pexp_let
                                                         (Nonrecursive,
                                                         [{pvb_pat =
                                                            {ppat_desc =
                                                              Ppat_var
                                                               {txt = "t"}};
                                                           pvb_expr =
                                                            {pexp_desc =
                                                              Pexp_apply
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "from_just"}},
                                                               [(Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}})])}}],
                                                         {pexp_desc =
                                                           Pexp_apply
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Ldot
                                                                   (Lident
                                                                    "Lwt",
                                                                   "return")}},
                                                            [(Nolabel,
                                                              {pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident "t"}})])})})})])})})])},
                                     {ptyp_desc =
                                       Ptyp_constr
                                        ({txt = Ldot (Lident "Lwt", "t")},
                                        [{ptyp_desc =
                                           Ptyp_constr
                                            ({txt = Ldot (Lident "OM", "t")},
                                            [])}])})})}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat = {ppat_desc = Ppat_var {txt = "t"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_ident {txt = Ldot (Lident "K", "t")}}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat = {ppat_desc = Ppat_var {txt = "pp"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_ident {txt = Ldot (Lident "K", "pp")}}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "of_string"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_ident
                                  {txt = Ldot (Lident "K", "of_string")}}}])};
                         {pstr_desc =
                           Pstr_value (Recursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "merge"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Labelled "old", None,
                                  {ppat_desc =
                                    Ppat_constraint
                                     ({ppat_desc = Ppat_var {txt = "old"}},
                                     {ptyp_desc =
                                       Ptyp_constr
                                        ({txt =
                                           Ldot
                                            (Ldot (Lident "Irmin", "Merge"),
                                            "promise")},
                                        [{ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [])}])})},
                                  {pexp_desc =
                                    Pexp_fun (Nolabel, None,
                                     {ppat_desc = Ppat_var {txt = "v1_k"}},
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc = Ppat_var {txt = "v2_k"}},
                                        {pexp_desc =
                                          Pexp_open (Fresh,
                                           {txt =
                                             Ldot
                                              (Ldot (Lident "Irmin", "Merge"),
                                              "Infix")},
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident ">>=*"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "old"}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_construct
                                                        ({txt = Lident "()"},
                                                        None)})])});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_fun (Nolabel, None,
                                                   {ppat_desc =
                                                     Ppat_var {txt = "old_k"}},
                                                   {pexp_desc =
                                                     Pexp_let (Nonrecursive,
                                                      [{pvb_pat =
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "old_k"}};
                                                        pvb_expr =
                                                         {pexp_desc =
                                                           Pexp_apply
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "from_just"}},
                                                            [(Nolabel,
                                                              {pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "old_k"}})])}}],
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident ">>="}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "to_adt"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "old_k"}})])});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_fun
                                                              (Nolabel, None,
                                                              {ppat_desc =
                                                                Ppat_var
                                                                 {txt =
                                                                   "oldv"}},
                                                              {pexp_desc =
                                                                Pexp_apply
                                                                 ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                 [(Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "to_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v1_k"}})])});
                                                                  (Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v1"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "to_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v2_k"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v2"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "OM",
                                                                    "merge3")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "oldv"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v1"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v2"}})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "of_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "merged_k"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Ldot
                                                                    (Lident
                                                                    "Irmin",
                                                                    "Merge"),
                                                                    "ok")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "merged_k"}})])})})])})})})])})})])})})])})})})])})})})})}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "merge"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_open (Fresh,
                                  {txt = Ldot (Lident "Irmin", "Merge")},
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "option"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_apply
                                          ({pexp_desc =
                                             Pexp_ident {txt = Lident "v"}},
                                          [(Nolabel,
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "t"}});
                                           (Nolabel,
                                            {pexp_desc =
                                              Pexp_ident
                                               {txt = Lident "merge"}})])})])})}}])}]}}};
                {pstr_desc =
                  Pstr_module
                   {pmb_name = {txt = "BC_store"};
                    pmb_expr =
                     {pmod_desc =
                       Pmod_structure
                        [{pstr_desc =
                           Pstr_module
                            {pmb_name = {txt = "Store"};
                             pmb_expr =
                              {pmod_desc =
                                Pmod_apply
                                 ({pmod_desc =
                                    Pmod_ident
                                     {txt =
                                       Ldot
                                        (Ldot
                                          (Ldot (Lident "Irmin_unix", "Git"),
                                          "FS"),
                                        "KV")}},
                                 {pmod_desc = Pmod_ident {txt = Lident "M"}})}}};
                         {pstr_desc =
                           Pstr_module
                            {pmb_name = {txt = "Sync"};
                             pmb_expr =
                              {pmod_desc =
                                Pmod_apply
                                 ({pmod_desc =
                                    Pmod_ident
                                     {txt = Ldot (Lident "Irmin", "Sync")}},
                                 {pmod_desc =
                                   Pmod_ident {txt = Lident "Store"}})}}};
                         {pstr_desc =
                           Pstr_type (Recursive,
                            [{ptype_name = {txt = "t"}; ptype_params = [];
                              ptype_cstrs = []; ptype_kind = Ptype_abstract;
                              ptype_private = Public;
                              ptype_manifest =
                               Some
                                {ptyp_desc =
                                  Ptyp_constr
                                   ({txt = Ldot (Lident "Store", "t")}, 
                                   [])}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat = {ppat_desc = Ppat_var {txt = "init"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Optional "root", None,
                                  {ppat_desc = Ppat_var {txt = "root"}},
                                  {pexp_desc =
                                    Pexp_fun (Optional "bare", None,
                                     {ppat_desc = Ppat_var {txt = "bare"}},
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc =
                                          Ppat_construct
                                           ({txt = Lident "()"}, None)},
                                        {pexp_desc =
                                          Pexp_let (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "config"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt =
                                                       Ldot
                                                        (Lident "Irmin_git",
                                                        "config")}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt =
                                                        Ldot
                                                         (Lident "Config",
                                                         "root")}})])}}],
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt =
                                                    Ldot
                                                     (Ldot (Lident "Store",
                                                       "Repo"),
                                                     "v")}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "config"}})])})})})})}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "master"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc =
                                    Ppat_constraint
                                     ({ppat_desc = Ppat_var {txt = "repo"}},
                                     {ptyp_desc =
                                       Ptyp_constr
                                        ({txt = Ldot (Lident "Store", "repo")},
                                        [])})},
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt =
                                           Ldot (Lident "Store", "master")}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "repo"}})])})}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "clone"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc = Ppat_var {txt = "t"}},
                                  {pexp_desc =
                                    Pexp_fun (Nolabel, None,
                                     {ppat_desc = Ppat_var {txt = "name"}},
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident
                                            {txt =
                                              Ldot (Lident "Store", "clone")}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "t"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "name"}})])})})}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "get_branch"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc = Ppat_var {txt = "r"}},
                                  {pexp_desc =
                                    Pexp_fun (Labelled "branch_name", None,
                                     {ppat_desc =
                                       Ppat_var {txt = "branch_name"}},
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident
                                            {txt =
                                              Ldot (Lident "Store",
                                               "of_branch")}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "r"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident
                                             {txt = Lident "branch_name"}})])})})}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "merge"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc = Ppat_var {txt = "s"}},
                                  {pexp_desc =
                                    Pexp_fun (Labelled "into", None,
                                     {ppat_desc = Ppat_var {txt = "into"}},
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident
                                            {txt =
                                              Ldot (Lident "Store", "merge")}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "s"}});
                                         (Labelled "into",
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "into"}})])})})}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "update"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc = Ppat_var {txt = "t"}},
                                  {pexp_desc =
                                    Pexp_fun (Nolabel, None,
                                     {ppat_desc = Ppat_var {txt = "k"}},
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc = Ppat_var {txt = "v"}},
                                        {pexp_desc =
                                          Pexp_apply
                                           ({pexp_desc =
                                              Pexp_ident
                                               {txt =
                                                 Ldot (Lident "Store", "set")}},
                                           [(Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "t"}});
                                            (Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "k"}});
                                            (Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "v"}})])})})})}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat = {ppat_desc = Ppat_var {txt = "read"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc = Ppat_var {txt = "t"}},
                                  {pexp_desc =
                                    Pexp_fun (Nolabel, None,
                                     {ppat_desc = Ppat_var {txt = "k"}},
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident
                                            {txt =
                                              Ldot (Lident "Store", "find")}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "t"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "k"}})])})})}}])}]}}};
                {pstr_desc =
                  Pstr_module
                   {pmb_name = {txt = "Vpst"};
                    pmb_expr =
                     {pmod_desc =
                       Pmod_constraint
                        ({pmod_desc =
                           Pmod_structure
                            [{pstr_desc =
                               Pstr_type (Recursive,
                                [{ptype_name = {txt = "store"};
                                  ptype_params = []; ptype_cstrs = [];
                                  ptype_kind = Ptype_abstract;
                                  ptype_private = Public;
                                  ptype_manifest =
                                   Some
                                    {ptyp_desc =
                                      Ptyp_constr
                                       ({txt = Ldot (Lident "BC_store", "t")},
                                       [])}}])};
                             {pstr_desc =
                               Pstr_type (Recursive,
                                [{ptype_name = {txt = "st"};
                                  ptype_params = []; ptype_cstrs = [];
                                  ptype_kind =
                                   Ptype_record
                                    [{pld_name = {txt = "master"};
                                      pld_mutable = Immutable;
                                      pld_type =
                                       {ptyp_desc =
                                         Ptyp_constr ({txt = Lident "store"},
                                          [])}};
                                     {pld_name = {txt = "local"};
                                      pld_mutable = Immutable;
                                      pld_type =
                                       {ptyp_desc =
                                         Ptyp_constr ({txt = Lident "store"},
                                          [])}};
                                     {pld_name = {txt = "name"};
                                      pld_mutable = Immutable;
                                      pld_type =
                                       {ptyp_desc =
                                         Ptyp_constr
                                          ({txt = Lident "string"}, [])}};
                                     {pld_name = {txt = "next_id"};
                                      pld_mutable = Immutable;
                                      pld_type =
                                       {ptyp_desc =
                                         Ptyp_constr ({txt = Lident "int"},
                                          [])}}];
                                  ptype_private = Public;
                                  ptype_manifest = None}])};
                             {pstr_desc =
                               Pstr_type (Recursive,
                                [{ptype_name = {txt = "t"};
                                  ptype_params =
                                   [({ptyp_desc = Ptyp_var "a"}, Invariant)];
                                  ptype_cstrs = [];
                                  ptype_kind = Ptype_abstract;
                                  ptype_private = Public;
                                  ptype_manifest =
                                   Some
                                    {ptyp_desc =
                                      Ptyp_arrow (Nolabel,
                                       {ptyp_desc =
                                         Ptyp_constr ({txt = Lident "st"},
                                          [])},
                                       {ptyp_desc =
                                         Ptyp_constr
                                          ({txt = Ldot (Lident "Lwt", "t")},
                                          [{ptyp_desc =
                                             Ptyp_tuple
                                              [{ptyp_desc = Ptyp_var "a"};
                                               {ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt = Lident "st"}, 
                                                  [])}]}])})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc = Ppat_var {txt = "info"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc = Ppat_var {txt = "s"}},
                                      {pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident
                                             {txt =
                                               Ldot (Lident "Irmin_unix",
                                                "info")}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_constant
                                              (Pconst_string ("[repo %s] %s",
                                                None))});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_ident
                                              {txt =
                                                Ldot (Lident "Config",
                                                 "root")}});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "s"}})])})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc = Ppat_var {txt = "path"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_construct ({txt = Lident "::"},
                                      Some
                                       {pexp_desc =
                                         Pexp_tuple
                                          [{pexp_desc =
                                             Pexp_constant
                                              (Pconst_string ("state", None))};
                                           {pexp_desc =
                                             Pexp_construct
                                              ({txt = Lident "[]"}, None)}]})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc = Ppat_var {txt = "return"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc =
                                        Ppat_constraint
                                         ({ppat_desc = Ppat_var {txt = "x"}},
                                         {ptyp_desc = Ptyp_var "a"})},
                                      {pexp_desc =
                                        Pexp_constraint
                                         ({pexp_desc =
                                            Pexp_fun (Nolabel, None,
                                             {ppat_desc =
                                               Ppat_var {txt = "st"}},
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt =
                                                      Ldot (Lident "Lwt",
                                                       "return")}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_tuple
                                                     [{pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "x"}};
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "st"}}]})])})},
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [{ptyp_desc = Ptyp_var "a"}])})})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc = Ppat_var {txt = "bind"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc =
                                        Ppat_constraint
                                         ({ppat_desc = Ppat_var {txt = "m1"}},
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [{ptyp_desc = Ptyp_var "a"}])})},
                                      {pexp_desc =
                                        Pexp_fun (Nolabel, None,
                                         {ppat_desc =
                                           Ppat_constraint
                                            ({ppat_desc =
                                               Ppat_var {txt = "f"}},
                                            {ptyp_desc =
                                              Ptyp_arrow (Nolabel,
                                               {ptyp_desc = Ptyp_var "a"},
                                               {ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt = Lident "t"},
                                                  [{ptyp_desc = Ptyp_var "b"}])})})},
                                         {pexp_desc =
                                           Pexp_constraint
                                            ({pexp_desc =
                                               Pexp_fun (Nolabel, None,
                                                {ppat_desc =
                                                  Ppat_var {txt = "st"}},
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident ">>="}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_apply
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "m1"}},
                                                        [(Nolabel,
                                                          {pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "st"}})])});
                                                    (Nolabel,
                                                     {pexp_desc =
                                                       Pexp_fun (Nolabel,
                                                        None,
                                                        {ppat_desc =
                                                          Ppat_tuple
                                                           [{ppat_desc =
                                                              Ppat_var
                                                               {txt = "a"}};
                                                            {ppat_desc =
                                                              Ppat_var
                                                               {txt = "st'"}}]},
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "f"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "a"}});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "st'"}})])})})])})},
                                            {ptyp_desc =
                                              Ptyp_constr
                                               ({txt = Lident "t"},
                                               [{ptyp_desc = Ptyp_var "b"}])})})})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc =
                                     Ppat_var {txt = "with_init_version_do"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc =
                                        Ppat_constraint
                                         ({ppat_desc = Ppat_var {txt = "v"}},
                                         {ptyp_desc =
                                           Ptyp_constr
                                            ({txt = Ldot (Lident "OM", "t")},
                                            [])})},
                                      {pexp_desc =
                                        Pexp_fun (Nolabel, None,
                                         {ppat_desc =
                                           Ppat_constraint
                                            ({ppat_desc =
                                               Ppat_var {txt = "m"}},
                                            {ptyp_desc =
                                              Ptyp_constr
                                               ({txt = Lident "t"},
                                               [{ptyp_desc = Ptyp_var "a"}])})},
                                         {pexp_desc =
                                           Pexp_apply
                                            ({pexp_desc =
                                               Pexp_ident
                                                {txt =
                                                  Ldot (Lident "Lwt_main",
                                                   "run")}},
                                            [(Nolabel,
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident ">>="}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Ldot
                                                             (Lident
                                                               "BC_store",
                                                             "init")}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_construct
                                                           ({txt =
                                                              Lident "()"},
                                                           None)})])});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_fun (Nolabel, None,
                                                      {ppat_desc =
                                                        Ppat_var
                                                         {txt = "repo"}},
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident ">>="}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "master")}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "repo"}})])});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_fun
                                                              (Nolabel, None,
                                                              {ppat_desc =
                                                                Ppat_var
                                                                 {txt =
                                                                   "m_br"}},
                                                              {pexp_desc =
                                                                Pexp_apply
                                                                 ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                 [(Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "M",
                                                                    "of_adt")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}})])});
                                                                  (Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "k"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "cinfo"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("creating state of master",
                                                                    None))})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "update")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "path"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "k"}});
                                                                    (Labelled
                                                                    "info",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "()"},
                                                                    None)},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "clone")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("1_local",
                                                                    None))})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t_br"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "st"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "master"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "local"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "name"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("1",
                                                                    None))});
                                                                    ({txt =
                                                                    Lident
                                                                    "next_id"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})],
                                                                    None)}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "a"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any}]},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}})])})})])})})})])})})])})})})])})})])})})])})])})})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc =
                                     Ppat_var {txt = "with_init_forked_do"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc =
                                        Ppat_constraint
                                         ({ppat_desc = Ppat_var {txt = "m"}},
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [{ptyp_desc = Ptyp_var "a"}])})},
                                      {pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident {txt = Lident ">>="}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt =
                                                    Ldot (Lident "BC_store",
                                                     "init")}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_construct
                                                   ({txt = Lident "()"},
                                                   None)})])});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_fun (Nolabel, None,
                                              {ppat_desc =
                                                Ppat_var {txt = "repo"}},
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident ">>="}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Ldot
                                                             (Lident
                                                               "BC_store",
                                                             "master")}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "repo"}})])});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_fun (Nolabel, None,
                                                      {ppat_desc =
                                                        Ppat_var
                                                         {txt = "m_br"}},
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident ">>="}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "clone")}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_constant
                                                                   (Pconst_string
                                                                    ("1_local",
                                                                    None))})])});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_fun
                                                              (Nolabel, None,
                                                              {ppat_desc =
                                                                Ppat_var
                                                                 {txt =
                                                                   "t_br"}},
                                                              {pexp_desc =
                                                                Pexp_let
                                                                 (Nonrecursive,
                                                                 [{pvb_pat =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "st"}};
                                                                   pvb_expr =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "master"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "local"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "name"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("1",
                                                                    None))});
                                                                    ({txt =
                                                                    Lident
                                                                    "next_id"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})],
                                                                    None)}}],
                                                                 {pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "a"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any}]},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}})])})})])})})})])})})])})})])})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc =
                                     Ppat_var {txt = "fork_version"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc =
                                        Ppat_constraint
                                         ({ppat_desc = Ppat_var {txt = "m"}},
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [{ptyp_desc = Ptyp_var "a"}])})},
                                      {pexp_desc =
                                        Pexp_constraint
                                         ({pexp_desc =
                                            Pexp_fun (Nolabel, None,
                                             {ppat_desc =
                                               Ppat_constraint
                                                ({ppat_desc =
                                                   Ppat_var {txt = "st"}},
                                                {ptyp_desc =
                                                  Ptyp_constr
                                                   ({txt = Lident "st"}, 
                                                   [])})},
                                             {pexp_desc =
                                               Pexp_let (Nonrecursive,
                                                [{pvb_pat =
                                                   {ppat_desc =
                                                     Ppat_var
                                                      {txt = "thread_f"}};
                                                  pvb_expr =
                                                   {pexp_desc =
                                                     Pexp_fun (Nolabel, None,
                                                      {ppat_desc =
                                                        Ppat_construct
                                                         ({txt = Lident "()"},
                                                         None)},
                                                      {pexp_desc =
                                                        Pexp_let
                                                         (Nonrecursive,
                                                         [{pvb_pat =
                                                            {ppat_desc =
                                                              Ppat_var
                                                               {txt =
                                                                 "child_name"}};
                                                           pvb_expr =
                                                            {pexp_desc =
                                                              Pexp_apply
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "^"}},
                                                               [(Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_field
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "name"})});
                                                                (Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "^"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("_",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "string_of_int"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "next_id"})})])})])})])}}],
                                                         {pexp_desc =
                                                           Pexp_let
                                                            (Nonrecursive,
                                                            [{pvb_pat =
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt =
                                                                    "parent_m_br"}};
                                                              pvb_expr =
                                                               {pexp_desc =
                                                                 Pexp_field
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                  {txt =
                                                                    Lident
                                                                    "master"})}}],
                                                            {pexp_desc =
                                                              Pexp_let
                                                               (Nonrecursive,
                                                               [{pvb_pat =
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "m_br"}};
                                                                 pvb_expr =
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "parent_m_br"}}}],
                                                               {pexp_desc =
                                                                 Pexp_apply
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                  [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "clone")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "^"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "child_name"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("_local",
                                                                    None))})])})])});
                                                                   (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t_br"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "new_st"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "master"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "local"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "name"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "child_name"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "next_id"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})],
                                                                    None)}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "new_st"}})])})})})])})})})})}}],
                                                {pexp_desc =
                                                  Pexp_sequence
                                                   ({pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Ldot
                                                              (Lident "Lwt",
                                                              "async")}},
                                                       [(Nolabel,
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident
                                                               "thread_f"}})])},
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Ldot
                                                             (Lident "Lwt",
                                                             "return")}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_tuple
                                                           [{pexp_desc =
                                                              Pexp_construct
                                                               ({txt =
                                                                  Lident "()"},
                                                               None)};
                                                            {pexp_desc =
                                                              Pexp_record
                                                               ([({txt =
                                                                    Lident
                                                                    "next_id"},
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "next_id"})});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])})],
                                                               Some
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "st"}})}]})])})})})},
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [{ptyp_desc =
                                               Ptyp_constr
                                                ({txt = Lident "unit"}, 
                                                [])}])})})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc =
                                     Ppat_var {txt = "get_latest_version"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc =
                                        Ppat_construct ({txt = Lident "()"},
                                         None)},
                                      {pexp_desc =
                                        Pexp_constraint
                                         ({pexp_desc =
                                            Pexp_fun (Nolabel, None,
                                             {ppat_desc =
                                               Ppat_constraint
                                                ({ppat_desc =
                                                   Ppat_var {txt = "st"}},
                                                {ptyp_desc =
                                                  Ptyp_constr
                                                   ({txt = Lident "st"}, 
                                                   [])})},
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident ">>="}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_apply
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Ldot
                                                            (Lident
                                                              "BC_store",
                                                            "read")}},
                                                     [(Nolabel,
                                                       {pexp_desc =
                                                         Pexp_field
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "st"}},
                                                          {txt =
                                                            Lident "local"})});
                                                      (Nolabel,
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "path"}})])});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_fun (Nolabel, None,
                                                     {ppat_desc =
                                                       Ppat_var {txt = "k"}},
                                                     {pexp_desc =
                                                       Pexp_apply
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident ">>="}},
                                                        [(Nolabel,
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "@@"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "M",
                                                                    "to_adt")}});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_apply
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "from_just"}},
                                                                  [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "k"}})])})])});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_fun
                                                             (Nolabel, None,
                                                             {ppat_desc =
                                                               Ppat_var
                                                                {txt = "td"}},
                                                             {pexp_desc =
                                                               Pexp_apply
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                [(Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "td"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}}]})])})})])})})])})},
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [{ptyp_desc =
                                               Ptyp_constr
                                                ({txt =
                                                   Ldot (Lident "OM", "t")},
                                                [])}])})})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc =
                                     Ppat_var {txt = "sync_remote_version"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc =
                                        Ppat_var {txt = "remote_uri"}},
                                      {pexp_desc =
                                        Pexp_fun (Optional "v", None,
                                         {ppat_desc = Ppat_var {txt = "v"}},
                                         {pexp_desc =
                                           Pexp_constraint
                                            ({pexp_desc =
                                               Pexp_fun (Nolabel, None,
                                                {ppat_desc =
                                                  Ppat_constraint
                                                   ({ppat_desc =
                                                      Ppat_var {txt = "st"}},
                                                   {ptyp_desc =
                                                     Ptyp_constr
                                                      ({txt = Lident "st"},
                                                      [])})},
                                                {pexp_desc =
                                                  Pexp_let (Nonrecursive,
                                                   [{pvb_pat =
                                                      {ppat_desc =
                                                        Ppat_var
                                                         {txt = "cinfo"}};
                                                     pvb_expr =
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "info"}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_constant
                                                              (Pconst_string
                                                                ("committing local state",
                                                                None))})])}}],
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident ">>="}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_match
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "v"}},
                                                           [{pc_lhs =
                                                              {ppat_desc =
                                                                Ppat_construct
                                                                 ({txt =
                                                                    Lident
                                                                    "None"},
                                                                 None)};
                                                             pc_guard = None;
                                                             pc_rhs =
                                                              {pexp_desc =
                                                                Pexp_apply
                                                                 ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                 [(Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "()"},
                                                                    None)})])}};
                                                            {pc_lhs =
                                                              {ppat_desc =
                                                                Ppat_construct
                                                                 ({txt =
                                                                    Lident
                                                                    "Some"},
                                                                 Some
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v"}})};
                                                             pc_guard = None;
                                                             pc_rhs =
                                                              {pexp_desc =
                                                                Pexp_apply
                                                                 ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                 [(Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "M",
                                                                    "of_adt")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}})])});
                                                                  (Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "k"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "update")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "path"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "k"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])})})])}}])});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_fun (Nolabel,
                                                           None,
                                                           {ppat_desc =
                                                             Ppat_construct
                                                              ({txt =
                                                                 Lident "()"},
                                                              None)},
                                                           {pexp_desc =
                                                             Pexp_let
                                                              (Nonrecursive,
                                                              [{pvb_pat =
                                                                 {ppat_desc =
                                                                   Ppat_var
                                                                    {txt =
                                                                    "cinfo"}};
                                                                pvb_expr =
                                                                 {pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Printf",
                                                                    "sprintf")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("Merging remote: %s",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "remote_uri"}})])})])}}],
                                                              {pexp_desc =
                                                                Pexp_apply
                                                                 ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                 [(Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "Sync"),
                                                                    "pull")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "master"})});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Irmin",
                                                                    "remote_uri")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "remote_uri"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_variant
                                                                    ("Merge",
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})})])});
                                                                  (Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "cinfo"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("Merging master into local",
                                                                    None))})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "merge")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "master"})});
                                                                    (Labelled
                                                                    "into",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Labelled
                                                                    "info",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "cinfo"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("Merging local into master",
                                                                    None))})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "merge")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Labelled
                                                                    "into",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "master"})});
                                                                    (Labelled
                                                                    "info",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "get_latest_version"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "()"},
                                                                    None)});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}})])})})])})})})])})})})])})})})])})})},
                                            {ptyp_desc =
                                              Ptyp_constr
                                               ({txt = Lident "t"},
                                               [{ptyp_desc =
                                                  Ptyp_constr
                                                   ({txt =
                                                      Ldot (Lident "OM", "t")},
                                                   [])}])})})})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc =
                                     Ppat_var {txt = "sync_next_version"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Optional "v", None,
                                      {ppat_desc = Ppat_var {txt = "v"}},
                                      {pexp_desc =
                                        Pexp_constraint
                                         ({pexp_desc =
                                            Pexp_fun (Nolabel, None,
                                             {ppat_desc =
                                               Ppat_constraint
                                                ({ppat_desc =
                                                   Ppat_var {txt = "st"}},
                                                {ptyp_desc =
                                                  Ptyp_constr
                                                   ({txt = Lident "st"}, 
                                                   [])})},
                                             {pexp_desc =
                                               Pexp_let (Nonrecursive,
                                                [{pvb_pat =
                                                   {ppat_desc =
                                                     Ppat_var {txt = "cinfo"}};
                                                  pvb_expr =
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "info"}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_constant
                                                           (Pconst_string
                                                             ("committing local state",
                                                             None))})])}}],
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident ">>="}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_match
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt = Lident "v"}},
                                                        [{pc_lhs =
                                                           {ppat_desc =
                                                             Ppat_construct
                                                              ({txt =
                                                                 Lident
                                                                  "None"},
                                                              None)};
                                                          pc_guard = None;
                                                          pc_rhs =
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_construct
                                                                   ({txt =
                                                                    Lident
                                                                    "()"},
                                                                   None)})])}};
                                                         {pc_lhs =
                                                           {ppat_desc =
                                                             Ppat_construct
                                                              ({txt =
                                                                 Lident
                                                                  "Some"},
                                                              Some
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt = "v"}})};
                                                          pc_guard = None;
                                                          pc_rhs =
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    ">>="}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "M",
                                                                    "of_adt")}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}})])});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_fun
                                                                   (Nolabel,
                                                                   None,
                                                                   {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "k"}},
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "update")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "path"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "k"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])})})])}}])});
                                                    (Nolabel,
                                                     {pexp_desc =
                                                       Pexp_fun (Nolabel,
                                                        None,
                                                        {ppat_desc =
                                                          Ppat_construct
                                                           ({txt =
                                                              Lident "()"},
                                                           None)},
                                                        {pexp_desc =
                                                          Pexp_let
                                                           (Nonrecursive,
                                                           [{pvb_pat =
                                                              {ppat_desc =
                                                                Ppat_var
                                                                 {txt =
                                                                   "cinfo"}};
                                                             pvb_expr =
                                                              {pexp_desc =
                                                                Pexp_apply
                                                                 ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                 [(Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("Merging master into local",
                                                                    None))})])}}],
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    ">>="}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "merge")}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "master"})});
                                                                    (Labelled
                                                                    "into",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Labelled
                                                                    "info",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_fun
                                                                   (Nolabel,
                                                                   None,
                                                                   {ppat_desc
                                                                    =
                                                                    Ppat_any},
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "cinfo"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("Merging local into master",
                                                                    None))})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "merge")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Labelled
                                                                    "into",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "master"})});
                                                                    (Labelled
                                                                    "info",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "get_latest_version"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "()"},
                                                                    None)});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}})])})})])})})})])})})})])})})},
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [{ptyp_desc =
                                               Ptyp_constr
                                                ({txt =
                                                   Ldot (Lident "OM", "t")},
                                                [])}])})})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc = Ppat_var {txt = "liftLwt"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc =
                                        Ppat_constraint
                                         ({ppat_desc = Ppat_var {txt = "m"}},
                                         {ptyp_desc =
                                           Ptyp_constr
                                            ({txt = Ldot (Lident "Lwt", "t")},
                                            [{ptyp_desc = Ptyp_var "a"}])})},
                                      {pexp_desc =
                                        Pexp_constraint
                                         ({pexp_desc =
                                            Pexp_fun (Nolabel, None,
                                             {ppat_desc =
                                               Ppat_var {txt = "st"}},
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident ">>="}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "m"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_fun (Nolabel, None,
                                                     {ppat_desc =
                                                       Ppat_var {txt = "a"}},
                                                     {pexp_desc =
                                                       Pexp_apply
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Ldot
                                                               (Lident "Lwt",
                                                               "return")}},
                                                        [(Nolabel,
                                                          {pexp_desc =
                                                            Pexp_tuple
                                                             [{pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident "a"}};
                                                              {pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "st"}}]})])})})])})},
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [{ptyp_desc = Ptyp_var "a"}])})})}}])}]},
                        {pmty_desc =
                          Pmty_signature
                           [{psig_desc =
                              Psig_type (Recursive,
                               [{ptype_name = {txt = "t"};
                                 ptype_params =
                                  [({ptyp_desc = Ptyp_var "a"}, Invariant)];
                                 ptype_cstrs = [];
                                 ptype_kind = Ptype_abstract;
                                 ptype_private = Public;
                                 ptype_manifest = None}])};
                            {psig_desc =
                              Psig_value
                               {pval_name = {txt = "return"};
                                pval_type =
                                 {ptyp_desc =
                                   Ptyp_arrow (Nolabel,
                                    {ptyp_desc = Ptyp_var "a"},
                                    {ptyp_desc =
                                      Ptyp_constr ({txt = Lident "t"},
                                       [{ptyp_desc = Ptyp_var "a"}])})};
                                pval_prim = []}};
                            {psig_desc =
                              Psig_value
                               {pval_name = {txt = "bind"};
                                pval_type =
                                 {ptyp_desc =
                                   Ptyp_arrow (Nolabel,
                                    {ptyp_desc =
                                      Ptyp_constr ({txt = Lident "t"},
                                       [{ptyp_desc = Ptyp_var "a"}])},
                                    {ptyp_desc =
                                      Ptyp_arrow (Nolabel,
                                       {ptyp_desc =
                                         Ptyp_arrow (Nolabel,
                                          {ptyp_desc = Ptyp_var "a"},
                                          {ptyp_desc =
                                            Ptyp_constr ({txt = Lident "t"},
                                             [{ptyp_desc = Ptyp_var "b"}])})},
                                       {ptyp_desc =
                                         Ptyp_constr ({txt = Lident "t"},
                                          [{ptyp_desc = Ptyp_var "b"}])})})};
                                pval_prim = []}};
                            {psig_desc =
                              Psig_value
                               {pval_name = {txt = "with_init_version_do"};
                                pval_type =
                                 {ptyp_desc =
                                   Ptyp_arrow (Nolabel,
                                    {ptyp_desc =
                                      Ptyp_constr
                                       ({txt = Ldot (Lident "OM", "t")}, 
                                       [])},
                                    {ptyp_desc =
                                      Ptyp_arrow (Nolabel,
                                       {ptyp_desc =
                                         Ptyp_constr ({txt = Lident "t"},
                                          [{ptyp_desc = Ptyp_var "a"}])},
                                       {ptyp_desc = Ptyp_var "a"})})};
                                pval_prim = []}};
                            {psig_desc =
                              Psig_value
                               {pval_name = {txt = "fork_version"};
                                pval_type =
                                 {ptyp_desc =
                                   Ptyp_arrow (Nolabel,
                                    {ptyp_desc =
                                      Ptyp_constr ({txt = Lident "t"},
                                       [{ptyp_desc = Ptyp_var "a"}])},
                                    {ptyp_desc =
                                      Ptyp_constr ({txt = Lident "t"},
                                       [{ptyp_desc =
                                          Ptyp_constr ({txt = Lident "unit"},
                                           [])}])})};
                                pval_prim = []}};
                            {psig_desc =
                              Psig_value
                               {pval_name = {txt = "get_latest_version"};
                                pval_type =
                                 {ptyp_desc =
                                   Ptyp_arrow (Nolabel,
                                    {ptyp_desc =
                                      Ptyp_constr ({txt = Lident "unit"}, [])},
                                    {ptyp_desc =
                                      Ptyp_constr ({txt = Lident "t"},
                                       [{ptyp_desc =
                                          Ptyp_constr
                                           ({txt = Ldot (Lident "OM", "t")},
                                           [])}])})};
                                pval_prim = []}};
                            {psig_desc =
                              Psig_value
                               {pval_name = {txt = "sync_next_version"};
                                pval_type =
                                 {ptyp_desc =
                                   Ptyp_arrow (Optional "v",
                                    {ptyp_desc =
                                      Ptyp_constr
                                       ({txt = Ldot (Lident "OM", "t")}, 
                                       [])},
                                    {ptyp_desc =
                                      Ptyp_constr ({txt = Lident "t"},
                                       [{ptyp_desc =
                                          Ptyp_constr
                                           ({txt = Ldot (Lident "OM", "t")},
                                           [])}])})};
                                pval_prim = []}};
                            {psig_desc =
                              Psig_value
                               {pval_name = {txt = "liftLwt"};
                                pval_type =
                                 {ptyp_desc =
                                   Ptyp_arrow (Nolabel,
                                    {ptyp_desc =
                                      Ptyp_constr
                                       ({txt = Ldot (Lident "Lwt", "t")},
                                       [{ptyp_desc = Ptyp_var "a"}])},
                                    {ptyp_desc =
                                      Ptyp_constr ({txt = Lident "t"},
                                       [{ptyp_desc = Ptyp_var "a"}])})};
                                pval_prim = []}}]})}}}]})})}}}]
=========
