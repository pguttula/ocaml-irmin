out_set.ml
==>
[{pstr_desc =
   Pstr_modtype
    {pmtd_name = {txt = "ATOM"};
     pmtd_type =
      Some
       {pmty_desc =
         Pmty_signature
          [{psig_desc =
             Psig_type (Recursive,
              [{ptype_name = {txt = "t"}; ptype_params = [];
                ptype_cstrs = []; ptype_kind = Ptype_abstract;
                ptype_private = Public; ptype_manifest = None}])};
           {psig_desc =
             Psig_value
              {pval_name = {txt = "t"};
               pval_type =
                {ptyp_desc =
                  Ptyp_constr
                   ({txt = Ldot (Ldot (Lident "Irmin", "Type"), "t")},
                   [{ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])}])};
               pval_prim = []}};
           {psig_desc =
             Psig_value
              {pval_name = {txt = "compare"};
               pval_type =
                {ptyp_desc =
                  Ptyp_arrow (Nolabel,
                   {ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])},
                   {ptyp_desc =
                     Ptyp_arrow (Nolabel,
                      {ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])},
                      {ptyp_desc = Ptyp_constr ({txt = Lident "int"}, [])})})};
               pval_prim = []}};
           {psig_desc =
             Psig_value
              {pval_name = {txt = "to_string"};
               pval_type =
                {ptyp_desc =
                  Ptyp_arrow (Nolabel,
                   {ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])},
                   {ptyp_desc = Ptyp_constr ({txt = Lident "string"}, [])})};
               pval_prim = []}};
           {psig_desc =
             Psig_value
              {pval_name = {txt = "of_string"};
               pval_type =
                {ptyp_desc =
                  Ptyp_arrow (Nolabel,
                   {ptyp_desc = Ptyp_constr ({txt = Lident "string"}, [])},
                   {ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])})};
               pval_prim = []}}]}}};
 {pstr_desc =
   Pstr_module
    {pmb_name = {txt = "Make"};
     pmb_expr =
      {pmod_desc =
        Pmod_functor ({txt = "Atom"},
         Some {pmty_desc = Pmty_ident {txt = Lident "ATOM"}},
         {pmod_desc =
           Pmod_structure
            [{pstr_desc =
               Pstr_type (Recursive,
                [{ptype_name = {txt = "atom"}; ptype_params = [];
                  ptype_cstrs = []; ptype_kind = Ptype_abstract;
                  ptype_private = Public;
                  ptype_manifest =
                   Some
                    {ptyp_desc =
                      Ptyp_constr ({txt = Ldot (Lident "Atom", "t")}, [])};
                  ptype_attributes =
                   [({txt = "derive"},
                     PStr
                      [{pstr_desc =
                         Pstr_eval
                          ({pexp_desc = Pexp_ident {txt = Lident "versioned"}},
                          ...)}])]}])};
             {pstr_desc =
               Pstr_type (Recursive,
                [{ptype_name = {txt = "node"}; ptype_params = [];
                  ptype_cstrs = [];
                  ptype_kind =
                   Ptype_record
                    [{pld_name = {txt = "l"}; pld_mutable = Immutable;
                      pld_type =
                       {ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])}};
                     {pld_name = {txt = "v"}; pld_mutable = Immutable;
                      pld_type =
                       {ptyp_desc = Ptyp_constr ({txt = Lident "atom"}, [])}};
                     {pld_name = {txt = "r"}; pld_mutable = Immutable;
                      pld_type =
                       {ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])}};
                     {pld_name = {txt = "h"}; pld_mutable = Immutable;
                      pld_type =
                       {ptyp_desc = Ptyp_constr ({txt = Lident "int"}, [])}}];
                  ptype_private = Public; ptype_manifest = None};
                 {ptype_name = {txt = "t"}; ptype_params = [];
                  ptype_cstrs = [];
                  ptype_kind =
                   Ptype_variant
                    [{pcd_name = {txt = "Empty"}; pcd_args = Pcstr_tuple [];
                      pcd_res = None};
                     {pcd_name = {txt = "Node"};
                      pcd_args =
                       Pcstr_tuple
                        [{ptyp_desc = Ptyp_constr ({txt = Lident "node"}, [])}];
                      pcd_res = None}];
                  ptype_private = Public; ptype_manifest = None;
                  ptype_attributes =
                   [({txt = "derive"},
                     PStr
                      [{pstr_desc =
                         Pstr_eval
                          ({pexp_desc = Pexp_ident {txt = Lident "versioned"}},
                          ...)}])]}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "height"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_function
                      [{pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Empty"}, None)};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_constant (Pconst_integer ("0", None))}};
                       {pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Node"},
                            Some
                             {ppat_desc =
                               Ppat_record
                                ([({txt = Lident "h"},
                                   {ppat_desc = Ppat_var {txt = "h"}})],
                                Open)})};
                        pc_guard = None;
                        pc_rhs = {pexp_desc = Pexp_ident {txt = Lident "h"}}}]}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "create"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "l"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "v"}},
                         {pexp_desc =
                           Pexp_fun (Nolabel, None,
                            {ppat_desc = Ppat_var {txt = "r"}},
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat =
                                  {ppat_desc = Ppat_var {txt = "hl"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_match
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "l"}},
                                     [{pc_lhs =
                                        {ppat_desc =
                                          Ppat_construct
                                           ({txt = Lident "Empty"}, None)};
                                       pc_guard = None;
                                       pc_rhs =
                                        {pexp_desc =
                                          Pexp_constant
                                           (Pconst_integer ("0", None))}};
                                      {pc_lhs =
                                        {ppat_desc =
                                          Ppat_construct
                                           ({txt = Lident "Node"},
                                           Some
                                            {ppat_desc =
                                              Ppat_record
                                               ([({txt = Lident "h"},
                                                  {ppat_desc =
                                                    Ppat_var {txt = "h"}})],
                                               Open)})};
                                       pc_guard = None;
                                       pc_rhs =
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "h"}}}])}}],
                               {pexp_desc =
                                 Pexp_let (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "hr"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_match
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "r"}},
                                        [{pc_lhs =
                                           {ppat_desc =
                                             Ppat_construct
                                              ({txt = Lident "Empty"}, None)};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_constant
                                              (Pconst_integer ("0", None))}};
                                         {pc_lhs =
                                           {ppat_desc =
                                             Ppat_construct
                                              ({txt = Lident "Node"},
                                              Some
                                               {ppat_desc =
                                                 Ppat_record
                                                  ([({txt = Lident "h"},
                                                     {ppat_desc =
                                                       Ppat_var {txt = "h"}})],
                                                  Open)})};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "h"}}}])}}],
                                  {pexp_desc =
                                    Pexp_construct ({txt = Lident "Node"},
                                     Some
                                      {pexp_desc =
                                        Pexp_record
                                         ([({txt = Lident "l"},
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "l"}});
                                           ({txt = Lident "v"},
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "v"}});
                                           ({txt = Lident "r"},
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "r"}});
                                           ({txt = Lident "h"},
                                            {pexp_desc =
                                              Pexp_ifthenelse
                                               ({pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident ">="}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "hl"}});
                                                    (Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "hr"}})])},
                                               {pexp_desc =
                                                 Pexp_apply
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "+"}},
                                                  [(Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "hl"}});
                                                   (Nolabel,
                                                    {pexp_desc =
                                                      Pexp_constant
                                                       (Pconst_integer ("1",
                                                         None))})])},
                                               Some
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "+"}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "hr"}});
                                                    (Nolabel,
                                                     {pexp_desc =
                                                       Pexp_constant
                                                        (Pconst_integer ("1",
                                                          None))})])})})],
                                         None)})})})})})})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "bal"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "l"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "v"}},
                         {pexp_desc =
                           Pexp_fun (Nolabel, None,
                            {ppat_desc = Ppat_var {txt = "r"}},
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat =
                                  {ppat_desc = Ppat_var {txt = "hl"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_match
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "l"}},
                                     [{pc_lhs =
                                        {ppat_desc =
                                          Ppat_construct
                                           ({txt = Lident "Empty"}, None)};
                                       pc_guard = None;
                                       pc_rhs =
                                        {pexp_desc =
                                          Pexp_constant
                                           (Pconst_integer ("0", None))}};
                                      {pc_lhs =
                                        {ppat_desc =
                                          Ppat_construct
                                           ({txt = Lident "Node"},
                                           Some
                                            {ppat_desc =
                                              Ppat_record
                                               ([({txt = Lident "h"},
                                                  {ppat_desc =
                                                    Ppat_var {txt = "h"}})],
                                               Open)})};
                                       pc_guard = None;
                                       pc_rhs =
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "h"}}}])}}],
                               {pexp_desc =
                                 Pexp_let (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "hr"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_match
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "r"}},
                                        [{pc_lhs =
                                           {ppat_desc =
                                             Ppat_construct
                                              ({txt = Lident "Empty"}, None)};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_constant
                                              (Pconst_integer ("0", None))}};
                                         {pc_lhs =
                                           {ppat_desc =
                                             Ppat_construct
                                              ({txt = Lident "Node"},
                                              Some
                                               {ppat_desc =
                                                 Ppat_record
                                                  ([({txt = Lident "h"},
                                                     {ppat_desc =
                                                       Ppat_var {txt = "h"}})],
                                                  Open)})};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "h"}}}])}}],
                                  {pexp_desc =
                                    Pexp_ifthenelse
                                     ({pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident {txt = Lident ">"}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "hl"}});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "+"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "hr"}});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_constant
                                                   (Pconst_integer ("2",
                                                     None))})])})])},
                                     {pexp_desc =
                                       Pexp_match
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "l"}},
                                        [{pc_lhs =
                                           {ppat_desc =
                                             Ppat_construct
                                              ({txt = Lident "Empty"}, None)};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "invalid_arg"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_constant
                                                   (Pconst_string ("Set.bal",
                                                     None))})])}};
                                         {pc_lhs =
                                           {ppat_desc =
                                             Ppat_construct
                                              ({txt = Lident "Node"},
                                              Some
                                               {ppat_desc =
                                                 Ppat_record
                                                  ([({txt = Lident "l"},
                                                     {ppat_desc =
                                                       Ppat_var {txt = "ll"}});
                                                    ({txt = Lident "v"},
                                                     {ppat_desc =
                                                       Ppat_var {txt = "lv"}});
                                                    ({txt = Lident "r"},
                                                     {ppat_desc =
                                                       Ppat_var {txt = "lr"}})],
                                                  Open)})};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_ifthenelse
                                              ({pexp_desc =
                                                 Pexp_apply
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident ">="}},
                                                  [(Nolabel,
                                                    {pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "height"}},
                                                       [(Nolabel,
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "ll"}})])});
                                                   (Nolabel,
                                                    {pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "height"}},
                                                       [(Nolabel,
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "lr"}})])})])},
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "create"}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "ll"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "lv"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "create"}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "lr"}});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "v"}});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "r"}})])})])},
                                              Some
                                               {pexp_desc =
                                                 Pexp_match
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "lr"}},
                                                  [{pc_lhs =
                                                     {ppat_desc =
                                                       Ppat_construct
                                                        ({txt =
                                                           Lident "Empty"},
                                                        None)};
                                                    pc_guard = None;
                                                    pc_rhs =
                                                     {pexp_desc =
                                                       Pexp_apply
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident
                                                               "invalid_arg"}},
                                                        [(Nolabel,
                                                          {pexp_desc =
                                                            Pexp_constant
                                                             (Pconst_string
                                                               ("Set.bal",
                                                               None))})])}};
                                                   {pc_lhs =
                                                     {ppat_desc =
                                                       Ppat_construct
                                                        ({txt = Lident "Node"},
                                                        Some
                                                         {ppat_desc =
                                                           Ppat_record
                                                            ([({txt =
                                                                 Lident "l"},
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt =
                                                                    "lrl"}});
                                                              ({txt =
                                                                 Lident "v"},
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt =
                                                                    "lrv"}});
                                                              ({txt =
                                                                 Lident "r"},
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt =
                                                                    "lrr"}})],
                                                            Open)})};
                                                    pc_guard = None;
                                                    pc_rhs =
                                                     {pexp_desc =
                                                       Pexp_apply
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "create"}},
                                                        [(Nolabel,
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "create"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "ll"}});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "lv"}});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "lrl"}})])});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "lrv"}});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "create"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "lrr"}});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "v"}});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "r"}})])})])}}])})}}])},
                                     Some
                                      {pexp_desc =
                                        Pexp_ifthenelse
                                         ({pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident {txt = Lident ">"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "hr"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_apply
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "+"}},
                                                  [(Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "hl"}});
                                                   (Nolabel,
                                                    {pexp_desc =
                                                      Pexp_constant
                                                       (Pconst_integer ("2",
                                                         None))})])})])},
                                         {pexp_desc =
                                           Pexp_match
                                            ({pexp_desc =
                                               Pexp_ident {txt = Lident "r"}},
                                            [{pc_lhs =
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "Empty"},
                                                  None)};
                                              pc_guard = None;
                                              pc_rhs =
                                               {pexp_desc =
                                                 Pexp_apply
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt =
                                                        Lident "invalid_arg"}},
                                                  [(Nolabel,
                                                    {pexp_desc =
                                                      Pexp_constant
                                                       (Pconst_string
                                                         ("Set.bal", None))})])}};
                                             {pc_lhs =
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "Node"},
                                                  Some
                                                   {ppat_desc =
                                                     Ppat_record
                                                      ([({txt = Lident "l"},
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "rl"}});
                                                        ({txt = Lident "v"},
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "rv"}});
                                                        ({txt = Lident "r"},
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "rr"}})],
                                                      Open)})};
                                              pc_guard = None;
                                              pc_rhs =
                                               {pexp_desc =
                                                 Pexp_ifthenelse
                                                  ({pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident ">="}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "height"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "rr"}})])});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "height"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "rl"}})])})])},
                                                  {pexp_desc =
                                                    Pexp_apply
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Lident "create"}},
                                                     [(Nolabel,
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident
                                                                 "create"}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "l"}});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "v"}});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "rl"}})])});
                                                      (Nolabel,
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident "rv"}});
                                                      (Nolabel,
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident "rr"}})])},
                                                  Some
                                                   {pexp_desc =
                                                     Pexp_match
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident "rl"}},
                                                      [{pc_lhs =
                                                         {ppat_desc =
                                                           Ppat_construct
                                                            ({txt =
                                                               Lident "Empty"},
                                                            None)};
                                                        pc_guard = None;
                                                        pc_rhs =
                                                         {pexp_desc =
                                                           Pexp_apply
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "invalid_arg"}},
                                                            [(Nolabel,
                                                              {pexp_desc =
                                                                Pexp_constant
                                                                 (Pconst_string
                                                                   ("Set.bal",
                                                                   None))})])}};
                                                       {pc_lhs =
                                                         {ppat_desc =
                                                           Ppat_construct
                                                            ({txt =
                                                               Lident "Node"},
                                                            Some
                                                             {ppat_desc =
                                                               Ppat_record
                                                                ([({txt =
                                                                    Lident
                                                                    "l"},
                                                                   {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "rll"}});
                                                                  ({txt =
                                                                    Lident
                                                                    "v"},
                                                                   {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "rlv"}});
                                                                  ({txt =
                                                                    Lident
                                                                    "r"},
                                                                   {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "rlr"}})],
                                                                Open)})};
                                                        pc_guard = None;
                                                        pc_rhs =
                                                         {pexp_desc =
                                                           Pexp_apply
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "create"}},
                                                            [(Nolabel,
                                                              {pexp_desc =
                                                                Pexp_apply
                                                                 ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "create"}},
                                                                 [(Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "l"}});
                                                                  (Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}});
                                                                  (Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "rll"}})])});
                                                             (Nolabel,
                                                              {pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "rlv"}});
                                                             (Nolabel,
                                                              {pexp_desc =
                                                                Pexp_apply
                                                                 ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "create"}},
                                                                 [(Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "rlr"}});
                                                                  (Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "rv"}});
                                                                  (Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "rr"}})])})])}}])})}}])},
                                         Some
                                          {pexp_desc =
                                            Pexp_construct
                                             ({txt = Lident "Node"},
                                             Some
                                              {pexp_desc =
                                                Pexp_record
                                                 ([({txt = Lident "l"},
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "l"}});
                                                   ({txt = Lident "v"},
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "v"}});
                                                   ({txt = Lident "r"},
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "r"}});
                                                   ({txt = Lident "h"},
                                                    {pexp_desc =
                                                      Pexp_ifthenelse
                                                       ({pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident ">="}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "hl"}});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "hr"}})])},
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "+"}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "hl"}});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_constant
                                                               (Pconst_integer
                                                                 ("1", None))})])},
                                                       Some
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "+"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "hr"}});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_constant
                                                                (Pconst_integer
                                                                  ("1", None))})])})})],
                                                 None)})})})})})})})})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "add"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "x"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_construct ({txt = Lident "Node"},
                               Some
                                {pexp_desc =
                                  Pexp_record
                                   ([({txt = Lident "l"},
                                      {pexp_desc =
                                        Pexp_construct
                                         ({txt = Lident "Empty"}, None)});
                                     ({txt = Lident "v"},
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "x"}});
                                     ({txt = Lident "r"},
                                      {pexp_desc =
                                        Pexp_construct
                                         ({txt = Lident "Empty"}, None)});
                                     ({txt = Lident "h"},
                                      {pexp_desc =
                                        Pexp_constant
                                         (Pconst_integer ("1", None))})],
                                   None)})}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_alias
                               ({ppat_desc =
                                  Ppat_construct ({txt = Lident "Node"},
                                   Some
                                    {ppat_desc =
                                      Ppat_record
                                       ([({txt = Lident "l"},
                                          {ppat_desc = Ppat_var {txt = "l"}});
                                         ({txt = Lident "v"},
                                          {ppat_desc = Ppat_var {txt = "v"}});
                                         ({txt = Lident "r"},
                                          {ppat_desc = Ppat_var {txt = "r"}})],
                                       Open)})},
                               {txt = "t"})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat = {ppat_desc = Ppat_var {txt = "c"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt =
                                           Ldot (Lident "Atom", "compare")}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "x"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "v"}})])}}],
                               {pexp_desc =
                                 Pexp_ifthenelse
                                  ({pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "="}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "c"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_constant
                                           (Pconst_integer ("0", None))})])},
                                  {pexp_desc = Pexp_ident {txt = Lident "t"}},
                                  Some
                                   {pexp_desc =
                                     Pexp_ifthenelse
                                      ({pexp_desc =
                                         Pexp_apply
                                          ({pexp_desc =
                                             Pexp_ident {txt = Lident "<"}},
                                          [(Nolabel,
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "c"}});
                                           (Nolabel,
                                            {pexp_desc =
                                              Pexp_constant
                                               (Pconst_integer ("0", None))})])},
                                      {pexp_desc =
                                        Pexp_let (Nonrecursive,
                                         [{pvb_pat =
                                            {ppat_desc =
                                              Ppat_var {txt = "ll"}};
                                           pvb_expr =
                                            {pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "add"}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "x"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "l"}})])}}],
                                         {pexp_desc =
                                           Pexp_ifthenelse
                                            ({pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "=="}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "l"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "ll"}})])},
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "t"}},
                                            Some
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "bal"}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "ll"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "v"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "r"}})])})})},
                                      Some
                                       {pexp_desc =
                                         Pexp_let (Nonrecursive,
                                          [{pvb_pat =
                                             {ppat_desc =
                                               Ppat_var {txt = "rr"}};
                                            pvb_expr =
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "add"}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "x"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "r"}})])}}],
                                          {pexp_desc =
                                            Pexp_ifthenelse
                                             ({pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "=="}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "r"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "rr"}})])},
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "t"}},
                                             Some
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "bal"}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "l"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "v"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "rr"}})])})})})})})}}]})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "singleton"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "x"}},
                      {pexp_desc =
                        Pexp_construct ({txt = Lident "Node"},
                         Some
                          {pexp_desc =
                            Pexp_record
                             ([({txt = Lident "l"},
                                {pexp_desc =
                                  Pexp_construct ({txt = Lident "Empty"},
                                   None)});
                               ({txt = Lident "v"},
                                {pexp_desc = Pexp_ident {txt = Lident "x"}});
                               ({txt = Lident "r"},
                                {pexp_desc =
                                  Pexp_construct ({txt = Lident "Empty"},
                                   None)});
                               ({txt = Lident "h"},
                                {pexp_desc =
                                  Pexp_constant (Pconst_integer ("1", None))})],
                             None)})})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "add_min_element"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "x"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident {txt = Lident "singleton"}},
                               [(Nolabel,
                                 {pexp_desc = Pexp_ident {txt = Lident "x"}})])}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Node"},
                               Some
                                {ppat_desc =
                                  Ppat_record
                                   ([({txt = Lident "l"},
                                      {ppat_desc = Ppat_var {txt = "l"}});
                                     ({txt = Lident "v"},
                                      {ppat_desc = Ppat_var {txt = "v"}});
                                     ({txt = Lident "r"},
                                      {ppat_desc = Ppat_var {txt = "r"}})],
                                   Open)})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc = Pexp_ident {txt = Lident "bal"}},
                               [(Nolabel,
                                 {pexp_desc =
                                   Pexp_apply
                                    ({pexp_desc =
                                       Pexp_ident
                                        {txt = Lident "add_min_element"}},
                                    [(Nolabel,
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "x"}});
                                     (Nolabel,
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "l"}})])});
                                (Nolabel,
                                 {pexp_desc = Pexp_ident {txt = Lident "v"}});
                                (Nolabel,
                                 {pexp_desc = Pexp_ident {txt = Lident "r"}})])}}]})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "add_max_element"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "x"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident {txt = Lident "singleton"}},
                               [(Nolabel,
                                 {pexp_desc = Pexp_ident {txt = Lident "x"}})])}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Node"},
                               Some
                                {ppat_desc =
                                  Ppat_record
                                   ([({txt = Lident "l"},
                                      {ppat_desc = Ppat_var {txt = "l"}});
                                     ({txt = Lident "v"},
                                      {ppat_desc = Ppat_var {txt = "v"}});
                                     ({txt = Lident "r"},
                                      {ppat_desc = Ppat_var {txt = "r"}})],
                                   Open)})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc = Pexp_ident {txt = Lident "bal"}},
                               [(Nolabel,
                                 {pexp_desc = Pexp_ident {txt = Lident "l"}});
                                (Nolabel,
                                 {pexp_desc = Pexp_ident {txt = Lident "v"}});
                                (Nolabel,
                                 {pexp_desc =
                                   Pexp_apply
                                    ({pexp_desc =
                                       Pexp_ident
                                        {txt = Lident "add_max_element"}},
                                    [(Nolabel,
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "x"}});
                                     (Nolabel,
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "r"}})])})])}}]})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "join"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "l"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "v"}},
                         {pexp_desc =
                           Pexp_fun (Nolabel, None,
                            {ppat_desc = Ppat_var {txt = "r"}},
                            {pexp_desc =
                              Pexp_match
                               ({pexp_desc =
                                  Pexp_tuple
                                   [{pexp_desc =
                                      Pexp_ident {txt = Lident "l"}};
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "r"}}]},
                               [{pc_lhs =
                                  {ppat_desc =
                                    Ppat_tuple
                                     [{ppat_desc =
                                        Ppat_construct
                                         ({txt = Lident "Empty"}, None)};
                                      {ppat_desc = Ppat_any}]};
                                 pc_guard = None;
                                 pc_rhs =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt = Lident "add_min_element"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "v"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "r"}})])}};
                                {pc_lhs =
                                  {ppat_desc =
                                    Ppat_tuple
                                     [{ppat_desc = Ppat_any};
                                      {ppat_desc =
                                        Ppat_construct
                                         ({txt = Lident "Empty"}, None)}]};
                                 pc_guard = None;
                                 pc_rhs =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt = Lident "add_max_element"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "v"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "l"}})])}};
                                {pc_lhs =
                                  {ppat_desc =
                                    Ppat_tuple
                                     [{ppat_desc =
                                        Ppat_construct
                                         ({txt = Lident "Node"},
                                         Some
                                          {ppat_desc =
                                            Ppat_record
                                             ([({txt = Lident "l"},
                                                {ppat_desc =
                                                  Ppat_var {txt = "ll"}});
                                               ({txt = Lident "v"},
                                                {ppat_desc =
                                                  Ppat_var {txt = "lv"}});
                                               ({txt = Lident "r"},
                                                {ppat_desc =
                                                  Ppat_var {txt = "lr"}});
                                               ({txt = Lident "h"},
                                                {ppat_desc =
                                                  Ppat_var {txt = "lh"}})],
                                             Closed)})};
                                      {ppat_desc =
                                        Ppat_construct
                                         ({txt = Lident "Node"},
                                         Some
                                          {ppat_desc =
                                            Ppat_record
                                             ([({txt = Lident "l"},
                                                {ppat_desc =
                                                  Ppat_var {txt = "rl"}});
                                               ({txt = Lident "v"},
                                                {ppat_desc =
                                                  Ppat_var {txt = "rv"}});
                                               ({txt = Lident "r"},
                                                {ppat_desc =
                                                  Ppat_var {txt = "rr"}});
                                               ({txt = Lident "h"},
                                                {ppat_desc =
                                                  Ppat_var {txt = "rh"}})],
                                             Closed)})}]};
                                 pc_guard = None;
                                 pc_rhs =
                                  {pexp_desc =
                                    Pexp_ifthenelse
                                     ({pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident {txt = Lident ">"}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "lh"}});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "+"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "rh"}});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_constant
                                                   (Pconst_integer ("2",
                                                     None))})])})])},
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "bal"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "ll"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "lv"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "join"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "lr"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "v"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "r"}})])})])},
                                     Some
                                      {pexp_desc =
                                        Pexp_ifthenelse
                                         ({pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident {txt = Lident ">"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "rh"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_apply
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "+"}},
                                                  [(Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "lh"}});
                                                   (Nolabel,
                                                    {pexp_desc =
                                                      Pexp_constant
                                                       (Pconst_integer ("2",
                                                         None))})])})])},
                                         {pexp_desc =
                                           Pexp_apply
                                            ({pexp_desc =
                                               Pexp_ident
                                                {txt = Lident "bal"}},
                                            [(Nolabel,
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "join"}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "l"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "v"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "rl"}})])});
                                             (Nolabel,
                                              {pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "rv"}});
                                             (Nolabel,
                                              {pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "rr"}})])},
                                         Some
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "create"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "l"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "v"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "r"}})])})})}}])})})})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "min_elt"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_function
                      [{pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Empty"}, None)};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_apply
                            ({pexp_desc = Pexp_ident {txt = Lident "raise"}},
                            [(Nolabel,
                              {pexp_desc =
                                Pexp_construct ({txt = Lident "Not_found"},
                                 None)})])}};
                       {pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Node"},
                            Some
                             {ppat_desc =
                               Ppat_record
                                ([({txt = Lident "l"},
                                   {ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)});
                                  ({txt = Lident "v"},
                                   {ppat_desc = Ppat_var {txt = "v"}})],
                                Open)})};
                        pc_guard = None;
                        pc_rhs = {pexp_desc = Pexp_ident {txt = Lident "v"}}};
                       {pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Node"},
                            Some
                             {ppat_desc =
                               Ppat_record
                                ([({txt = Lident "l"},
                                   {ppat_desc = Ppat_var {txt = "l"}})],
                                Open)})};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_apply
                            ({pexp_desc = Pexp_ident {txt = Lident "min_elt"}},
                            [(Nolabel,
                              {pexp_desc = Pexp_ident {txt = Lident "l"}})])}}]}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "min_elt_opt"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_function
                      [{pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Empty"}, None)};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_construct ({txt = Lident "None"}, None)}};
                       {pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Node"},
                            Some
                             {ppat_desc =
                               Ppat_record
                                ([({txt = Lident "l"},
                                   {ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)});
                                  ({txt = Lident "v"},
                                   {ppat_desc = Ppat_var {txt = "v"}})],
                                Open)})};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_construct ({txt = Lident "Some"},
                            Some {pexp_desc = Pexp_ident {txt = Lident "v"}})}};
                       {pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Node"},
                            Some
                             {ppat_desc =
                               Ppat_record
                                ([({txt = Lident "l"},
                                   {ppat_desc = Ppat_var {txt = "l"}})],
                                Open)})};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_apply
                            ({pexp_desc =
                               Pexp_ident {txt = Lident "min_elt_opt"}},
                            [(Nolabel,
                              {pexp_desc = Pexp_ident {txt = Lident "l"}})])}}]}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "max_elt"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_function
                      [{pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Empty"}, None)};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_apply
                            ({pexp_desc = Pexp_ident {txt = Lident "raise"}},
                            [(Nolabel,
                              {pexp_desc =
                                Pexp_construct ({txt = Lident "Not_found"},
                                 None)})])}};
                       {pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Node"},
                            Some
                             {ppat_desc =
                               Ppat_record
                                ([({txt = Lident "v"},
                                   {ppat_desc = Ppat_var {txt = "v"}});
                                  ({txt = Lident "r"},
                                   {ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)})],
                                Open)})};
                        pc_guard = None;
                        pc_rhs = {pexp_desc = Pexp_ident {txt = Lident "v"}}};
                       {pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Node"},
                            Some
                             {ppat_desc =
                               Ppat_record
                                ([({txt = Lident "r"},
                                   {ppat_desc = Ppat_var {txt = "r"}})],
                                Open)})};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_apply
                            ({pexp_desc = Pexp_ident {txt = Lident "max_elt"}},
                            [(Nolabel,
                              {pexp_desc = Pexp_ident {txt = Lident "r"}})])}}]}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "max_elt_opt"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_function
                      [{pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Empty"}, None)};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_construct ({txt = Lident "None"}, None)}};
                       {pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Node"},
                            Some
                             {ppat_desc =
                               Ppat_record
                                ([({txt = Lident "v"},
                                   {ppat_desc = Ppat_var {txt = "v"}});
                                  ({txt = Lident "r"},
                                   {ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)})],
                                Open)})};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_construct ({txt = Lident "Some"},
                            Some {pexp_desc = Pexp_ident {txt = Lident "v"}})}};
                       {pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Node"},
                            Some
                             {ppat_desc =
                               Ppat_record
                                ([({txt = Lident "r"},
                                   {ppat_desc = Ppat_var {txt = "r"}})],
                                Open)})};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_apply
                            ({pexp_desc =
                               Pexp_ident {txt = Lident "max_elt_opt"}},
                            [(Nolabel,
                              {pexp_desc = Pexp_ident {txt = Lident "r"}})])}}]}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "remove_min_elt"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_function
                      [{pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Empty"}, None)};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_apply
                            ({pexp_desc =
                               Pexp_ident {txt = Lident "invalid_arg"}},
                            [(Nolabel,
                              {pexp_desc =
                                Pexp_constant
                                 (Pconst_string ("Set.remove_min_elt", None))})])}};
                       {pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Node"},
                            Some
                             {ppat_desc =
                               Ppat_record
                                ([({txt = Lident "l"},
                                   {ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)});
                                  ({txt = Lident "r"},
                                   {ppat_desc = Ppat_var {txt = "r"}})],
                                Open)})};
                        pc_guard = None;
                        pc_rhs = {pexp_desc = Pexp_ident {txt = Lident "r"}}};
                       {pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Node"},
                            Some
                             {ppat_desc =
                               Ppat_record
                                ([({txt = Lident "l"},
                                   {ppat_desc = Ppat_var {txt = "l"}});
                                  ({txt = Lident "v"},
                                   {ppat_desc = Ppat_var {txt = "v"}});
                                  ({txt = Lident "r"},
                                   {ppat_desc = Ppat_var {txt = "r"}})],
                                Open)})};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_apply
                            ({pexp_desc = Pexp_ident {txt = Lident "bal"}},
                            [(Nolabel,
                              {pexp_desc =
                                Pexp_apply
                                 ({pexp_desc =
                                    Pexp_ident
                                     {txt = Lident "remove_min_elt"}},
                                 [(Nolabel,
                                   {pexp_desc = Pexp_ident {txt = Lident "l"}})])});
                             (Nolabel,
                              {pexp_desc = Pexp_ident {txt = Lident "v"}});
                             (Nolabel,
                              {pexp_desc = Pexp_ident {txt = Lident "r"}})])}}]}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "merge"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "t1"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "t2"}},
                         {pexp_desc =
                           Pexp_match
                            ({pexp_desc =
                               Pexp_tuple
                                [{pexp_desc = Pexp_ident {txt = Lident "t1"}};
                                 {pexp_desc = Pexp_ident {txt = Lident "t2"}}]},
                            [{pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)};
                                   {ppat_desc = Ppat_var {txt = "t"}}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc = Pexp_ident {txt = Lident "t"}}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc = Ppat_var {txt = "t"}};
                                   {ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc = Pexp_ident {txt = Lident "t"}}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc = Ppat_any};
                                   {ppat_desc = Ppat_any}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident {txt = Lident "bal"}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "t1"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_apply
                                       ({pexp_desc =
                                          Pexp_ident {txt = Lident "min_elt"}},
                                       [(Nolabel,
                                         {pexp_desc =
                                           Pexp_ident {txt = Lident "t2"}})])});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_apply
                                       ({pexp_desc =
                                          Pexp_ident
                                           {txt = Lident "remove_min_elt"}},
                                       [(Nolabel,
                                         {pexp_desc =
                                           Pexp_ident {txt = Lident "t2"}})])})])}}])})})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "concat"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "t1"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "t2"}},
                         {pexp_desc =
                           Pexp_match
                            ({pexp_desc =
                               Pexp_tuple
                                [{pexp_desc = Pexp_ident {txt = Lident "t1"}};
                                 {pexp_desc = Pexp_ident {txt = Lident "t2"}}]},
                            [{pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)};
                                   {ppat_desc = Ppat_var {txt = "t"}}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc = Pexp_ident {txt = Lident "t"}}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc = Ppat_var {txt = "t"}};
                                   {ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc = Pexp_ident {txt = Lident "t"}}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc = Ppat_any};
                                   {ppat_desc = Ppat_any}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident {txt = Lident "join"}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "t1"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_apply
                                       ({pexp_desc =
                                          Pexp_ident {txt = Lident "min_elt"}},
                                       [(Nolabel,
                                         {pexp_desc =
                                           Pexp_ident {txt = Lident "t2"}})])});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_apply
                                       ({pexp_desc =
                                          Pexp_ident
                                           {txt = Lident "remove_min_elt"}},
                                       [(Nolabel,
                                         {pexp_desc =
                                           Pexp_ident {txt = Lident "t2"}})])})])}}])})})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "split"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "x"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_tuple
                               [{pexp_desc =
                                  Pexp_construct ({txt = Lident "Empty"},
                                   None)};
                                {pexp_desc =
                                  Pexp_construct ({txt = Lident "false"},
                                   None)};
                                {pexp_desc =
                                  Pexp_construct ({txt = Lident "Empty"},
                                   None)}]}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Node"},
                               Some
                                {ppat_desc =
                                  Ppat_record
                                   ([({txt = Lident "l"},
                                      {ppat_desc = Ppat_var {txt = "l"}});
                                     ({txt = Lident "v"},
                                      {ppat_desc = Ppat_var {txt = "v"}});
                                     ({txt = Lident "r"},
                                      {ppat_desc = Ppat_var {txt = "r"}})],
                                   Open)})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat = {ppat_desc = Ppat_var {txt = "c"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt =
                                           Ldot (Lident "Atom", "compare")}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "x"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "v"}})])}}],
                               {pexp_desc =
                                 Pexp_ifthenelse
                                  ({pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "="}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "c"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_constant
                                           (Pconst_integer ("0", None))})])},
                                  {pexp_desc =
                                    Pexp_tuple
                                     [{pexp_desc =
                                        Pexp_ident {txt = Lident "l"}};
                                      {pexp_desc =
                                        Pexp_construct
                                         ({txt = Lident "true"}, None)};
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "r"}}]},
                                  Some
                                   {pexp_desc =
                                     Pexp_ifthenelse
                                      ({pexp_desc =
                                         Pexp_apply
                                          ({pexp_desc =
                                             Pexp_ident {txt = Lident "<"}},
                                          [(Nolabel,
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "c"}});
                                           (Nolabel,
                                            {pexp_desc =
                                              Pexp_constant
                                               (Pconst_integer ("0", None))})])},
                                      {pexp_desc =
                                        Pexp_let (Nonrecursive,
                                         [{pvb_pat =
                                            {ppat_desc =
                                              Ppat_tuple
                                               [{ppat_desc =
                                                  Ppat_var {txt = "ll"}};
                                                {ppat_desc =
                                                  Ppat_var {txt = "pres"}};
                                                {ppat_desc =
                                                  Ppat_var {txt = "rl"}}]};
                                           pvb_expr =
                                            {pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "split"}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "x"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "l"}})])}}],
                                         {pexp_desc =
                                           Pexp_tuple
                                            [{pexp_desc =
                                               Pexp_ident {txt = Lident "ll"}};
                                             {pexp_desc =
                                               Pexp_ident
                                                {txt = Lident "pres"}};
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "join"}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "rl"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "v"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "r"}})])}]})},
                                      Some
                                       {pexp_desc =
                                         Pexp_let (Nonrecursive,
                                          [{pvb_pat =
                                             {ppat_desc =
                                               Ppat_tuple
                                                [{ppat_desc =
                                                   Ppat_var {txt = "lr"}};
                                                 {ppat_desc =
                                                   Ppat_var {txt = "pres"}};
                                                 {ppat_desc =
                                                   Ppat_var {txt = "rr"}}]};
                                            pvb_expr =
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "split"}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "x"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "r"}})])}}],
                                          {pexp_desc =
                                            Pexp_tuple
                                             [{pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "join"}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "l"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "v"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "lr"}})])};
                                              {pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "pres"}};
                                              {pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "rr"}}]})})})})}}]})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "empty"}};
                  pvb_expr =
                   {pexp_desc = Pexp_construct ({txt = Lident "Empty"}, None)}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "is_empty"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_function
                      [{pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Empty"}, None)};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_construct ({txt = Lident "true"}, None)}};
                       {pc_lhs = {ppat_desc = Ppat_any}; pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_construct ({txt = Lident "false"}, None)}}]}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "mem"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "x"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_construct ({txt = Lident "false"}, None)}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Node"},
                               Some
                                {ppat_desc =
                                  Ppat_record
                                   ([({txt = Lident "l"},
                                      {ppat_desc = Ppat_var {txt = "l"}});
                                     ({txt = Lident "v"},
                                      {ppat_desc = Ppat_var {txt = "v"}});
                                     ({txt = Lident "r"},
                                      {ppat_desc = Ppat_var {txt = "r"}})],
                                   Open)})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat = {ppat_desc = Ppat_var {txt = "c"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt =
                                           Ldot (Lident "Atom", "compare")}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "x"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "v"}})])}}],
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident {txt = Lident "||"}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_apply
                                       ({pexp_desc =
                                          Pexp_ident {txt = Lident "="}},
                                       [(Nolabel,
                                         {pexp_desc =
                                           Pexp_ident {txt = Lident "c"}});
                                        (Nolabel,
                                         {pexp_desc =
                                           Pexp_constant
                                            (Pconst_integer ("0", None))})])});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_apply
                                       ({pexp_desc =
                                          Pexp_ident {txt = Lident "mem"}},
                                       [(Nolabel,
                                         {pexp_desc =
                                           Pexp_ident {txt = Lident "x"}});
                                        (Nolabel,
                                         {pexp_desc =
                                           Pexp_ifthenelse
                                            ({pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "<"}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "c"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_constant
                                                     (Pconst_integer ("0",
                                                       None))})])},
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "l"}},
                                            Some
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "r"}})})])})])})}}]})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "remove"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "x"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_construct ({txt = Lident "Empty"}, None)}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_alias
                               ({ppat_desc =
                                  Ppat_construct ({txt = Lident "Node"},
                                   Some
                                    {ppat_desc =
                                      Ppat_record
                                       ([({txt = Lident "l"},
                                          {ppat_desc = Ppat_var {txt = "l"}});
                                         ({txt = Lident "v"},
                                          {ppat_desc = Ppat_var {txt = "v"}});
                                         ({txt = Lident "r"},
                                          {ppat_desc = Ppat_var {txt = "r"}})],
                                       Open)})},
                               {txt = "t"})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat = {ppat_desc = Ppat_var {txt = "c"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt =
                                           Ldot (Lident "Atom", "compare")}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "x"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "v"}})])}}],
                               {pexp_desc =
                                 Pexp_ifthenelse
                                  ({pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "="}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "c"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_constant
                                           (Pconst_integer ("0", None))})])},
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "merge"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "l"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "r"}})])},
                                  Some
                                   {pexp_desc =
                                     Pexp_ifthenelse
                                      ({pexp_desc =
                                         Pexp_apply
                                          ({pexp_desc =
                                             Pexp_ident {txt = Lident "<"}},
                                          [(Nolabel,
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "c"}});
                                           (Nolabel,
                                            {pexp_desc =
                                              Pexp_constant
                                               (Pconst_integer ("0", None))})])},
                                      {pexp_desc =
                                        Pexp_let (Nonrecursive,
                                         [{pvb_pat =
                                            {ppat_desc =
                                              Ppat_var {txt = "ll"}};
                                           pvb_expr =
                                            {pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "remove"}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "x"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "l"}})])}}],
                                         {pexp_desc =
                                           Pexp_ifthenelse
                                            ({pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "=="}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "l"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "ll"}})])},
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "t"}},
                                            Some
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "bal"}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "ll"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "v"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "r"}})])})})},
                                      Some
                                       {pexp_desc =
                                         Pexp_let (Nonrecursive,
                                          [{pvb_pat =
                                             {ppat_desc =
                                               Ppat_var {txt = "rr"}};
                                            pvb_expr =
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "remove"}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "x"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "r"}})])}}],
                                          {pexp_desc =
                                            Pexp_ifthenelse
                                             ({pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "=="}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "r"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "rr"}})])},
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "t"}},
                                             Some
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "bal"}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "l"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "v"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "rr"}})])})})})})})}}]})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "union"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "s1"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "s2"}},
                         {pexp_desc =
                           Pexp_match
                            ({pexp_desc =
                               Pexp_tuple
                                [{pexp_desc = Pexp_ident {txt = Lident "s1"}};
                                 {pexp_desc = Pexp_ident {txt = Lident "s2"}}]},
                            [{pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)};
                                   {ppat_desc = Ppat_var {txt = "t2"}}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc = Pexp_ident {txt = Lident "t2"}}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc = Ppat_var {txt = "t1"}};
                                   {ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc = Pexp_ident {txt = Lident "t1"}}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc =
                                     Ppat_construct ({txt = Lident "Node"},
                                      Some
                                       {ppat_desc =
                                         Ppat_record
                                          ([({txt = Lident "l"},
                                             {ppat_desc =
                                               Ppat_var {txt = "l1"}});
                                            ({txt = Lident "v"},
                                             {ppat_desc =
                                               Ppat_var {txt = "v1"}});
                                            ({txt = Lident "r"},
                                             {ppat_desc =
                                               Ppat_var {txt = "r1"}});
                                            ({txt = Lident "h"},
                                             {ppat_desc =
                                               Ppat_var {txt = "h1"}})],
                                          Closed)})};
                                   {ppat_desc =
                                     Ppat_construct ({txt = Lident "Node"},
                                      Some
                                       {ppat_desc =
                                         Ppat_record
                                          ([({txt = Lident "l"},
                                             {ppat_desc =
                                               Ppat_var {txt = "l2"}});
                                            ({txt = Lident "v"},
                                             {ppat_desc =
                                               Ppat_var {txt = "v2"}});
                                            ({txt = Lident "r"},
                                             {ppat_desc =
                                               Ppat_var {txt = "r2"}});
                                            ({txt = Lident "h"},
                                             {ppat_desc =
                                               Ppat_var {txt = "h2"}})],
                                          Closed)})}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_ifthenelse
                                  ({pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident ">="}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "h1"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "h2"}})])},
                                  {pexp_desc =
                                    Pexp_ifthenelse
                                     ({pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident {txt = Lident "="}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "h2"}});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_constant
                                              (Pconst_integer ("1", None))})])},
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "add"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "v2"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "s1"}})])},
                                     Some
                                      {pexp_desc =
                                        Pexp_let (Nonrecursive,
                                         [{pvb_pat =
                                            {ppat_desc =
                                              Ppat_tuple
                                               [{ppat_desc =
                                                  Ppat_var {txt = "l2"}};
                                                {ppat_desc = Ppat_any};
                                                {ppat_desc =
                                                  Ppat_var {txt = "r2"}}]};
                                           pvb_expr =
                                            {pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "split"}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "v1"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "s2"}})])}}],
                                         {pexp_desc =
                                           Pexp_apply
                                            ({pexp_desc =
                                               Pexp_ident
                                                {txt = Lident "join"}},
                                            [(Nolabel,
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "union"}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "l1"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "l2"}})])});
                                             (Nolabel,
                                              {pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "v1"}});
                                             (Nolabel,
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "union"}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "r1"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "r2"}})])})])})})},
                                  Some
                                   {pexp_desc =
                                     Pexp_ifthenelse
                                      ({pexp_desc =
                                         Pexp_apply
                                          ({pexp_desc =
                                             Pexp_ident {txt = Lident "="}},
                                          [(Nolabel,
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "h1"}});
                                           (Nolabel,
                                            {pexp_desc =
                                              Pexp_constant
                                               (Pconst_integer ("1", None))})])},
                                      {pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident {txt = Lident "add"}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "v1"}});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "s2"}})])},
                                      Some
                                       {pexp_desc =
                                         Pexp_let (Nonrecursive,
                                          [{pvb_pat =
                                             {ppat_desc =
                                               Ppat_tuple
                                                [{ppat_desc =
                                                   Ppat_var {txt = "l1"}};
                                                 {ppat_desc = Ppat_any};
                                                 {ppat_desc =
                                                   Ppat_var {txt = "r1"}}]};
                                            pvb_expr =
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "split"}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "v2"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "s1"}})])}}],
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "join"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_apply
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "union"}},
                                                  [(Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "l1"}});
                                                   (Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "l2"}})])});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "v2"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_apply
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "union"}},
                                                  [(Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "r1"}});
                                                   (Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "r2"}})])})])})})})}}])})})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "inter"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "s1"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "s2"}},
                         {pexp_desc =
                           Pexp_match
                            ({pexp_desc =
                               Pexp_tuple
                                [{pexp_desc = Pexp_ident {txt = Lident "s1"}};
                                 {pexp_desc = Pexp_ident {txt = Lident "s2"}}]},
                            [{pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)};
                                   {ppat_desc = Ppat_any}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_construct ({txt = Lident "Empty"},
                                  None)}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc = Ppat_any};
                                   {ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_construct ({txt = Lident "Empty"},
                                  None)}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc =
                                     Ppat_construct ({txt = Lident "Node"},
                                      Some
                                       {ppat_desc =
                                         Ppat_record
                                          ([({txt = Lident "l"},
                                             {ppat_desc =
                                               Ppat_var {txt = "l1"}});
                                            ({txt = Lident "v"},
                                             {ppat_desc =
                                               Ppat_var {txt = "v1"}});
                                            ({txt = Lident "r"},
                                             {ppat_desc =
                                               Ppat_var {txt = "r1"}})],
                                          Open)})};
                                   {ppat_desc = Ppat_var {txt = "t2"}}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_match
                                  ({pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "split"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "v1"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "t2"}})])},
                                  [{pc_lhs =
                                     {ppat_desc =
                                       Ppat_tuple
                                        [{ppat_desc = Ppat_var {txt = "l2"}};
                                         {ppat_desc =
                                           Ppat_construct
                                            ({txt = Lident "false"}, None)};
                                         {ppat_desc = Ppat_var {txt = "r2"}}]};
                                    pc_guard = None;
                                    pc_rhs =
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "concat"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "inter"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "l1"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "l2"}})])});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "inter"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "r1"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "r2"}})])})])}};
                                   {pc_lhs =
                                     {ppat_desc =
                                       Ppat_tuple
                                        [{ppat_desc = Ppat_var {txt = "l2"}};
                                         {ppat_desc =
                                           Ppat_construct
                                            ({txt = Lident "true"}, None)};
                                         {ppat_desc = Ppat_var {txt = "r2"}}]};
                                    pc_guard = None;
                                    pc_rhs =
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "join"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "inter"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "l1"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "l2"}})])});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "v1"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "inter"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "r1"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "r2"}})])})])}}])}}])})})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "diff"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "s1"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "s2"}},
                         {pexp_desc =
                           Pexp_match
                            ({pexp_desc =
                               Pexp_tuple
                                [{pexp_desc = Pexp_ident {txt = Lident "s1"}};
                                 {pexp_desc = Pexp_ident {txt = Lident "s2"}}]},
                            [{pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)};
                                   {ppat_desc = Ppat_any}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_construct ({txt = Lident "Empty"},
                                  None)}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc = Ppat_var {txt = "t1"}};
                                   {ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc = Pexp_ident {txt = Lident "t1"}}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc =
                                     Ppat_construct ({txt = Lident "Node"},
                                      Some
                                       {ppat_desc =
                                         Ppat_record
                                          ([({txt = Lident "l"},
                                             {ppat_desc =
                                               Ppat_var {txt = "l1"}});
                                            ({txt = Lident "v"},
                                             {ppat_desc =
                                               Ppat_var {txt = "v1"}});
                                            ({txt = Lident "r"},
                                             {ppat_desc =
                                               Ppat_var {txt = "r1"}})],
                                          Open)})};
                                   {ppat_desc = Ppat_var {txt = "t2"}}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_match
                                  ({pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "split"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "v1"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "t2"}})])},
                                  [{pc_lhs =
                                     {ppat_desc =
                                       Ppat_tuple
                                        [{ppat_desc = Ppat_var {txt = "l2"}};
                                         {ppat_desc =
                                           Ppat_construct
                                            ({txt = Lident "false"}, None)};
                                         {ppat_desc = Ppat_var {txt = "r2"}}]};
                                    pc_guard = None;
                                    pc_rhs =
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "join"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "diff"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "l1"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "l2"}})])});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "v1"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "diff"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "r1"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "r2"}})])})])}};
                                   {pc_lhs =
                                     {ppat_desc =
                                       Ppat_tuple
                                        [{ppat_desc = Ppat_var {txt = "l2"}};
                                         {ppat_desc =
                                           Ppat_construct
                                            ({txt = Lident "true"}, None)};
                                         {ppat_desc = Ppat_var {txt = "r2"}}]};
                                    pc_guard = None;
                                    pc_rhs =
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "concat"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "diff"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "l1"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "l2"}})])});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "diff"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "r1"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "r2"}})])})])}}])}}])})})}}])};
             {pstr_desc =
               Pstr_type (Recursive,
                [{ptype_name = {txt = "enumeration"}; ptype_params = [];
                  ptype_cstrs = [];
                  ptype_kind =
                   Ptype_variant
                    [{pcd_name = {txt = "End"}; pcd_args = Pcstr_tuple [];
                      pcd_res = None};
                     {pcd_name = {txt = "More"};
                      pcd_args =
                       Pcstr_tuple
                        [{ptyp_desc = Ptyp_constr ({txt = Lident "atom"}, [])};
                         {ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])};
                         {ptyp_desc =
                           Ptyp_constr ({txt = Lident "enumeration"}, [])}];
                      pcd_res = None}];
                  ptype_private = Public; ptype_manifest = None}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "cons_enum"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "s"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "e"}},
                         {pexp_desc =
                           Pexp_match
                            ({pexp_desc = Pexp_ident {txt = Lident "s"}},
                            [{pc_lhs =
                               {ppat_desc =
                                 Ppat_construct ({txt = Lident "Empty"},
                                  None)};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc = Pexp_ident {txt = Lident "e"}}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_construct ({txt = Lident "Node"},
                                  Some
                                   {ppat_desc =
                                     Ppat_record
                                      ([({txt = Lident "l"},
                                         {ppat_desc = Ppat_var {txt = "l"}});
                                        ({txt = Lident "v"},
                                         {ppat_desc = Ppat_var {txt = "v"}});
                                        ({txt = Lident "r"},
                                         {ppat_desc = Ppat_var {txt = "r"}})],
                                      Open)})};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident {txt = Lident "cons_enum"}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "l"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_construct ({txt = Lident "More"},
                                       Some
                                        {pexp_desc =
                                          Pexp_tuple
                                           [{pexp_desc =
                                              Pexp_ident {txt = Lident "v"}};
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "r"}};
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "e"}}]})})])}}])})})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "compare_aux"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "e1"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "e2"}},
                         {pexp_desc =
                           Pexp_match
                            ({pexp_desc =
                               Pexp_tuple
                                [{pexp_desc = Pexp_ident {txt = Lident "e1"}};
                                 {pexp_desc = Pexp_ident {txt = Lident "e2"}}]},
                            [{pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc =
                                     Ppat_construct ({txt = Lident "End"},
                                      None)};
                                   {ppat_desc =
                                     Ppat_construct ({txt = Lident "End"},
                                      None)}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_constant (Pconst_integer ("0", None))}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc =
                                     Ppat_construct ({txt = Lident "End"},
                                      None)};
                                   {ppat_desc = Ppat_any}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_constant (Pconst_integer ("-1", None))}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc = Ppat_any};
                                   {ppat_desc =
                                     Ppat_construct ({txt = Lident "End"},
                                      None)}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_constant (Pconst_integer ("1", None))}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc =
                                     Ppat_construct ({txt = Lident "More"},
                                      Some
                                       {ppat_desc =
                                         Ppat_tuple
                                          [{ppat_desc = Ppat_var {txt = "v1"}};
                                           {ppat_desc = Ppat_var {txt = "r1"}};
                                           {ppat_desc = Ppat_var {txt = "e1"}}]})};
                                   {ppat_desc =
                                     Ppat_construct ({txt = Lident "More"},
                                      Some
                                       {ppat_desc =
                                         Ppat_tuple
                                          [{ppat_desc = Ppat_var {txt = "v2"}};
                                           {ppat_desc = Ppat_var {txt = "r2"}};
                                           {ppat_desc = Ppat_var {txt = "e2"}}]})}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_let (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "c"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident
                                            {txt =
                                              Ldot (Lident "Atom", "compare")}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "v1"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "v2"}})])}}],
                                  {pexp_desc =
                                    Pexp_ifthenelse
                                     ({pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident {txt = Lident "<>"}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "c"}});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_constant
                                              (Pconst_integer ("0", None))})])},
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "c"}},
                                     Some
                                      {pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident
                                             {txt = Lident "compare_aux"}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "cons_enum"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "r1"}});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "e1"}})])});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "cons_enum"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "r2"}});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "e2"}})])})])})})}}])})})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "compare"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "s1"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "s2"}},
                         {pexp_desc =
                           Pexp_apply
                            ({pexp_desc =
                               Pexp_ident {txt = Lident "compare_aux"}},
                            [(Nolabel,
                              {pexp_desc =
                                Pexp_apply
                                 ({pexp_desc =
                                    Pexp_ident {txt = Lident "cons_enum"}},
                                 [(Nolabel,
                                   {pexp_desc =
                                     Pexp_ident {txt = Lident "s1"}});
                                  (Nolabel,
                                   {pexp_desc =
                                     Pexp_construct ({txt = Lident "End"},
                                      None)})])});
                             (Nolabel,
                              {pexp_desc =
                                Pexp_apply
                                 ({pexp_desc =
                                    Pexp_ident {txt = Lident "cons_enum"}},
                                 [(Nolabel,
                                   {pexp_desc =
                                     Pexp_ident {txt = Lident "s2"}});
                                  (Nolabel,
                                   {pexp_desc =
                                     Pexp_construct ({txt = Lident "End"},
                                      None)})])})])})})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "equal"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "s1"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "s2"}},
                         {pexp_desc =
                           Pexp_apply
                            ({pexp_desc = Pexp_ident {txt = Lident "="}},
                            [(Nolabel,
                              {pexp_desc =
                                Pexp_apply
                                 ({pexp_desc =
                                    Pexp_ident {txt = Lident "compare"}},
                                 [(Nolabel,
                                   {pexp_desc =
                                     Pexp_ident {txt = Lident "s1"}});
                                  (Nolabel,
                                   {pexp_desc =
                                     Pexp_ident {txt = Lident "s2"}})])});
                             (Nolabel,
                              {pexp_desc =
                                Pexp_constant (Pconst_integer ("0", None))})])})})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "subset"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "s1"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "s2"}},
                         {pexp_desc =
                           Pexp_match
                            ({pexp_desc =
                               Pexp_tuple
                                [{pexp_desc = Pexp_ident {txt = Lident "s1"}};
                                 {pexp_desc = Pexp_ident {txt = Lident "s2"}}]},
                            [{pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)};
                                   {ppat_desc = Ppat_any}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_construct ({txt = Lident "true"}, None)}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc = Ppat_any};
                                   {ppat_desc =
                                     Ppat_construct ({txt = Lident "Empty"},
                                      None)}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_construct ({txt = Lident "false"},
                                  None)}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_tuple
                                  [{ppat_desc =
                                     Ppat_construct ({txt = Lident "Node"},
                                      Some
                                       {ppat_desc =
                                         Ppat_record
                                          ([({txt = Lident "l"},
                                             {ppat_desc =
                                               Ppat_var {txt = "l1"}});
                                            ({txt = Lident "v"},
                                             {ppat_desc =
                                               Ppat_var {txt = "v1"}});
                                            ({txt = Lident "r"},
                                             {ppat_desc =
                                               Ppat_var {txt = "r1"}})],
                                          Open)})};
                                   {ppat_desc =
                                     Ppat_alias
                                      ({ppat_desc =
                                         Ppat_construct
                                          ({txt = Lident "Node"},
                                          Some
                                           {ppat_desc =
                                             Ppat_record
                                              ([({txt = Lident "l"},
                                                 {ppat_desc =
                                                   Ppat_var {txt = "l2"}});
                                                ({txt = Lident "v"},
                                                 {ppat_desc =
                                                   Ppat_var {txt = "v2"}});
                                                ({txt = Lident "r"},
                                                 {ppat_desc =
                                                   Ppat_var {txt = "r2"}})],
                                              Open)})},
                                      {txt = "t2"})}]};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_let (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "c"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident
                                            {txt =
                                              Ldot (Lident "Atom", "compare")}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "v1"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "v2"}})])}}],
                                  {pexp_desc =
                                    Pexp_ifthenelse
                                     ({pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident {txt = Lident "="}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "c"}});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_constant
                                              (Pconst_integer ("0", None))})])},
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "&&"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "subset"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "l1"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "l2"}})])});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "subset"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "r1"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "r2"}})])})])},
                                     Some
                                      {pexp_desc =
                                        Pexp_ifthenelse
                                         ({pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident {txt = Lident "<"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "c"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_constant
                                                  (Pconst_integer ("0", None))})])},
                                         {pexp_desc =
                                           Pexp_apply
                                            ({pexp_desc =
                                               Pexp_ident {txt = Lident "&&"}},
                                            [(Nolabel,
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "subset"}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_construct
                                                      ({txt = Lident "Node"},
                                                      Some
                                                       {pexp_desc =
                                                         Pexp_record
                                                          ([({txt =
                                                               Lident "l"},
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "l1"}});
                                                            ({txt =
                                                               Lident "v"},
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "v1"}});
                                                            ({txt =
                                                               Lident "r"},
                                                             {pexp_desc =
                                                               Pexp_construct
                                                                ({txt =
                                                                   Lident
                                                                    "Empty"},
                                                                None)});
                                                            ({txt =
                                                               Lident "h"},
                                                             {pexp_desc =
                                                               Pexp_constant
                                                                (Pconst_integer
                                                                  ("0", None))})],
                                                          None)})});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "l2"}})])});
                                             (Nolabel,
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "subset"}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "r1"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "t2"}})])})])},
                                         Some
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "&&"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_apply
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "subset"}},
                                                  [(Nolabel,
                                                    {pexp_desc =
                                                      Pexp_construct
                                                       ({txt = Lident "Node"},
                                                       Some
                                                        {pexp_desc =
                                                          Pexp_record
                                                           ([({txt =
                                                                Lident "l"},
                                                              {pexp_desc =
                                                                Pexp_construct
                                                                 ({txt =
                                                                    Lident
                                                                    "Empty"},
                                                                 None)});
                                                             ({txt =
                                                                Lident "v"},
                                                              {pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "v1"}});
                                                             ({txt =
                                                                Lident "r"},
                                                              {pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "r1"}});
                                                             ({txt =
                                                                Lident "h"},
                                                              {pexp_desc =
                                                                Pexp_constant
                                                                 (Pconst_integer
                                                                   ("0",
                                                                   None))})],
                                                           None)})});
                                                   (Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "r2"}})])});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_apply
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "subset"}},
                                                  [(Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "l1"}});
                                                   (Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "t2"}})])})])})})})}}])})})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "iter"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "f"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_construct ({txt = Lident "()"}, None)}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Node"},
                               Some
                                {ppat_desc =
                                  Ppat_record
                                   ([({txt = Lident "l"},
                                      {ppat_desc = Ppat_var {txt = "l"}});
                                     ({txt = Lident "v"},
                                      {ppat_desc = Ppat_var {txt = "v"}});
                                     ({txt = Lident "r"},
                                      {ppat_desc = Ppat_var {txt = "r"}})],
                                   Open)})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_sequence
                               ({pexp_desc =
                                  Pexp_apply
                                   ({pexp_desc =
                                      Pexp_ident {txt = Lident "iter"}},
                                   [(Nolabel,
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "f"}});
                                    (Nolabel,
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "l"}})])},
                               {pexp_desc =
                                 Pexp_sequence
                                  ({pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "f"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "v"}})])},
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "iter"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "f"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "r"}})])})})}}]})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "fold"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "f"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "s"}},
                         {pexp_desc =
                           Pexp_fun (Nolabel, None,
                            {ppat_desc = Ppat_var {txt = "accu"}},
                            {pexp_desc =
                              Pexp_match
                               ({pexp_desc = Pexp_ident {txt = Lident "s"}},
                               [{pc_lhs =
                                  {ppat_desc =
                                    Ppat_construct ({txt = Lident "Empty"},
                                     None)};
                                 pc_guard = None;
                                 pc_rhs =
                                  {pexp_desc =
                                    Pexp_ident {txt = Lident "accu"}}};
                                {pc_lhs =
                                  {ppat_desc =
                                    Ppat_construct ({txt = Lident "Node"},
                                     Some
                                      {ppat_desc =
                                        Ppat_record
                                         ([({txt = Lident "l"},
                                            {ppat_desc = Ppat_var {txt = "l"}});
                                           ({txt = Lident "v"},
                                            {ppat_desc = Ppat_var {txt = "v"}});
                                           ({txt = Lident "r"},
                                            {ppat_desc = Ppat_var {txt = "r"}})],
                                         Open)})};
                                 pc_guard = None;
                                 pc_rhs =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "fold"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "f"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "r"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_apply
                                          ({pexp_desc =
                                             Pexp_ident {txt = Lident "f"}},
                                          [(Nolabel,
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "v"}});
                                           (Nolabel,
                                            {pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "fold"}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "f"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "l"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "accu"}})])})])})])}}])})})})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "for_all"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "p"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_construct ({txt = Lident "true"}, None)}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Node"},
                               Some
                                {ppat_desc =
                                  Ppat_record
                                   ([({txt = Lident "l"},
                                      {ppat_desc = Ppat_var {txt = "l"}});
                                     ({txt = Lident "v"},
                                      {ppat_desc = Ppat_var {txt = "v"}});
                                     ({txt = Lident "r"},
                                      {ppat_desc = Ppat_var {txt = "r"}})],
                                   Open)})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc = Pexp_ident {txt = Lident "&&"}},
                               [(Nolabel,
                                 {pexp_desc =
                                   Pexp_apply
                                    ({pexp_desc =
                                       Pexp_ident {txt = Lident "p"}},
                                    [(Nolabel,
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "v"}})])});
                                (Nolabel,
                                 {pexp_desc =
                                   Pexp_apply
                                    ({pexp_desc =
                                       Pexp_ident {txt = Lident "&&"}},
                                    [(Nolabel,
                                      {pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident
                                             {txt = Lident "for_all"}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "p"}});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "l"}})])});
                                     (Nolabel,
                                      {pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident
                                             {txt = Lident "for_all"}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "p"}});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "r"}})])})])})])}}]})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "exists"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "p"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_construct ({txt = Lident "false"}, None)}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Node"},
                               Some
                                {ppat_desc =
                                  Ppat_record
                                   ([({txt = Lident "l"},
                                      {ppat_desc = Ppat_var {txt = "l"}});
                                     ({txt = Lident "v"},
                                      {ppat_desc = Ppat_var {txt = "v"}});
                                     ({txt = Lident "r"},
                                      {ppat_desc = Ppat_var {txt = "r"}})],
                                   Open)})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc = Pexp_ident {txt = Lident "||"}},
                               [(Nolabel,
                                 {pexp_desc =
                                   Pexp_apply
                                    ({pexp_desc =
                                       Pexp_ident {txt = Lident "p"}},
                                    [(Nolabel,
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "v"}})])});
                                (Nolabel,
                                 {pexp_desc =
                                   Pexp_apply
                                    ({pexp_desc =
                                       Pexp_ident {txt = Lident "||"}},
                                    [(Nolabel,
                                      {pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident
                                             {txt = Lident "exists"}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "p"}});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "l"}})])});
                                     (Nolabel,
                                      {pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident
                                             {txt = Lident "exists"}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "p"}});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "r"}})])})])})])}}]})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "filter"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "p"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_construct ({txt = Lident "Empty"}, None)}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_alias
                               ({ppat_desc =
                                  Ppat_construct ({txt = Lident "Node"},
                                   Some
                                    {ppat_desc =
                                      Ppat_record
                                       ([({txt = Lident "l"},
                                          {ppat_desc = Ppat_var {txt = "l"}});
                                         ({txt = Lident "v"},
                                          {ppat_desc = Ppat_var {txt = "v"}});
                                         ({txt = Lident "r"},
                                          {ppat_desc = Ppat_var {txt = "r"}})],
                                       Open)})},
                               {txt = "t"})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat =
                                  {ppat_desc = Ppat_var {txt = "l'"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "filter"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "p"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "l"}})])}}],
                               {pexp_desc =
                                 Pexp_let (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "pv"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "p"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "v"}})])}}],
                                  {pexp_desc =
                                    Pexp_let (Nonrecursive,
                                     [{pvb_pat =
                                        {ppat_desc = Ppat_var {txt = "r'"}};
                                       pvb_expr =
                                        {pexp_desc =
                                          Pexp_apply
                                           ({pexp_desc =
                                              Pexp_ident
                                               {txt = Lident "filter"}},
                                           [(Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "p"}});
                                            (Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "r"}})])}}],
                                     {pexp_desc =
                                       Pexp_ifthenelse
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "pv"}},
                                        {pexp_desc =
                                          Pexp_ifthenelse
                                           ({pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "&&"}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "=="}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "l"}});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "l'"}})])});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "=="}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "r"}});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "r'"}})])})])},
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "t"}},
                                           Some
                                            {pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "join"}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "l'"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "v"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "r'"}})])})},
                                        Some
                                         {pexp_desc =
                                           Pexp_apply
                                            ({pexp_desc =
                                               Pexp_ident
                                                {txt = Lident "concat"}},
                                            [(Nolabel,
                                              {pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "l'"}});
                                             (Nolabel,
                                              {pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "r'"}})])})})})})}}]})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "partition"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "p"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_tuple
                               [{pexp_desc =
                                  Pexp_construct ({txt = Lident "Empty"},
                                   None)};
                                {pexp_desc =
                                  Pexp_construct ({txt = Lident "Empty"},
                                   None)}]}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Node"},
                               Some
                                {ppat_desc =
                                  Ppat_record
                                   ([({txt = Lident "l"},
                                      {ppat_desc = Ppat_var {txt = "l"}});
                                     ({txt = Lident "v"},
                                      {ppat_desc = Ppat_var {txt = "v"}});
                                     ({txt = Lident "r"},
                                      {ppat_desc = Ppat_var {txt = "r"}})],
                                   Open)})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat =
                                  {ppat_desc =
                                    Ppat_tuple
                                     [{ppat_desc = Ppat_var {txt = "lt"}};
                                      {ppat_desc = Ppat_var {txt = "lf"}}]};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "partition"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "p"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "l"}})])}}],
                               {pexp_desc =
                                 Pexp_let (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "pv"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "p"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "v"}})])}}],
                                  {pexp_desc =
                                    Pexp_let (Nonrecursive,
                                     [{pvb_pat =
                                        {ppat_desc =
                                          Ppat_tuple
                                           [{ppat_desc =
                                              Ppat_var {txt = "rt"}};
                                            {ppat_desc =
                                              Ppat_var {txt = "rf"}}]};
                                       pvb_expr =
                                        {pexp_desc =
                                          Pexp_apply
                                           ({pexp_desc =
                                              Pexp_ident
                                               {txt = Lident "partition"}},
                                           [(Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "p"}});
                                            (Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "r"}})])}}],
                                     {pexp_desc =
                                       Pexp_ifthenelse
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "pv"}},
                                        {pexp_desc =
                                          Pexp_tuple
                                           [{pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "join"}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "lt"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "v"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "rt"}})])};
                                            {pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "concat"}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "lf"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "rf"}})])}]},
                                        Some
                                         {pexp_desc =
                                           Pexp_tuple
                                            [{pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "concat"}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "lt"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "rt"}})])};
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "join"}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "lf"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "v"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "rf"}})])}]})})})})}}]})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "cardinal"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_function
                      [{pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Empty"}, None)};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_constant (Pconst_integer ("0", None))}};
                       {pc_lhs =
                         {ppat_desc =
                           Ppat_construct ({txt = Lident "Node"},
                            Some
                             {ppat_desc =
                               Ppat_record
                                ([({txt = Lident "l"},
                                   {ppat_desc = Ppat_var {txt = "l"}});
                                  ({txt = Lident "r"},
                                   {ppat_desc = Ppat_var {txt = "r"}})],
                                Open)})};
                        pc_guard = None;
                        pc_rhs =
                         {pexp_desc =
                           Pexp_apply
                            ({pexp_desc = Pexp_ident {txt = Lident "+"}},
                            [(Nolabel,
                              {pexp_desc =
                                Pexp_apply
                                 ({pexp_desc = Pexp_ident {txt = Lident "+"}},
                                 [(Nolabel,
                                   {pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "cardinal"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "l"}})])});
                                  (Nolabel,
                                   {pexp_desc =
                                     Pexp_constant
                                      (Pconst_integer ("1", None))})])});
                             (Nolabel,
                              {pexp_desc =
                                Pexp_apply
                                 ({pexp_desc =
                                    Pexp_ident {txt = Lident "cardinal"}},
                                 [(Nolabel,
                                   {pexp_desc = Pexp_ident {txt = Lident "r"}})])})])}}]}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "elements_aux"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "accu"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc = Pexp_ident {txt = Lident "accu"}}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Node"},
                               Some
                                {ppat_desc =
                                  Ppat_record
                                   ([({txt = Lident "l"},
                                      {ppat_desc = Ppat_var {txt = "l"}});
                                     ({txt = Lident "v"},
                                      {ppat_desc = Ppat_var {txt = "v"}});
                                     ({txt = Lident "r"},
                                      {ppat_desc = Ppat_var {txt = "r"}})],
                                   Open)})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident {txt = Lident "elements_aux"}},
                               [(Nolabel,
                                 {pexp_desc =
                                   Pexp_construct ({txt = Lident "::"},
                                    Some
                                     {pexp_desc =
                                       Pexp_tuple
                                        [{pexp_desc =
                                           Pexp_ident {txt = Lident "v"}};
                                         {pexp_desc =
                                           Pexp_apply
                                            ({pexp_desc =
                                               Pexp_ident
                                                {txt = Lident "elements_aux"}},
                                            [(Nolabel,
                                              {pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "accu"}});
                                             (Nolabel,
                                              {pexp_desc =
                                                Pexp_ident {txt = Lident "r"}})])}]})});
                                (Nolabel,
                                 {pexp_desc = Pexp_ident {txt = Lident "l"}})])}}]})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "elements"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "s"}},
                      {pexp_desc =
                        Pexp_apply
                         ({pexp_desc =
                            Pexp_ident {txt = Lident "elements_aux"}},
                         [(Nolabel,
                           {pexp_desc =
                             Pexp_construct ({txt = Lident "[]"}, None)});
                          (Nolabel,
                           {pexp_desc = Pexp_ident {txt = Lident "s"}})])})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "choose"}};
                  pvb_expr =
                   {pexp_desc = Pexp_ident {txt = Lident "min_elt"}}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "choose_opt"}};
                  pvb_expr =
                   {pexp_desc = Pexp_ident {txt = Lident "min_elt_opt"}}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "find"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "x"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident {txt = Lident "raise"}},
                               [(Nolabel,
                                 {pexp_desc =
                                   Pexp_construct
                                    ({txt = Lident "Not_found"}, None)})])}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Node"},
                               Some
                                {ppat_desc =
                                  Ppat_record
                                   ([({txt = Lident "l"},
                                      {ppat_desc = Ppat_var {txt = "l"}});
                                     ({txt = Lident "v"},
                                      {ppat_desc = Ppat_var {txt = "v"}});
                                     ({txt = Lident "r"},
                                      {ppat_desc = Ppat_var {txt = "r"}})],
                                   Open)})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat = {ppat_desc = Ppat_var {txt = "c"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt =
                                           Ldot (Lident "Atom", "compare")}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "x"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "v"}})])}}],
                               {pexp_desc =
                                 Pexp_ifthenelse
                                  ({pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "="}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "c"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_constant
                                           (Pconst_integer ("0", None))})])},
                                  {pexp_desc = Pexp_ident {txt = Lident "v"}},
                                  Some
                                   {pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "find"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "x"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_ifthenelse
                                           ({pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "<"}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "c"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_constant
                                                    (Pconst_integer ("0",
                                                      None))})])},
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "l"}},
                                           Some
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "r"}})})])})})}}]})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "find_first_aux"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "v0"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "f"}},
                         {pexp_desc =
                           Pexp_function
                            [{pc_lhs =
                               {ppat_desc =
                                 Ppat_construct ({txt = Lident "Empty"},
                                  None)};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc = Pexp_ident {txt = Lident "v0"}}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_construct ({txt = Lident "Node"},
                                  Some
                                   {ppat_desc =
                                     Ppat_record
                                      ([({txt = Lident "l"},
                                         {ppat_desc = Ppat_var {txt = "l"}});
                                        ({txt = Lident "v"},
                                         {ppat_desc = Ppat_var {txt = "v"}});
                                        ({txt = Lident "r"},
                                         {ppat_desc = Ppat_var {txt = "r"}})],
                                      Open)})};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_ifthenelse
                                  ({pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "f"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "v"}})])},
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt = Lident "find_first_aux"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "v"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "f"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "l"}})])},
                                  Some
                                   {pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident
                                          {txt = Lident "find_first_aux"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "v0"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "f"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "r"}})])})}}]})})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "find_first"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "f"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident {txt = Lident "raise"}},
                               [(Nolabel,
                                 {pexp_desc =
                                   Pexp_construct
                                    ({txt = Lident "Not_found"}, None)})])}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Node"},
                               Some
                                {ppat_desc =
                                  Ppat_record
                                   ([({txt = Lident "l"},
                                      {ppat_desc = Ppat_var {txt = "l"}});
                                     ({txt = Lident "v"},
                                      {ppat_desc = Ppat_var {txt = "v"}});
                                     ({txt = Lident "r"},
                                      {ppat_desc = Ppat_var {txt = "r"}})],
                                   Open)})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_ifthenelse
                               ({pexp_desc =
                                  Pexp_apply
                                   ({pexp_desc =
                                      Pexp_ident {txt = Lident "f"}},
                                   [(Nolabel,
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "v"}})])},
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident
                                      {txt = Lident "find_first_aux"}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "v"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "f"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "l"}})])},
                               Some
                                {pexp_desc =
                                  Pexp_apply
                                   ({pexp_desc =
                                      Pexp_ident {txt = Lident "find_first"}},
                                   [(Nolabel,
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "f"}});
                                    (Nolabel,
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "r"}})])})}}]})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat =
                   {ppat_desc = Ppat_var {txt = "find_first_opt_aux"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "v0"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "f"}},
                         {pexp_desc =
                           Pexp_function
                            [{pc_lhs =
                               {ppat_desc =
                                 Ppat_construct ({txt = Lident "Empty"},
                                  None)};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_construct ({txt = Lident "Some"},
                                  Some
                                   {pexp_desc =
                                     Pexp_ident {txt = Lident "v0"}})}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_construct ({txt = Lident "Node"},
                                  Some
                                   {ppat_desc =
                                     Ppat_record
                                      ([({txt = Lident "l"},
                                         {ppat_desc = Ppat_var {txt = "l"}});
                                        ({txt = Lident "v"},
                                         {ppat_desc = Ppat_var {txt = "v"}});
                                        ({txt = Lident "r"},
                                         {ppat_desc = Ppat_var {txt = "r"}})],
                                      Open)})};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_ifthenelse
                                  ({pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "f"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "v"}})])},
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt = Lident "find_first_opt_aux"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "v"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "f"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "l"}})])},
                                  Some
                                   {pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident
                                          {txt = Lident "find_first_opt_aux"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "v0"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "f"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "r"}})])})}}]})})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "find_first_opt"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "f"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_construct ({txt = Lident "None"}, None)}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Node"},
                               Some
                                {ppat_desc =
                                  Ppat_record
                                   ([({txt = Lident "l"},
                                      {ppat_desc = Ppat_var {txt = "l"}});
                                     ({txt = Lident "v"},
                                      {ppat_desc = Ppat_var {txt = "v"}});
                                     ({txt = Lident "r"},
                                      {ppat_desc = Ppat_var {txt = "r"}})],
                                   Open)})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_ifthenelse
                               ({pexp_desc =
                                  Pexp_apply
                                   ({pexp_desc =
                                      Pexp_ident {txt = Lident "f"}},
                                   [(Nolabel,
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "v"}})])},
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident
                                      {txt = Lident "find_first_opt_aux"}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "v"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "f"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "l"}})])},
                               Some
                                {pexp_desc =
                                  Pexp_apply
                                   ({pexp_desc =
                                      Pexp_ident
                                       {txt = Lident "find_first_opt"}},
                                   [(Nolabel,
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "f"}});
                                    (Nolabel,
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "r"}})])})}}]})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "find_last_aux"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "v0"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "f"}},
                         {pexp_desc =
                           Pexp_function
                            [{pc_lhs =
                               {ppat_desc =
                                 Ppat_construct ({txt = Lident "Empty"},
                                  None)};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc = Pexp_ident {txt = Lident "v0"}}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_construct ({txt = Lident "Node"},
                                  Some
                                   {ppat_desc =
                                     Ppat_record
                                      ([({txt = Lident "l"},
                                         {ppat_desc = Ppat_var {txt = "l"}});
                                        ({txt = Lident "v"},
                                         {ppat_desc = Ppat_var {txt = "v"}});
                                        ({txt = Lident "r"},
                                         {ppat_desc = Ppat_var {txt = "r"}})],
                                      Open)})};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_ifthenelse
                                  ({pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "f"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "v"}})])},
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt = Lident "find_last_aux"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "v"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "f"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "r"}})])},
                                  Some
                                   {pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident
                                          {txt = Lident "find_last_aux"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "v0"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "f"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "l"}})])})}}]})})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "find_last"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "f"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident {txt = Lident "raise"}},
                               [(Nolabel,
                                 {pexp_desc =
                                   Pexp_construct
                                    ({txt = Lident "Not_found"}, None)})])}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Node"},
                               Some
                                {ppat_desc =
                                  Ppat_record
                                   ([({txt = Lident "l"},
                                      {ppat_desc = Ppat_var {txt = "l"}});
                                     ({txt = Lident "v"},
                                      {ppat_desc = Ppat_var {txt = "v"}});
                                     ({txt = Lident "r"},
                                      {ppat_desc = Ppat_var {txt = "r"}})],
                                   Open)})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_ifthenelse
                               ({pexp_desc =
                                  Pexp_apply
                                   ({pexp_desc =
                                      Pexp_ident {txt = Lident "f"}},
                                   [(Nolabel,
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "v"}})])},
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident
                                      {txt = Lident "find_last_aux"}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "v"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "f"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "r"}})])},
                               Some
                                {pexp_desc =
                                  Pexp_apply
                                   ({pexp_desc =
                                      Pexp_ident {txt = Lident "find_last"}},
                                   [(Nolabel,
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "f"}});
                                    (Nolabel,
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "l"}})])})}}]})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat =
                   {ppat_desc = Ppat_var {txt = "find_last_opt_aux"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "v0"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "f"}},
                         {pexp_desc =
                           Pexp_function
                            [{pc_lhs =
                               {ppat_desc =
                                 Ppat_construct ({txt = Lident "Empty"},
                                  None)};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_construct ({txt = Lident "Some"},
                                  Some
                                   {pexp_desc =
                                     Pexp_ident {txt = Lident "v0"}})}};
                             {pc_lhs =
                               {ppat_desc =
                                 Ppat_construct ({txt = Lident "Node"},
                                  Some
                                   {ppat_desc =
                                     Ppat_record
                                      ([({txt = Lident "l"},
                                         {ppat_desc = Ppat_var {txt = "l"}});
                                        ({txt = Lident "v"},
                                         {ppat_desc = Ppat_var {txt = "v"}});
                                        ({txt = Lident "r"},
                                         {ppat_desc = Ppat_var {txt = "r"}})],
                                      Open)})};
                              pc_guard = None;
                              pc_rhs =
                               {pexp_desc =
                                 Pexp_ifthenelse
                                  ({pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "f"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "v"}})])},
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt = Lident "find_last_opt_aux"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "v"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "f"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "r"}})])},
                                  Some
                                   {pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident
                                          {txt = Lident "find_last_opt_aux"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "v0"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "f"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "l"}})])})}}]})})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "find_last_opt"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "f"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_construct ({txt = Lident "None"}, None)}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Node"},
                               Some
                                {ppat_desc =
                                  Ppat_record
                                   ([({txt = Lident "l"},
                                      {ppat_desc = Ppat_var {txt = "l"}});
                                     ({txt = Lident "v"},
                                      {ppat_desc = Ppat_var {txt = "v"}});
                                     ({txt = Lident "r"},
                                      {ppat_desc = Ppat_var {txt = "r"}})],
                                   Open)})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_ifthenelse
                               ({pexp_desc =
                                  Pexp_apply
                                   ({pexp_desc =
                                      Pexp_ident {txt = Lident "f"}},
                                   [(Nolabel,
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "v"}})])},
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident
                                      {txt = Lident "find_last_opt_aux"}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "v"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "f"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "r"}})])},
                               Some
                                {pexp_desc =
                                  Pexp_apply
                                   ({pexp_desc =
                                      Pexp_ident
                                       {txt = Lident "find_last_opt"}},
                                   [(Nolabel,
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "f"}});
                                    (Nolabel,
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "l"}})])})}}]})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "find_opt"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "x"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_construct ({txt = Lident "None"}, None)}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Node"},
                               Some
                                {ppat_desc =
                                  Ppat_record
                                   ([({txt = Lident "l"},
                                      {ppat_desc = Ppat_var {txt = "l"}});
                                     ({txt = Lident "v"},
                                      {ppat_desc = Ppat_var {txt = "v"}});
                                     ({txt = Lident "r"},
                                      {ppat_desc = Ppat_var {txt = "r"}})],
                                   Open)})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat = {ppat_desc = Ppat_var {txt = "c"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt =
                                           Ldot (Lident "Atom", "compare")}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "x"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "v"}})])}}],
                               {pexp_desc =
                                 Pexp_ifthenelse
                                  ({pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "="}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "c"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_constant
                                           (Pconst_integer ("0", None))})])},
                                  {pexp_desc =
                                    Pexp_construct ({txt = Lident "Some"},
                                     Some
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "v"}})},
                                  Some
                                   {pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "find_opt"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "x"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_ifthenelse
                                           ({pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "<"}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "c"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_constant
                                                    (Pconst_integer ("0",
                                                      None))})])},
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "l"}},
                                           Some
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "r"}})})])})})}}]})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "try_join"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "l"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "v"}},
                         {pexp_desc =
                           Pexp_fun (Nolabel, None,
                            {ppat_desc = Ppat_var {txt = "r"}},
                            {pexp_desc =
                              Pexp_ifthenelse
                               ({pexp_desc =
                                  Pexp_apply
                                   ({pexp_desc =
                                      Pexp_ident {txt = Lident "&&"}},
                                   [(Nolabel,
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "||"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident {txt = Lident "="}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "l"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_construct
                                                  ({txt = Lident "Empty"},
                                                  None)})])});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident {txt = Lident "<"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_apply
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt =
                                                        Ldot (Lident "Atom",
                                                         "compare")}},
                                                  [(Nolabel,
                                                    {pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "max_elt"}},
                                                       [(Nolabel,
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt = Lident "l"}})])});
                                                   (Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "v"}})])});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_constant
                                                  (Pconst_integer ("0", None))})])})])});
                                    (Nolabel,
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "||"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident {txt = Lident "="}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "r"}});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_construct
                                                  ({txt = Lident "Empty"},
                                                  None)})])});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident {txt = Lident "<"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_apply
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt =
                                                        Ldot (Lident "Atom",
                                                         "compare")}},
                                                  [(Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "v"}});
                                                   (Nolabel,
                                                    {pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "min_elt"}},
                                                       [(Nolabel,
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt = Lident "r"}})])})])});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_constant
                                                  (Pconst_integer ("0", None))})])})])})])},
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident {txt = Lident "join"}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "l"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "v"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "r"}})])},
                               Some
                                {pexp_desc =
                                  Pexp_apply
                                   ({pexp_desc =
                                      Pexp_ident {txt = Lident "union"}},
                                   [(Nolabel,
                                     {pexp_desc =
                                       Pexp_ident {txt = Lident "l"}});
                                    (Nolabel,
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "add"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "v"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "r"}})])})])})})})})}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "map"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "f"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Empty"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_construct ({txt = Lident "Empty"}, None)}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_alias
                               ({ppat_desc =
                                  Ppat_construct ({txt = Lident "Node"},
                                   Some
                                    {ppat_desc =
                                      Ppat_record
                                       ([({txt = Lident "l"},
                                          {ppat_desc = Ppat_var {txt = "l"}});
                                         ({txt = Lident "v"},
                                          {ppat_desc = Ppat_var {txt = "v"}});
                                         ({txt = Lident "r"},
                                          {ppat_desc = Ppat_var {txt = "r"}})],
                                       Open)})},
                               {txt = "t"})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat =
                                  {ppat_desc = Ppat_var {txt = "l'"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "map"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "f"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "l"}})])}}],
                               {pexp_desc =
                                 Pexp_let (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "v'"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "f"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "v"}})])}}],
                                  {pexp_desc =
                                    Pexp_let (Nonrecursive,
                                     [{pvb_pat =
                                        {ppat_desc = Ppat_var {txt = "r'"}};
                                       pvb_expr =
                                        {pexp_desc =
                                          Pexp_apply
                                           ({pexp_desc =
                                              Pexp_ident {txt = Lident "map"}},
                                           [(Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "f"}});
                                            (Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "r"}})])}}],
                                     {pexp_desc =
                                       Pexp_ifthenelse
                                        ({pexp_desc =
                                           Pexp_apply
                                            ({pexp_desc =
                                               Pexp_ident {txt = Lident "&&"}},
                                            [(Nolabel,
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "=="}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "l"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "l'"}})])});
                                             (Nolabel,
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "&&"}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident "=="}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "v"}});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "v'"}})])});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident "=="}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "r"}});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "r'"}})])})])})])},
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "t"}},
                                        Some
                                         {pexp_desc =
                                           Pexp_apply
                                            ({pexp_desc =
                                               Pexp_ident
                                                {txt = Lident "try_join"}},
                                            [(Nolabel,
                                              {pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "l'"}});
                                             (Nolabel,
                                              {pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "v'"}});
                                             (Nolabel,
                                              {pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "r'"}})])})})})})}}]})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "of_sorted_list"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "l"}},
                      {pexp_desc =
                        Pexp_let (Recursive,
                         [{pvb_pat = {ppat_desc = Ppat_var {txt = "sub"}};
                           pvb_expr =
                            {pexp_desc =
                              Pexp_fun (Nolabel, None,
                               {ppat_desc = Ppat_var {txt = "n"}},
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc = Ppat_var {txt = "l"}},
                                  {pexp_desc =
                                    Pexp_match
                                     ({pexp_desc =
                                        Pexp_tuple
                                         [{pexp_desc =
                                            Pexp_ident {txt = Lident "n"}};
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "l"}}]},
                                     [{pc_lhs =
                                        {ppat_desc =
                                          Ppat_tuple
                                           [{ppat_desc =
                                              Ppat_constant
                                               (Pconst_integer ("0", None))};
                                            {ppat_desc = Ppat_var {txt = "l"}}]};
                                       pc_guard = None;
                                       pc_rhs =
                                        {pexp_desc =
                                          Pexp_tuple
                                           [{pexp_desc =
                                              Pexp_construct
                                               ({txt = Lident "Empty"}, None)};
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "l"}}]}};
                                      {pc_lhs =
                                        {ppat_desc =
                                          Ppat_tuple
                                           [{ppat_desc =
                                              Ppat_constant
                                               (Pconst_integer ("1", None))};
                                            {ppat_desc =
                                              Ppat_construct
                                               ({txt = Lident "::"},
                                               Some
                                                {ppat_desc =
                                                  Ppat_tuple
                                                   [{ppat_desc =
                                                      Ppat_var {txt = "x0"}};
                                                    {ppat_desc =
                                                      Ppat_var {txt = "l"}}]})}]};
                                       pc_guard = None;
                                       pc_rhs =
                                        {pexp_desc =
                                          Pexp_tuple
                                           [{pexp_desc =
                                              Pexp_construct
                                               ({txt = Lident "Node"},
                                               Some
                                                {pexp_desc =
                                                  Pexp_record
                                                   ([({txt = Lident "l"},
                                                      {pexp_desc =
                                                        Pexp_construct
                                                         ({txt =
                                                            Lident "Empty"},
                                                         None)});
                                                     ({txt = Lident "v"},
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "x0"}});
                                                     ({txt = Lident "r"},
                                                      {pexp_desc =
                                                        Pexp_construct
                                                         ({txt =
                                                            Lident "Empty"},
                                                         None)});
                                                     ({txt = Lident "h"},
                                                      {pexp_desc =
                                                        Pexp_constant
                                                         (Pconst_integer
                                                           ("1", None))})],
                                                   None)})};
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "l"}}]}};
                                      {pc_lhs =
                                        {ppat_desc =
                                          Ppat_tuple
                                           [{ppat_desc =
                                              Ppat_constant
                                               (Pconst_integer ("2", None))};
                                            {ppat_desc =
                                              Ppat_construct
                                               ({txt = Lident "::"},
                                               Some
                                                {ppat_desc =
                                                  Ppat_tuple
                                                   [{ppat_desc =
                                                      Ppat_var {txt = "x0"}};
                                                    {ppat_desc =
                                                      Ppat_construct
                                                       ({txt = Lident "::"},
                                                       Some
                                                        {ppat_desc =
                                                          Ppat_tuple
                                                           [{ppat_desc =
                                                              Ppat_var
                                                               {txt = "x1"}};
                                                            {ppat_desc =
                                                              Ppat_var
                                                               {txt = "l"}}]})}]})}]};
                                       pc_guard = None;
                                       pc_rhs =
                                        {pexp_desc =
                                          Pexp_tuple
                                           [{pexp_desc =
                                              Pexp_construct
                                               ({txt = Lident "Node"},
                                               Some
                                                {pexp_desc =
                                                  Pexp_record
                                                   ([({txt = Lident "l"},
                                                      {pexp_desc =
                                                        Pexp_construct
                                                         ({txt =
                                                            Lident "Node"},
                                                         Some
                                                          {pexp_desc =
                                                            Pexp_record
                                                             ([({txt =
                                                                  Lident "l"},
                                                                {pexp_desc =
                                                                  Pexp_construct
                                                                   ({txt =
                                                                    Lident
                                                                    "Empty"},
                                                                   None)});
                                                               ({txt =
                                                                  Lident "v"},
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "x0"}});
                                                               ({txt =
                                                                  Lident "r"},
                                                                {pexp_desc =
                                                                  Pexp_construct
                                                                   ({txt =
                                                                    Lident
                                                                    "Empty"},
                                                                   None)});
                                                               ({txt =
                                                                  Lident "h"},
                                                                {pexp_desc =
                                                                  Pexp_constant
                                                                   (Pconst_integer
                                                                    ("1",
                                                                    None))})],
                                                             None)})});
                                                     ({txt = Lident "v"},
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "x1"}});
                                                     ({txt = Lident "r"},
                                                      {pexp_desc =
                                                        Pexp_construct
                                                         ({txt =
                                                            Lident "Empty"},
                                                         None)});
                                                     ({txt = Lident "h"},
                                                      {pexp_desc =
                                                        Pexp_constant
                                                         (Pconst_integer
                                                           ("2", None))})],
                                                   None)})};
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "l"}}]}};
                                      {pc_lhs =
                                        {ppat_desc =
                                          Ppat_tuple
                                           [{ppat_desc =
                                              Ppat_constant
                                               (Pconst_integer ("3", None))};
                                            {ppat_desc =
                                              Ppat_construct
                                               ({txt = Lident "::"},
                                               Some
                                                {ppat_desc =
                                                  Ppat_tuple
                                                   [{ppat_desc =
                                                      Ppat_var {txt = "x0"}};
                                                    {ppat_desc =
                                                      Ppat_construct
                                                       ({txt = Lident "::"},
                                                       Some
                                                        {ppat_desc =
                                                          Ppat_tuple
                                                           [{ppat_desc =
                                                              Ppat_var
                                                               {txt = "x1"}};
                                                            {ppat_desc =
                                                              Ppat_construct
                                                               ({txt =
                                                                  Lident "::"},
                                                               Some
                                                                {ppat_desc =
                                                                  Ppat_tuple
                                                                   [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "x2"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "l"}}]})}]})}]})}]};
                                       pc_guard = None;
                                       pc_rhs =
                                        {pexp_desc =
                                          Pexp_tuple
                                           [{pexp_desc =
                                              Pexp_construct
                                               ({txt = Lident "Node"},
                                               Some
                                                {pexp_desc =
                                                  Pexp_record
                                                   ([({txt = Lident "l"},
                                                      {pexp_desc =
                                                        Pexp_construct
                                                         ({txt =
                                                            Lident "Node"},
                                                         Some
                                                          {pexp_desc =
                                                            Pexp_record
                                                             ([({txt =
                                                                  Lident "l"},
                                                                {pexp_desc =
                                                                  Pexp_construct
                                                                   ({txt =
                                                                    Lident
                                                                    "Empty"},
                                                                   None)});
                                                               ({txt =
                                                                  Lident "v"},
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "x0"}});
                                                               ({txt =
                                                                  Lident "r"},
                                                                {pexp_desc =
                                                                  Pexp_construct
                                                                   ({txt =
                                                                    Lident
                                                                    "Empty"},
                                                                   None)});
                                                               ({txt =
                                                                  Lident "h"},
                                                                {pexp_desc =
                                                                  Pexp_constant
                                                                   (Pconst_integer
                                                                    ("1",
                                                                    None))})],
                                                             None)})});
                                                     ({txt = Lident "v"},
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "x1"}});
                                                     ({txt = Lident "r"},
                                                      {pexp_desc =
                                                        Pexp_construct
                                                         ({txt =
                                                            Lident "Node"},
                                                         Some
                                                          {pexp_desc =
                                                            Pexp_record
                                                             ([({txt =
                                                                  Lident "l"},
                                                                {pexp_desc =
                                                                  Pexp_construct
                                                                   ({txt =
                                                                    Lident
                                                                    "Empty"},
                                                                   None)});
                                                               ({txt =
                                                                  Lident "v"},
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "x2"}});
                                                               ({txt =
                                                                  Lident "r"},
                                                                {pexp_desc =
                                                                  Pexp_construct
                                                                   ({txt =
                                                                    Lident
                                                                    "Empty"},
                                                                   None)});
                                                               ({txt =
                                                                  Lident "h"},
                                                                {pexp_desc =
                                                                  Pexp_constant
                                                                   (Pconst_integer
                                                                    ("1",
                                                                    None))})],
                                                             None)})});
                                                     ({txt = Lident "h"},
                                                      {pexp_desc =
                                                        Pexp_constant
                                                         (Pconst_integer
                                                           ("2", None))})],
                                                   None)})};
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "l"}}]}};
                                      {pc_lhs =
                                        {ppat_desc =
                                          Ppat_tuple
                                           [{ppat_desc = Ppat_var {txt = "n"}};
                                            {ppat_desc = Ppat_var {txt = "l"}}]};
                                       pc_guard = None;
                                       pc_rhs =
                                        {pexp_desc =
                                          Pexp_let (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "nl"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "/"}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "n"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_constant
                                                      (Pconst_integer ("2",
                                                        None))})])}}],
                                           {pexp_desc =
                                             Pexp_let (Nonrecursive,
                                              [{pvb_pat =
                                                 {ppat_desc =
                                                   Ppat_tuple
                                                    [{ppat_desc =
                                                       Ppat_var
                                                        {txt = "left"}};
                                                     {ppat_desc =
                                                       Ppat_var {txt = "l"}}]};
                                                pvb_expr =
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "sub"}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "nl"}});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "l"}})])}}],
                                              {pexp_desc =
                                                Pexp_match
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "l"}},
                                                 [{pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_construct
                                                       ({txt = Lident "[]"},
                                                       None)};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_assert
                                                       {pexp_desc =
                                                         Pexp_construct
                                                          ({txt =
                                                             Lident "false"},
                                                          None)}}};
                                                  {pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_construct
                                                       ({txt = Lident "::"},
                                                       Some
                                                        {ppat_desc =
                                                          Ppat_tuple
                                                           [{ppat_desc =
                                                              Ppat_var
                                                               {txt = "mid"}};
                                                            {ppat_desc =
                                                              Ppat_var
                                                               {txt = "l"}}]})};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_let (Nonrecursive,
                                                       [{pvb_pat =
                                                          {ppat_desc =
                                                            Ppat_tuple
                                                             [{ppat_desc =
                                                                Ppat_var
                                                                 {txt =
                                                                   "right"}};
                                                              {ppat_desc =
                                                                Ppat_var
                                                                 {txt = "l"}}]};
                                                         pvb_expr =
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "sub"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_apply
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                  [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "n"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "nl"}})])});
                                                                   (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "l"}})])}}],
                                                       {pexp_desc =
                                                         Pexp_tuple
                                                          [{pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "create"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "left"}});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "mid"}});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "right"}})])};
                                                           {pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "l"}}]})}}])})})}}])})})}}],
                         {pexp_desc =
                           Pexp_apply
                            ({pexp_desc = Pexp_ident {txt = Lident "fst"}},
                            [(Nolabel,
                              {pexp_desc =
                                Pexp_apply
                                 ({pexp_desc =
                                    Pexp_ident {txt = Lident "sub"}},
                                 [(Nolabel,
                                   {pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident
                                          {txt =
                                            Ldot (Lident "List", "length")}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "l"}})])});
                                  (Nolabel,
                                   {pexp_desc = Pexp_ident {txt = Lident "l"}})])})])})})}}])};
             {pstr_desc =
               Pstr_type (Recursive,
                [{ptype_name = {txt = "edit"}; ptype_params = [];
                  ptype_cstrs = [];
                  ptype_kind =
                   Ptype_variant
                    [{pcd_name = {txt = "Add"};
                      pcd_args =
                       Pcstr_tuple
                        [{ptyp_desc = Ptyp_constr ({txt = Lident "atom"}, [])}];
                      pcd_res = None};
                     {pcd_name = {txt = "Remove"};
                      pcd_args =
                       Pcstr_tuple
                        [{ptyp_desc = Ptyp_constr ({txt = Lident "atom"}, [])}];
                      pcd_res = None}];
                  ptype_private = Public; ptype_manifest = None}])};
             {pstr_desc =
               Pstr_type (Recursive,
                [{ptype_name = {txt = "patch"}; ptype_params = [];
                  ptype_cstrs = []; ptype_kind = Ptype_abstract;
                  ptype_private = Public;
                  ptype_manifest =
                   Some
                    {ptyp_desc =
                      Ptyp_constr ({txt = Lident "list"},
                       [{ptyp_desc = Ptyp_constr ({txt = Lident "edit"}, [])}])}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "edit_to_string"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "atom_to_string"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Add"},
                               Some {ppat_desc = Ppat_var {txt = "a"}})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident
                                   {txt = Ldot (Lident "Printf", "sprintf")}},
                               [(Nolabel,
                                 {pexp_desc =
                                   Pexp_constant
                                    (Pconst_string ("Add (%s)", None))});
                                (Nolabel,
                                 {pexp_desc =
                                   Pexp_apply
                                    ({pexp_desc =
                                       Pexp_ident
                                        {txt = Lident "atom_to_string"}},
                                    [(Nolabel,
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "a"}})])})])}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Remove"},
                               Some {ppat_desc = Ppat_var {txt = "a"}})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident
                                   {txt = Ldot (Lident "Printf", "sprintf")}},
                               [(Nolabel,
                                 {pexp_desc =
                                   Pexp_constant
                                    (Pconst_string ("Remove (%s)", None))});
                                (Nolabel,
                                 {pexp_desc =
                                   Pexp_apply
                                    ({pexp_desc =
                                       Pexp_ident
                                        {txt = Lident "atom_to_string"}},
                                    [(Nolabel,
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "a"}})])})])}}]})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "op_diff"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "xt"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "yt"}},
                         {pexp_desc =
                           Pexp_let (Recursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "diff_avlt"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc = Ppat_var {txt = "s1"}},
                                  {pexp_desc =
                                    Pexp_fun (Nolabel, None,
                                     {ppat_desc = Ppat_var {txt = "s2"}},
                                     {pexp_desc =
                                       Pexp_match
                                        ({pexp_desc =
                                           Pexp_tuple
                                            [{pexp_desc =
                                               Pexp_ident {txt = Lident "s1"}};
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "s2"}}]},
                                        [{pc_lhs =
                                           {ppat_desc =
                                             Ppat_tuple
                                              [{ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "Empty"},
                                                  None)};
                                               {ppat_desc =
                                                 Ppat_var {txt = "t2"}}]};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "fold"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_fun (Nolabel, None,
                                                   {ppat_desc =
                                                     Ppat_var {txt = "x"}},
                                                   {pexp_desc =
                                                     Pexp_fun (Nolabel, None,
                                                      {ppat_desc =
                                                        Ppat_var {txt = "y"}},
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "@"}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "y"}});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_construct
                                                              ({txt =
                                                                 Lident "::"},
                                                              Some
                                                               {pexp_desc =
                                                                 Pexp_tuple
                                                                  [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Add"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}})};
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "[]"},
                                                                    None)}]})})])})})});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "t2"}});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_construct
                                                   ({txt = Lident "[]"},
                                                   None)})])}};
                                         {pc_lhs =
                                           {ppat_desc =
                                             Ppat_tuple
                                              [{ppat_desc =
                                                 Ppat_var {txt = "t1"}};
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "Empty"},
                                                  None)}]};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "fold"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_fun (Nolabel, None,
                                                   {ppat_desc =
                                                     Ppat_var {txt = "x"}},
                                                   {pexp_desc =
                                                     Pexp_fun (Nolabel, None,
                                                      {ppat_desc =
                                                        Ppat_var {txt = "y"}},
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "@"}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "y"}});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_construct
                                                              ({txt =
                                                                 Lident "::"},
                                                              Some
                                                               {pexp_desc =
                                                                 Pexp_tuple
                                                                  [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Remove"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}})};
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "[]"},
                                                                    None)}]})})])})})});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "t1"}});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_construct
                                                   ({txt = Lident "[]"},
                                                   None)})])}};
                                         {pc_lhs =
                                           {ppat_desc =
                                             Ppat_tuple
                                              [{ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "Node"},
                                                  Some
                                                   {ppat_desc =
                                                     Ppat_record
                                                      ([({txt = Lident "l"},
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "l1"}});
                                                        ({txt = Lident "v"},
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "v1"}});
                                                        ({txt = Lident "r"},
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "r1"}});
                                                        ({txt = Lident "h"},
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "h1"}})],
                                                      Closed)})};
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "Node"},
                                                  Some
                                                   {ppat_desc =
                                                     Ppat_record
                                                      ([({txt = Lident "l"},
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "l2"}});
                                                        ({txt = Lident "v"},
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "v2"}});
                                                        ({txt = Lident "r"},
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "r2"}});
                                                        ({txt = Lident "h"},
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "h2"}})],
                                                      Closed)})}]};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_ifthenelse
                                              ({pexp_desc =
                                                 Pexp_apply
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident ">="}},
                                                  [(Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "h1"}});
                                                   (Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "h2"}})])},
                                              {pexp_desc =
                                                Pexp_let (Nonrecursive,
                                                 [{pvb_pat =
                                                    {ppat_desc =
                                                      Ppat_tuple
                                                       [{ppat_desc =
                                                          Ppat_var
                                                           {txt = "l2"}};
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "p"}};
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "r2"}}]};
                                                   pvb_expr =
                                                    {pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "split"}},
                                                       [(Nolabel,
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "v1"}});
                                                        (Nolabel,
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "s2"}})])}}],
                                                 {pexp_desc =
                                                   Pexp_let (Nonrecursive,
                                                    [{pvb_pat =
                                                       {ppat_desc =
                                                         Ppat_var {txt = "l"}};
                                                      pvb_expr =
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident
                                                                 "diff_avlt"}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "l1"}});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "l2"}})])}}],
                                                    {pexp_desc =
                                                      Pexp_let (Nonrecursive,
                                                       [{pvb_pat =
                                                          {ppat_desc =
                                                            Ppat_var
                                                             {txt = "r"}};
                                                         pvb_expr =
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "diff_avlt"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "r1"}});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "r2"}})])}}],
                                                       {pexp_desc =
                                                         Pexp_ifthenelse
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "p"}},
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Ldot
                                                                    (
                                                                    Lident
                                                                    "List",
                                                                    "append")}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "l"}});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "r"}})])},
                                                          Some
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "List",
                                                                    "append")}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "l"}});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_construct
                                                                   ({txt =
                                                                    Lident
                                                                    "::"},
                                                                   Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Remove"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v1"}})};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "r"}}]})})])})})})})},
                                              Some
                                               {pexp_desc =
                                                 Pexp_let (Nonrecursive,
                                                  [{pvb_pat =
                                                     {ppat_desc =
                                                       Ppat_tuple
                                                        [{ppat_desc =
                                                           Ppat_var
                                                            {txt = "l1"}};
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "p"}};
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "r1"}}]};
                                                    pvb_expr =
                                                     {pexp_desc =
                                                       Pexp_apply
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "split"}},
                                                        [(Nolabel,
                                                          {pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "v2"}});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "s1"}})])}}],
                                                  {pexp_desc =
                                                    Pexp_let (Nonrecursive,
                                                     [{pvb_pat =
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "l"}};
                                                       pvb_expr =
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "diff_avlt"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "l1"}});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "l2"}})])}}],
                                                     {pexp_desc =
                                                       Pexp_let
                                                        (Nonrecursive,
                                                        [{pvb_pat =
                                                           {ppat_desc =
                                                             Ppat_var
                                                              {txt = "r"}};
                                                          pvb_expr =
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "diff_avlt"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "r1"}});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "r2"}})])}}],
                                                        {pexp_desc =
                                                          Pexp_ifthenelse
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "p"}},
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "List",
                                                                    "append")}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "l"}});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "r"}})])},
                                                           Some
                                                            {pexp_desc =
                                                              Pexp_apply
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "List",
                                                                    "append")}},
                                                               [(Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "l"}});
                                                                (Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_construct
                                                                    (
                                                                    {txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Add"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v2"}})};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "r"}}]})})])})})})})})}}])})})}}],
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident {txt = Lident "diff_avlt"}},
                               [(Nolabel,
                                 {pexp_desc = Pexp_ident {txt = Lident "xt"}});
                                (Nolabel,
                                 {pexp_desc = Pexp_ident {txt = Lident "yt"}})])})})})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "op_transform"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "p"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "q"}},
                         {pexp_desc =
                           Pexp_let (Recursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "transform_aux"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc = Ppat_var {txt = "xs"}},
                                  {pexp_desc =
                                    Pexp_fun (Nolabel, None,
                                     {ppat_desc = Ppat_var {txt = "ys"}},
                                     {pexp_desc =
                                       Pexp_match
                                        ({pexp_desc =
                                           Pexp_tuple
                                            [{pexp_desc =
                                               Pexp_ident {txt = Lident "xs"}};
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "ys"}}]},
                                        [{pc_lhs =
                                           {ppat_desc =
                                             Ppat_tuple
                                              [{ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "[]"}, None)};
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "[]"}, None)}]};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_tuple
                                              [{pexp_desc =
                                                 Pexp_construct
                                                  ({txt = Lident "[]"}, None)};
                                               {pexp_desc =
                                                 Pexp_construct
                                                  ({txt = Lident "[]"}, None)}]}};
                                         {pc_lhs =
                                           {ppat_desc =
                                             Ppat_tuple
                                              [{ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "[]"}, None)};
                                               {ppat_desc = Ppat_any}]};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_tuple
                                              [{pexp_desc =
                                                 Pexp_construct
                                                  ({txt = Lident "[]"}, None)};
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "ys"}}]}};
                                         {pc_lhs =
                                           {ppat_desc =
                                             Ppat_tuple
                                              [{ppat_desc = Ppat_any};
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "[]"}, None)}]};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_tuple
                                              [{pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "xs"}};
                                               {pexp_desc =
                                                 Pexp_construct
                                                  ({txt = Lident "[]"}, None)}]}};
                                         {pc_lhs =
                                           {ppat_desc =
                                             Ppat_tuple
                                              [{ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "::"},
                                                  Some
                                                   {ppat_desc =
                                                     Ppat_tuple
                                                      [{ppat_desc =
                                                         Ppat_var
                                                          {txt = "hx"}};
                                                       {ppat_desc =
                                                         Ppat_var
                                                          {txt = "rxs"}}]})};
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "::"},
                                                  Some
                                                   {ppat_desc =
                                                     Ppat_tuple
                                                      [{ppat_desc =
                                                         Ppat_var
                                                          {txt = "hy"}};
                                                       {ppat_desc =
                                                         Ppat_var
                                                          {txt = "rys"}}]})}]};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_let (Nonrecursive,
                                              [{pvb_pat =
                                                 {ppat_desc =
                                                   Ppat_var {txt = "handle"}};
                                                pvb_expr =
                                                 {pexp_desc =
                                                   Pexp_fun (Nolabel, None,
                                                    {ppat_desc =
                                                      Ppat_var {txt = "kx"}},
                                                    {pexp_desc =
                                                      Pexp_fun (Nolabel,
                                                       None,
                                                       {ppat_desc =
                                                         Ppat_var
                                                          {txt = "ky"}},
                                                       {pexp_desc =
                                                         Pexp_fun (Nolabel,
                                                          None,
                                                          {ppat_desc =
                                                            Ppat_var
                                                             {txt =
                                                               "on_conflict"}},
                                                          {pexp_desc =
                                                            Pexp_let
                                                             (Nonrecursive,
                                                             [{pvb_pat =
                                                                {ppat_desc =
                                                                  Ppat_var
                                                                   {txt = "c"}};
                                                               pvb_expr =
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Atom",
                                                                    "compare")}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "kx"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ky"}})])}}],
                                                             {pexp_desc =
                                                               Pexp_ifthenelse
                                                                ({pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "c"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("0",
                                                                    None))})])},
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "on_conflict"}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "()"},
                                                                    None)})])},
                                                                Some
                                                                 {pexp_desc =
                                                                   Pexp_ifthenelse
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "<"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "c"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("0",
                                                                    None))})])},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "a"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "b"}}]};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "transform_aux"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "rxs"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ys"}})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "hx"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}}]})};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}}]})},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "a"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "b"}}]};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "transform_aux"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "xs"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "rys"}})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "hy"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}}]})}]})})})})})})})}}],
                                              {pexp_desc =
                                                Pexp_match
                                                 ({pexp_desc =
                                                    Pexp_tuple
                                                     [{pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "hx"}};
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "hy"}}]},
                                                 [{pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_or
                                                       ({ppat_desc =
                                                          Ppat_tuple
                                                           [{ppat_desc =
                                                              Ppat_construct
                                                               ({txt =
                                                                  Lident
                                                                   "Add"},
                                                               Some
                                                                {ppat_desc =
                                                                  Ppat_var
                                                                   {txt = "x"}})};
                                                            {ppat_desc =
                                                              Ppat_construct
                                                               ({txt =
                                                                  Lident
                                                                   "Add"},
                                                               Some
                                                                {ppat_desc =
                                                                  Ppat_var
                                                                   {txt = "y"}})}]},
                                                       {ppat_desc =
                                                         Ppat_tuple
                                                          [{ppat_desc =
                                                             Ppat_construct
                                                              ({txt =
                                                                 Lident
                                                                  "Remove"},
                                                              Some
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt = "x"}})};
                                                           {ppat_desc =
                                                             Ppat_construct
                                                              ({txt =
                                                                 Lident
                                                                  "Remove"},
                                                              Some
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt = "y"}})}]})};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_let (Nonrecursive,
                                                       [{pvb_pat =
                                                          {ppat_desc =
                                                            Ppat_var
                                                             {txt =
                                                               "on_conflict"}};
                                                         pvb_expr =
                                                          {pexp_desc =
                                                            Pexp_fun
                                                             (Nolabel, None,
                                                             {ppat_desc =
                                                               Ppat_construct
                                                                ({txt =
                                                                   Lident
                                                                    "()"},
                                                                None)},
                                                             {pexp_desc =
                                                               Pexp_apply
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "transform_aux"}},
                                                                [(Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "rxs"}});
                                                                 (Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "rys"}})])})}}],
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident
                                                                 "handle"}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "x"}});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "y"}});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "on_conflict"}})])})}};
                                                  {pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_or
                                                       ({ppat_desc =
                                                          Ppat_tuple
                                                           [{ppat_desc =
                                                              Ppat_construct
                                                               ({txt =
                                                                  Lident
                                                                   "Add"},
                                                               Some
                                                                {ppat_desc =
                                                                  Ppat_var
                                                                   {txt = "x"}})};
                                                            {ppat_desc =
                                                              Ppat_construct
                                                               ({txt =
                                                                  Lident
                                                                   "Remove"},
                                                               Some
                                                                {ppat_desc =
                                                                  Ppat_var
                                                                   {txt = "y"}})}]},
                                                       {ppat_desc =
                                                         Ppat_tuple
                                                          [{ppat_desc =
                                                             Ppat_construct
                                                              ({txt =
                                                                 Lident
                                                                  "Remove"},
                                                              Some
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt = "x"}})};
                                                           {ppat_desc =
                                                             Ppat_construct
                                                              ({txt =
                                                                 Lident "Add"},
                                                              Some
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt = "y"}})}]})};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_let (Nonrecursive,
                                                       [{pvb_pat =
                                                          {ppat_desc =
                                                            Ppat_var
                                                             {txt =
                                                               "on_conflict"}};
                                                         pvb_expr =
                                                          {pexp_desc =
                                                            Pexp_fun
                                                             (Nolabel, None,
                                                             {ppat_desc =
                                                               Ppat_construct
                                                                ({txt =
                                                                   Lident
                                                                    "()"},
                                                                None)},
                                                             {pexp_desc =
                                                               Pexp_assert
                                                                {pexp_desc =
                                                                  Pexp_construct
                                                                   ({txt =
                                                                    Lident
                                                                    "false"},
                                                                   None)}})}}],
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident
                                                                 "handle"}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "x"}});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "y"}});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "on_conflict"}})])})}}])})}}])})})}}],
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident {txt = Lident "transform_aux"}},
                               [(Nolabel,
                                 {pexp_desc = Pexp_ident {txt = Lident "p"}});
                                (Nolabel,
                                 {pexp_desc = Pexp_ident {txt = Lident "q"}})])})})})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "resolve"}};
                  pvb_expr = {pexp_desc = Pexp_ident {txt = Lident "union"}}}])};
             {pstr_desc =
               Pstr_value (Recursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "apply"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "s"}},
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "[]"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc = Pexp_ident {txt = Lident "s"}}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "::"},
                               Some
                                {ppat_desc =
                                  Ppat_tuple
                                   [{ppat_desc =
                                      Ppat_construct ({txt = Lident "Add"},
                                       Some
                                        {ppat_desc = Ppat_var {txt = "x"}})};
                                    {ppat_desc = Ppat_var {txt = "r"}}]})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat =
                                  {ppat_desc = Ppat_var {txt = "s'"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "add"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "x"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "s"}})])}}],
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident {txt = Lident "apply"}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "s'"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "r"}})])})}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "::"},
                               Some
                                {ppat_desc =
                                  Ppat_tuple
                                   [{ppat_desc =
                                      Ppat_construct
                                       ({txt = Lident "Remove"},
                                       Some
                                        {ppat_desc = Ppat_var {txt = "x"}})};
                                    {ppat_desc = Ppat_var {txt = "r"}}]})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat =
                                  {ppat_desc = Ppat_var {txt = "s'"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "remove"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "x"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "s"}})])}}],
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident {txt = Lident "apply"}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "s'"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "r"}})])})}}]})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "print_set"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "f"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "s"}},
                         {pexp_desc =
                           Pexp_let (Recursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "print_elements"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_function
                                  [{pc_lhs =
                                     {ppat_desc =
                                       Ppat_construct
                                        ({txt = Lident "Empty"}, None)};
                                    pc_guard = None;
                                    pc_rhs =
                                     {pexp_desc =
                                       Pexp_construct ({txt = Lident "()"},
                                        None)}};
                                   {pc_lhs =
                                     {ppat_desc =
                                       Ppat_construct ({txt = Lident "Node"},
                                        Some
                                         {ppat_desc =
                                           Ppat_record
                                            ([({txt = Lident "l"},
                                               {ppat_desc =
                                                 Ppat_var {txt = "l"}});
                                              ({txt = Lident "v"},
                                               {ppat_desc =
                                                 Ppat_var {txt = "v"}});
                                              ({txt = Lident "r"},
                                               {ppat_desc =
                                                 Ppat_var {txt = "r"}});
                                              ({txt = Lident "h"},
                                               {ppat_desc =
                                                 Ppat_var {txt = "h"}})],
                                            Closed)})};
                                    pc_guard = None;
                                    pc_rhs =
                                     {pexp_desc =
                                       Pexp_sequence
                                        ({pexp_desc =
                                           Pexp_apply
                                            ({pexp_desc =
                                               Pexp_ident
                                                {txt =
                                                  Lident "print_elements"}},
                                            [(Nolabel,
                                              {pexp_desc =
                                                Pexp_ident {txt = Lident "l"}})])},
                                        {pexp_desc =
                                          Pexp_sequence
                                           ({pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt =
                                                     Lident "print_string"}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_constant
                                                    (Pconst_string (";",
                                                      None))})])},
                                           {pexp_desc =
                                             Pexp_sequence
                                              ({pexp_desc =
                                                 Pexp_apply
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "f"}},
                                                  [(Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "v"}})])},
                                              {pexp_desc =
                                                Pexp_sequence
                                                 ({pexp_desc =
                                                    Pexp_apply
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Lident
                                                            "print_string"}},
                                                     [(Nolabel,
                                                       {pexp_desc =
                                                         Pexp_constant
                                                          (Pconst_string
                                                            (";", None))})])},
                                                 {pexp_desc =
                                                   Pexp_sequence
                                                    ({pexp_desc =
                                                       Pexp_apply
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident
                                                               "print_elements"}},
                                                        [(Nolabel,
                                                          {pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "r"}})])},
                                                    {pexp_desc =
                                                      Pexp_sequence
                                                       ({pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "print_string"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_constant
                                                                (Pconst_string
                                                                  (";", None))})])},
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident
                                                                 "print_int"}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "h"}})])})})})})})})}}]}}],
                            {pexp_desc =
                              Pexp_sequence
                               ({pexp_desc =
                                  Pexp_apply
                                   ({pexp_desc =
                                      Pexp_ident
                                       {txt = Lident "print_string"}},
                                   [(Nolabel,
                                     {pexp_desc =
                                       Pexp_constant
                                        (Pconst_string ("{", None))})])},
                               {pexp_desc =
                                 Pexp_sequence
                                  ({pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident
                                          {txt = Lident "print_elements"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "s"}})])},
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt = Lident "print_string"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_constant
                                          (Pconst_string ("}", None))})])})})})})})}}])};
             {pstr_desc =
               Pstr_value (Nonrecursive,
                [{pvb_pat = {ppat_desc = Ppat_var {txt = "merge3"}};
                  pvb_expr =
                   {pexp_desc =
                     Pexp_fun (Labelled "ancestor", None,
                      {ppat_desc = Ppat_var {txt = "ancestor"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "l"}},
                         {pexp_desc =
                           Pexp_fun (Nolabel, None,
                            {ppat_desc = Ppat_var {txt = "r"}},
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat = {ppat_desc = Ppat_var {txt = "p"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "op_diff"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "ancestor"}});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "l"}})])}}],
                               {pexp_desc =
                                 Pexp_let (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "q"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident
                                            {txt = Lident "op_diff"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident
                                             {txt = Lident "ancestor"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "r"}})])}}],
                                  {pexp_desc =
                                    Pexp_let (Nonrecursive,
                                     [{pvb_pat =
                                        {ppat_desc =
                                          Ppat_tuple
                                           [{ppat_desc = Ppat_any};
                                            {ppat_desc =
                                              Ppat_var {txt = "q'"}}]};
                                       pvb_expr =
                                        {pexp_desc =
                                          Pexp_apply
                                           ({pexp_desc =
                                              Pexp_ident
                                               {txt = Lident "op_transform"}},
                                           [(Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "p"}});
                                            (Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "q"}})])}}],
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "apply"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "l"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "q'"}})])})})})})})})}}])}]})};
     pmb_attributes = [({txt = "derive_versioned"}, PStr [])]}};
 {pstr_desc =
   Pstr_open
    {popen_lid = {txt = Ldot (Lident "Lwt", "Infix")};
     popen_override = Fresh}};
 {pstr_desc =
   Pstr_open
    {popen_lid = {txt = Lident "Irmin_unix"}; popen_override = Fresh}};
 {pstr_desc =
   Pstr_modtype
    {pmtd_name = {txt = "Config"};
     pmtd_type =
      Some
       {pmty_desc =
         Pmty_signature
          [{psig_desc =
             Psig_value
              {pval_name = {txt = "root"};
               pval_type =
                {ptyp_desc = Ptyp_constr ({txt = Lident "string"}, [])};
               pval_prim = []}};
           {psig_desc =
             Psig_value
              {pval_name = {txt = "shared"};
               pval_type =
                {ptyp_desc = Ptyp_constr ({txt = Lident "string"}, [])};
               pval_prim = []}};
           {psig_desc =
             Psig_value
              {pval_name = {txt = "init"};
               pval_type =
                {ptyp_desc =
                  Ptyp_arrow (Nolabel,
                   {ptyp_desc = Ptyp_constr ({txt = Lident "unit"}, [])},
                   {ptyp_desc = Ptyp_constr ({txt = Lident "unit"}, [])})};
               pval_prim = []}}]}}};
 {pstr_desc =
   Pstr_module
    {pmb_name = {txt = "MakeVersioned"};
     pmb_expr =
      {pmod_desc =
        Pmod_functor ({txt = "Config"},
         Some {pmty_desc = Pmty_ident {txt = Lident "Config"}},
         {pmod_desc =
           Pmod_functor ({txt = "Atom"},
            Some
             {pmty_desc = Pmty_ident {txt = Ldot (Lident "Set_imp", "ATOM")}},
            {pmod_desc =
              Pmod_structure
               [{pstr_desc =
                  Pstr_module
                   {pmb_name = {txt = "OM"};
                    pmb_expr =
                     {pmod_desc =
                       Pmod_apply
                        ({pmod_desc =
                           Pmod_ident {txt = Ldot (Lident "Set_imp", "Make")}},
                        {pmod_desc = Pmod_ident {txt = Lident "Atom"}})}}};
                {pstr_desc =
                  Pstr_module
                   {pmb_name = {txt = "K"};
                    pmb_expr =
                     {pmod_desc =
                       Pmod_ident
                        {txt = Ldot (Ldot (Lident "Irmin", "Hash"), "SHA1")}}}};
                {pstr_desc =
                  Pstr_value (Nonrecursive,
                   [{pvb_pat = {ppat_desc = Ppat_var {txt = "from_just"}};
                     pvb_expr =
                      {pexp_desc =
                        Pexp_function
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "Some"},
                               Some {ppat_desc = Ppat_var {txt = "x"}})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc = Pexp_ident {txt = Lident "x"}}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "None"}, None)};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident {txt = Lident "failwith"}},
                               [(Nolabel,
                                 {pexp_desc =
                                   Pexp_constant
                                    (Pconst_string
                                      ("Expected Some. Got None.", None))})])}}]}}])};
                {pstr_desc =
                  Pstr_type (Recursive,
                   [{ptype_name = {txt = "vnode"}; ptype_params = [];
                     ptype_cstrs = [];
                     ptype_kind =
                      Ptype_record
                       [{pld_name = {txt = "l"}; pld_mutable = Immutable;
                         pld_type =
                          {ptyp_desc =
                            Ptyp_constr ({txt = Ldot (Lident "K", "t")}, [])}};
                        {pld_name = {txt = "v"}; pld_mutable = Immutable;
                         pld_type =
                          {ptyp_desc =
                            Ptyp_constr ({txt = Ldot (Lident "OM", "atom")},
                             [])}};
                        {pld_name = {txt = "r"}; pld_mutable = Immutable;
                         pld_type =
                          {ptyp_desc =
                            Ptyp_constr ({txt = Ldot (Lident "K", "t")}, [])}};
                        {pld_name = {txt = "h"}; pld_mutable = Immutable;
                         pld_type =
                          {ptyp_desc =
                            Ptyp_constr ({txt = Lident "int64"}, [])}}];
                     ptype_private = Public; ptype_manifest = None}])};
                {pstr_desc =
                  Pstr_type (Recursive,
                   [{ptype_name = {txt = "vt"}; ptype_params = [];
                     ptype_cstrs = [];
                     ptype_kind =
                      Ptype_variant
                       [{pcd_name = {txt = "Empty"};
                         pcd_args = Pcstr_tuple []; pcd_res = None};
                        {pcd_name = {txt = "Node"};
                         pcd_args =
                          Pcstr_tuple
                           [{ptyp_desc =
                              Ptyp_constr ({txt = Lident "vnode"}, [])}];
                         pcd_res = None}];
                     ptype_private = Public; ptype_manifest = None}])};
                {pstr_desc =
                  Pstr_module
                   {pmb_name = {txt = "M"};
                    pmb_expr =
                     {pmod_desc =
                       Pmod_structure
                        [{pstr_desc =
                           Pstr_module
                            {pmb_name = {txt = "AO_value"};
                             pmb_expr =
                              {pmod_desc =
                                Pmod_structure
                                 [{pstr_desc =
                                    Pstr_type (Recursive,
                                     [{ptype_name = {txt = "t"};
                                       ptype_params = []; ptype_cstrs = [];
                                       ptype_kind = Ptype_abstract;
                                       ptype_private = Public;
                                       ptype_manifest =
                                        Some
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "vt"},
                                            [])}}])};
                                  {pstr_desc =
                                    Pstr_value (Nonrecursive,
                                     [{pvb_pat =
                                        {ppat_desc = Ppat_var {txt = "node"}};
                                       pvb_expr =
                                        {pexp_desc =
                                          Pexp_open (Fresh,
                                           {txt =
                                             Ldot (Lident "Irmin", "Type")},
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "|>"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "|+"}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_apply
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "|+"}},
                                                        [(Nolabel,
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "|+"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_apply
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "|+"}},
                                                                  [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "record"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("node",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "l"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "r"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "h"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "l"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "l"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "v"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "r"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "r"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "h"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "h"}})],
                                                                    None)})})})})})])});
                                                                   (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "field"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("l",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "K", "t")}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                    {txt =
                                                                    Lident
                                                                    "l"})})})])})])});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_apply
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "field"}},
                                                                  [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("v",
                                                                    None))});
                                                                   (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Atom",
                                                                    "t")}});
                                                                   (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                    {txt =
                                                                    Lident
                                                                    "v"})})})])})])});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "field"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_constant
                                                                  (Pconst_string
                                                                    ("r",
                                                                    None))});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "K", "t")}});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_fun
                                                                  (Nolabel,
                                                                  None,
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t"}},
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                    {txt =
                                                                    Lident
                                                                    "r"})})})])})])});
                                                    (Nolabel,
                                                     {pexp_desc =
                                                       Pexp_apply
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "field"}},
                                                        [(Nolabel,
                                                          {pexp_desc =
                                                            Pexp_constant
                                                             (Pconst_string
                                                               ("h", None))});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "int64"}});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_fun
                                                             (Nolabel, None,
                                                             {ppat_desc =
                                                               Ppat_var
                                                                {txt = "t"}},
                                                             {pexp_desc =
                                                               Pexp_field
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                {txt =
                                                                  Lident "h"})})})])})])});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "sealr"}})])})}}])};
                                  {pstr_desc =
                                    Pstr_value (Nonrecursive,
                                     [{pvb_pat =
                                        {ppat_desc = Ppat_var {txt = "t"}};
                                       pvb_expr =
                                        {pexp_desc =
                                          Pexp_open (Fresh,
                                           {txt =
                                             Ldot (Lident "Irmin", "Type")},
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "|>"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "|~"}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_apply
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "|~"}},
                                                        [(Nolabel,
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "variant"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_constant
                                                                  (Pconst_string
                                                                    ("t",
                                                                    None))});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_fun
                                                                  (Nolabel,
                                                                  None,
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "empty"}},
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "node"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_function
                                                                    [{pc_lhs
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Empty"},
                                                                    None)};
                                                                    pc_guard
                                                                    = None;
                                                                    pc_rhs =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "empty"}}};
                                                                    {pc_lhs =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Node"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "n"}})};
                                                                    pc_guard
                                                                    = None;
                                                                    pc_rhs =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "node"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "n"}})])}}]})})})])});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "case0"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_constant
                                                                  (Pconst_string
                                                                    ("Empty",
                                                                    None))});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_construct
                                                                  ({txt =
                                                                    Lident
                                                                    "Empty"},
                                                                  None)})])})])});
                                                    (Nolabel,
                                                     {pexp_desc =
                                                       Pexp_apply
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "case1"}},
                                                        [(Nolabel,
                                                          {pexp_desc =
                                                            Pexp_constant
                                                             (Pconst_string
                                                               ("Node", None))});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "node"}});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_fun
                                                             (Nolabel, None,
                                                             {ppat_desc =
                                                               Ppat_var
                                                                {txt = "x"}},
                                                             {pexp_desc =
                                                               Pexp_construct
                                                                ({txt =
                                                                   Lident
                                                                    "Node"},
                                                                Some
                                                                 {pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}})})})])})])});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "sealv"}})])})}}])};
                                  {pstr_desc =
                                    Pstr_value (Nonrecursive,
                                     [{pvb_pat =
                                        {ppat_desc = Ppat_var {txt = "pp"}};
                                       pvb_expr =
                                        {pexp_desc =
                                          Pexp_apply
                                           ({pexp_desc =
                                              Pexp_ident
                                               {txt =
                                                 Ldot
                                                  (Ldot (Lident "Irmin",
                                                    "Type"),
                                                  "dump")}},
                                           [(Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "t"}})])}}])};
                                  {pstr_desc =
                                    Pstr_value (Nonrecursive,
                                     [{pvb_pat =
                                        {ppat_desc =
                                          Ppat_var {txt = "of_string"}};
                                       pvb_expr =
                                        {pexp_desc =
                                          Pexp_fun (Nolabel, None,
                                           {ppat_desc =
                                             Ppat_constraint
                                              ({ppat_desc =
                                                 Ppat_var {txt = "s"}},
                                              {ptyp_desc =
                                                Ptyp_constr
                                                 ({txt = Lident "string"},
                                                 [])})},
                                           {pexp_desc =
                                             Pexp_let (Nonrecursive,
                                              [{pvb_pat =
                                                 {ppat_desc =
                                                   Ppat_var
                                                    {txt = "from_just_ok"}};
                                                pvb_expr =
                                                 {pexp_desc =
                                                   Pexp_function
                                                    [{pc_lhs =
                                                       {ppat_desc =
                                                         Ppat_construct
                                                          ({txt = Lident "Ok"},
                                                          Some
                                                           {ppat_desc =
                                                             Ppat_var
                                                              {txt = "x"}})};
                                                      pc_guard = None;
                                                      pc_rhs =
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident "x"}}};
                                                     {pc_lhs =
                                                       {ppat_desc = Ppat_any};
                                                      pc_guard = None;
                                                      pc_rhs =
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident
                                                                 "failwith"}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_constant
                                                               (Pconst_string
                                                                 ("Expected Ok. Got error.",
                                                                 None))})])}}]}}],
                                              {pexp_desc =
                                                Pexp_let (Nonrecursive,
                                                 [{pvb_pat =
                                                    {ppat_desc =
                                                      Ppat_var
                                                       {txt = "remove_blanks"}};
                                                   pvb_expr =
                                                    {pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Ldot
                                                              (Lident "Str",
                                                              "global_replace")}},
                                                       [(Nolabel,
                                                         {pexp_desc =
                                                           Pexp_apply
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Ldot
                                                                   (Lident
                                                                    "Str",
                                                                   "regexp")}},
                                                            [(Nolabel,
                                                              {pexp_desc =
                                                                Pexp_constant
                                                                 (Pconst_string
                                                                   ("[\n\r\t ]",
                                                                   None))})])});
                                                        (Nolabel,
                                                         {pexp_desc =
                                                           Pexp_constant
                                                            (Pconst_string
                                                              ("", None))})])}}],
                                                 {pexp_desc =
                                                   Pexp_let (Nonrecursive,
                                                    [{pvb_pat =
                                                       {ppat_desc =
                                                         Ppat_var {txt = "s"}};
                                                      pvb_expr =
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident
                                                                 "remove_blanks"}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "s"}})])}}],
                                                    {pexp_desc =
                                                      Pexp_match
                                                       ({pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Ldot
                                                                  (Lident
                                                                    "Str",
                                                                  "split")}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_apply
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Str",
                                                                    "regexp")}},
                                                                [(Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("[{}]",
                                                                    None))})])});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "s"}})])},
                                                       [{pc_lhs =
                                                          {ppat_desc =
                                                            Ppat_construct
                                                             ({txt =
                                                                Lident "::"},
                                                             Some
                                                              {ppat_desc =
                                                                Ppat_tuple
                                                                 [{ppat_desc
                                                                    =
                                                                    Ppat_constant
                                                                    (Pconst_string
                                                                    ("Empty",
                                                                    None))};
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "[]"},
                                                                    None)}]})};
                                                         pc_guard = None;
                                                         pc_rhs =
                                                          {pexp_desc =
                                                            Pexp_construct
                                                             ({txt =
                                                                Lident "Ok"},
                                                             Some
                                                              {pexp_desc =
                                                                Pexp_construct
                                                                 ({txt =
                                                                    Lident
                                                                    "Empty"},
                                                                 None)})}};
                                                        {pc_lhs =
                                                          {ppat_desc =
                                                            Ppat_construct
                                                             ({txt =
                                                                Lident "::"},
                                                             Some
                                                              {ppat_desc =
                                                                Ppat_tuple
                                                                 [{ppat_desc
                                                                    =
                                                                    Ppat_constant
                                                                    (Pconst_string
                                                                    ("Node",
                                                                    None))};
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "::"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "node"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "[]"},
                                                                    None)}]})}]})};
                                                         pc_guard = None;
                                                         pc_rhs =
                                                          {pexp_desc =
                                                            Pexp_let
                                                             (Nonrecursive,
                                                             [{pvb_pat =
                                                                {ppat_desc =
                                                                  Ppat_var
                                                                   {txt =
                                                                    "rx"}};
                                                               pvb_expr =
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Str",
                                                                    "regexp")}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("l=\\(.+\\);v=\\(.+\\);r=\\(.+\\);h=\\(.+\\);",
                                                                    None))})])}}],
                                                             {pexp_desc =
                                                               Pexp_let
                                                                (Nonrecursive,
                                                                [{pvb_pat =
                                                                   {ppat_desc
                                                                    =
                                                                    Ppat_any};
                                                                  pvb_expr =
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Str",
                                                                    "search_forward")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "rx"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "node"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("0",
                                                                    None))})])}}],
                                                                {pexp_desc =
                                                                  Pexp_let
                                                                   (Nonrecursive,
                                                                   [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "l"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "@@"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "from_just_ok"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "@@"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "K",
                                                                    "of_string")}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Str",
                                                                    "matched_group")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "node"}})])})])})])}}],
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "@@"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Atom",
                                                                    "of_string")}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Str",
                                                                    "matched_group")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("2",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "node"}})])})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "r"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "@@"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "from_just_ok"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "@@"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "K",
                                                                    "of_string")}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Str",
                                                                    "matched_group")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("3",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "node"}})])})])})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "h"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "@@"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Int64",
                                                                    "of_string")}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Str",
                                                                    "matched_group")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("4",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "node"}})])})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Ok"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Node"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "l"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "l"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "v"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "r"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "r"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "h"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "h"}})],
                                                                    None)})})})})})})})})}};
                                                        {pc_lhs =
                                                          {ppat_desc =
                                                            Ppat_any};
                                                         pc_guard = None;
                                                         pc_rhs =
                                                          {pexp_desc =
                                                            Pexp_construct
                                                             ({txt =
                                                                Lident
                                                                 "Error"},
                                                             Some
                                                              {pexp_desc =
                                                                Pexp_variant
                                                                 ("Msg",
                                                                 Some
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "^"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("invalid entry: ",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "s"}})])})})}}])})})})})}}])}]}}};
                         {pstr_desc =
                           Pstr_module
                            {pmb_name = {txt = "AO_store"};
                             pmb_expr =
                              {pmod_desc =
                                Pmod_structure
                                 [{pstr_desc =
                                    Pstr_module
                                     {pmb_name = {txt = "S"};
                                      pmb_expr =
                                       {pmod_desc =
                                         Pmod_apply
                                          ({pmod_desc =
                                             Pmod_apply
                                              ({pmod_desc =
                                                 Pmod_ident
                                                  {txt =
                                                    Ldot (Lident "Irmin_git",
                                                     "AO")}},
                                              {pmod_desc =
                                                Pmod_ident
                                                 {txt =
                                                   Ldot (Lident "Git_unix",
                                                    "FS")}})},
                                          {pmod_desc =
                                            Pmod_ident
                                             {txt = Lident "AO_value"}})}}};
                                  {pstr_desc =
                                    Pstr_include
                                     {pincl_mod =
                                       {pmod_desc =
                                         Pmod_ident {txt = Lident "S"}}}};
                                  {pstr_desc =
                                    Pstr_value (Nonrecursive,
                                     [{pvb_pat =
                                        {ppat_desc =
                                          Ppat_var {txt = "create"}};
                                       pvb_expr =
                                        {pexp_desc =
                                          Pexp_fun (Nolabel, None,
                                           {ppat_desc =
                                             Ppat_var {txt = "config"}},
                                           {pexp_desc =
                                             Pexp_let (Nonrecursive,
                                              [{pvb_pat =
                                                 {ppat_desc =
                                                   Ppat_var {txt = "level"}};
                                                pvb_expr =
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Ldot
                                                           (Ldot
                                                             (Ldot
                                                               (Lident
                                                                 "Irmin",
                                                               "Private"),
                                                             "Conf"),
                                                           "key")}},
                                                    [(Labelled "doc",
                                                      {pexp_desc =
                                                        Pexp_constant
                                                         (Pconst_string
                                                           ("The Zlib compression level.",
                                                           None))});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_constant
                                                         (Pconst_string
                                                           ("level", None))});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_open (Fresh,
                                                         {txt =
                                                           Ldot
                                                            (Ldot
                                                              (Lident "Irmin",
                                                              "Private"),
                                                            "Conf")},
                                                         {pexp_desc =
                                                           Pexp_apply
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "some"}},
                                                            [(Nolabel,
                                                              {pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "int"}})])})});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_construct
                                                         ({txt =
                                                            Lident "None"},
                                                         None)})])}}],
                                              {pexp_desc =
                                                Pexp_let (Nonrecursive,
                                                 [{pvb_pat =
                                                    {ppat_desc =
                                                      Ppat_var {txt = "root"}};
                                                   pvb_expr =
                                                    {pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Ldot
                                                              (Ldot
                                                                (Ldot
                                                                  (Lident
                                                                    "Irmin",
                                                                  "Private"),
                                                                "Conf"),
                                                              "get")}},
                                                       [(Nolabel,
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "config"}});
                                                        (Nolabel,
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Ldot
                                                               (Ldot
                                                                 (Ldot
                                                                   (Lident
                                                                    "Irmin",
                                                                   "Private"),
                                                                 "Conf"),
                                                               "root")}})])}}],
                                                 {pexp_desc =
                                                   Pexp_let (Nonrecursive,
                                                    [{pvb_pat =
                                                       {ppat_desc =
                                                         Ppat_var
                                                          {txt = "level"}};
                                                      pvb_expr =
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Ldot
                                                                 (Ldot
                                                                   (Ldot
                                                                    (Lident
                                                                    "Irmin",
                                                                    "Private"),
                                                                   "Conf"),
                                                                 "get")}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "config"}});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "level"}})])}}],
                                                    {pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Ldot
                                                              (Ldot
                                                                (Lident
                                                                  "Git_unix",
                                                                "FS"),
                                                              "create")}},
                                                       [(Optional "root",
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "root"}});
                                                        (Optional "level",
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "level"}});
                                                        (Nolabel,
                                                         {pexp_desc =
                                                           Pexp_construct
                                                            ({txt =
                                                               Lident "()"},
                                                            None)})])})})})})}}])};
                                  {pstr_desc =
                                    Pstr_value (Nonrecursive,
                                     [{pvb_pat =
                                        {ppat_desc =
                                          Ppat_var {txt = "create"}};
                                       pvb_expr =
                                        {pexp_desc =
                                          Pexp_fun (Nolabel, None,
                                           {ppat_desc =
                                             Ppat_construct
                                              ({txt = Lident "()"}, None)},
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "@@"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "create"}});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt =
                                                         Ldot
                                                          (Lident "Irmin_git",
                                                          "config")}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Ldot
                                                           (Lident "Config",
                                                           "shared")}})])})])})}}])}]}}};
                         {pstr_desc =
                           Pstr_type (Recursive,
                            [{ptype_name = {txt = "t"}; ptype_params = [];
                              ptype_cstrs = []; ptype_kind = Ptype_abstract;
                              ptype_private = Public;
                              ptype_manifest =
                               Some
                                {ptyp_desc =
                                  Ptyp_constr
                                   ({txt = Ldot (Lident "K", "t")}, [])}}])};
                         {pstr_desc =
                           Pstr_value (Recursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "of_adt"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc =
                                    Ppat_constraint
                                     ({ppat_desc = Ppat_var {txt = "a"}},
                                     {ptyp_desc =
                                       Ptyp_constr
                                        ({txt = Ldot (Lident "OM", "t")}, 
                                        [])})},
                                  {pexp_desc =
                                    Pexp_constraint
                                     ({pexp_desc =
                                        Pexp_let (Nonrecursive,
                                         [{pvb_pat =
                                            {ppat_desc =
                                              Ppat_var {txt = "aostore"}};
                                           pvb_expr =
                                            {pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt =
                                                     Ldot (Lident "AO_store",
                                                      "create")}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_construct
                                                    ({txt = Lident "()"},
                                                    None)})])}}],
                                         {pexp_desc =
                                           Pexp_let (Nonrecursive,
                                            [{pvb_pat =
                                               {ppat_desc =
                                                 Ppat_var
                                                  {txt = "aostore_add"}};
                                              pvb_expr =
                                               {pexp_desc =
                                                 Pexp_fun (Nolabel, None,
                                                  {ppat_desc =
                                                    Ppat_var {txt = "value"}},
                                                  {pexp_desc =
                                                    Pexp_apply
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident ">>="}},
                                                     [(Nolabel,
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "aostore"}});
                                                      (Nolabel,
                                                       {pexp_desc =
                                                         Pexp_fun (Nolabel,
                                                          None,
                                                          {ppat_desc =
                                                            Ppat_var
                                                             {txt =
                                                               "ao_store"}},
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Ldot
                                                                    (
                                                                    Lident
                                                                    "AO_store",
                                                                    "add")}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "ao_store"}});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "value"}})])})})])})}}],
                                            {pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "=<<"}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt =
                                                      Lident "aostore_add"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_match
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "a"}},
                                                    [{pc_lhs =
                                                       {ppat_desc =
                                                         Ppat_construct
                                                          ({txt =
                                                             Ldot
                                                              (Lident "OM",
                                                              "Empty")},
                                                          None)};
                                                      pc_guard = None;
                                                      pc_rhs =
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "@@"}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Ldot
                                                                  (Lident
                                                                    "Lwt",
                                                                  "return")}});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_construct
                                                               ({txt =
                                                                  Lident
                                                                   "Empty"},
                                                               None)})])}};
                                                     {pc_lhs =
                                                       {ppat_desc =
                                                         Ppat_construct
                                                          ({txt =
                                                             Ldot
                                                              (Lident "OM",
                                                              "Node")},
                                                          Some
                                                           {ppat_desc =
                                                             Ppat_record
                                                              ([({txt =
                                                                   Lident "l"},
                                                                 {ppat_desc =
                                                                   Ppat_var
                                                                    {txt =
                                                                    "l"}});
                                                                ({txt =
                                                                   Lident "v"},
                                                                 {ppat_desc =
                                                                   Ppat_var
                                                                    {txt =
                                                                    "v"}});
                                                                ({txt =
                                                                   Lident "r"},
                                                                 {ppat_desc =
                                                                   Ppat_var
                                                                    {txt =
                                                                    "r"}});
                                                                ({txt =
                                                                   Lident "h"},
                                                                 {ppat_desc =
                                                                   Ppat_var
                                                                    {txt =
                                                                    "h"}})],
                                                              Closed)})};
                                                      pc_guard = None;
                                                      pc_rhs =
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident ">>="}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_apply
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    ">>="}},
                                                               [(Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "of_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "l"}})])});
                                                                (Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "l'"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "of_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "r"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "r'"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "l"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "l'"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "v"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "r"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "r'"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "h"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Int64",
                                                                    "of_int")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "h"}})])})],
                                                                    None)})])})})])})})])});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_fun
                                                               (Nolabel,
                                                               None,
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt = "n"}},
                                                               {pexp_desc =
                                                                 Pexp_apply
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "@@"}},
                                                                  [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}});
                                                                   (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Node"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "n"}})})])})})])}}])})])})})},
                                     {ptyp_desc =
                                       Ptyp_constr
                                        ({txt = Ldot (Lident "Lwt", "t")},
                                        [{ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [])}])})})}}])};
                         {pstr_desc =
                           Pstr_value (Recursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "to_adt"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc =
                                    Ppat_constraint
                                     ({ppat_desc = Ppat_var {txt = "k"}},
                                     {ptyp_desc =
                                       Ptyp_constr ({txt = Lident "t"}, [])})},
                                  {pexp_desc =
                                    Pexp_constraint
                                     ({pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident {txt = Lident ">>="}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt =
                                                    Ldot (Lident "AO_store",
                                                     "create")}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_construct
                                                   ({txt = Lident "()"},
                                                   None)})])});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_fun (Nolabel, None,
                                              {ppat_desc =
                                                Ppat_var {txt = "ao_store"}},
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident ">>="}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Ldot
                                                             (Lident
                                                               "AO_store",
                                                             "find")}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident
                                                              "ao_store"}});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "k"}})])});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_fun (Nolabel, None,
                                                      {ppat_desc =
                                                        Ppat_var {txt = "t"}},
                                                      {pexp_desc =
                                                        Pexp_let
                                                         (Nonrecursive,
                                                         [{pvb_pat =
                                                            {ppat_desc =
                                                              Ppat_var
                                                               {txt = "t"}};
                                                           pvb_expr =
                                                            {pexp_desc =
                                                              Pexp_apply
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "from_just"}},
                                                               [(Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}})])}}],
                                                         {pexp_desc =
                                                           Pexp_match
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "t"}},
                                                            [{pc_lhs =
                                                               {ppat_desc =
                                                                 Ppat_construct
                                                                  ({txt =
                                                                    Lident
                                                                    "Empty"},
                                                                  None)};
                                                              pc_guard = None;
                                                              pc_rhs =
                                                               {pexp_desc =
                                                                 Pexp_apply
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "@@"}},
                                                                  [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}});
                                                                   (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "OM",
                                                                    "Empty")},
                                                                    None)})])}};
                                                             {pc_lhs =
                                                               {ppat_desc =
                                                                 Ppat_construct
                                                                  ({txt =
                                                                    Lident
                                                                    "Node"},
                                                                  Some
                                                                   {ppat_desc
                                                                    =
                                                                    Ppat_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "l"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "l"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "v"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "r"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "r"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "h"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "h"}})],
                                                                    Closed)})};
                                                              pc_guard = None;
                                                              pc_rhs =
                                                               {pexp_desc =
                                                                 Pexp_apply
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                  [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "to_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "l"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "l'"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "to_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "r"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "r'"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "OM",
                                                                    "l")},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "l'"}});
                                                                    ({txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "OM",
                                                                    "v")},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}});
                                                                    ({txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "OM",
                                                                    "r")},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "r'"}});
                                                                    ({txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "OM",
                                                                    "h")},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Int64",
                                                                    "to_int")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "h"}})])})],
                                                                    None)})])})})])})})])});
                                                                   (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "n"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "@@"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "OM",
                                                                    "Node")},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "n"}})})])})})])}}])})})})])})})])},
                                     {ptyp_desc =
                                       Ptyp_constr
                                        ({txt = Ldot (Lident "Lwt", "t")},
                                        [{ptyp_desc =
                                           Ptyp_constr
                                            ({txt = Ldot (Lident "OM", "t")},
                                            [])}])})})}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat = {ppat_desc = Ppat_var {txt = "t"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_ident {txt = Ldot (Lident "K", "t")}}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat = {ppat_desc = Ppat_var {txt = "pp"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_ident {txt = Ldot (Lident "K", "pp")}}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "of_string"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_ident
                                  {txt = Ldot (Lident "K", "of_string")}}}])};
                         {pstr_desc =
                           Pstr_value (Recursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "merge"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Labelled "old", None,
                                  {ppat_desc =
                                    Ppat_constraint
                                     ({ppat_desc = Ppat_var {txt = "old"}},
                                     {ptyp_desc =
                                       Ptyp_constr
                                        ({txt =
                                           Ldot
                                            (Ldot (Lident "Irmin", "Merge"),
                                            "promise")},
                                        [{ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [])}])})},
                                  {pexp_desc =
                                    Pexp_fun (Nolabel, None,
                                     {ppat_desc = Ppat_var {txt = "v1_k"}},
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc = Ppat_var {txt = "v2_k"}},
                                        {pexp_desc =
                                          Pexp_open (Fresh,
                                           {txt =
                                             Ldot
                                              (Ldot (Lident "Irmin", "Merge"),
                                              "Infix")},
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident ">>=*"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "old"}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_construct
                                                        ({txt = Lident "()"},
                                                        None)})])});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_fun (Nolabel, None,
                                                   {ppat_desc =
                                                     Ppat_var {txt = "old_k"}},
                                                   {pexp_desc =
                                                     Pexp_let (Nonrecursive,
                                                      [{pvb_pat =
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "old_k"}};
                                                        pvb_expr =
                                                         {pexp_desc =
                                                           Pexp_apply
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "from_just"}},
                                                            [(Nolabel,
                                                              {pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "old_k"}})])}}],
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident ">>="}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "to_adt"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "old_k"}})])});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_fun
                                                              (Nolabel, None,
                                                              {ppat_desc =
                                                                Ppat_var
                                                                 {txt =
                                                                   "oldv"}},
                                                              {pexp_desc =
                                                                Pexp_apply
                                                                 ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                 [(Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "to_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v1_k"}})])});
                                                                  (Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v1"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "to_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v2_k"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v2"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "OM",
                                                                    "merge3")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "oldv"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v1"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v2"}})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "of_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "merged_k"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Ldot
                                                                    (Lident
                                                                    "Irmin",
                                                                    "Merge"),
                                                                    "ok")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "merged_k"}})])})})])})})})])})})])})})])})})})])})})})})}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "merge"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_open (Fresh,
                                  {txt = Ldot (Lident "Irmin", "Merge")},
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "option"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_apply
                                          ({pexp_desc =
                                             Pexp_ident {txt = Lident "v"}},
                                          [(Nolabel,
                                            {pexp_desc =
                                              Pexp_ident {txt = Lident "t"}});
                                           (Nolabel,
                                            {pexp_desc =
                                              Pexp_ident
                                               {txt = Lident "merge"}})])})])})}}])}]}}};
                {pstr_desc =
                  Pstr_module
                   {pmb_name = {txt = "BC_store"};
                    pmb_expr =
                     {pmod_desc =
                       Pmod_structure
                        [{pstr_desc =
                           Pstr_module
                            {pmb_name = {txt = "Store"};
                             pmb_expr =
                              {pmod_desc =
                                Pmod_apply
                                 ({pmod_desc =
                                    Pmod_ident
                                     {txt =
                                       Ldot
                                        (Ldot
                                          (Ldot (Lident "Irmin_unix", "Git"),
                                          "FS"),
                                        "KV")}},
                                 {pmod_desc = Pmod_ident {txt = Lident "M"}})}}};
                         {pstr_desc =
                           Pstr_module
                            {pmb_name = {txt = "Sync"};
                             pmb_expr =
                              {pmod_desc =
                                Pmod_apply
                                 ({pmod_desc =
                                    Pmod_ident
                                     {txt = Ldot (Lident "Irmin", "Sync")}},
                                 {pmod_desc =
                                   Pmod_ident {txt = Lident "Store"}})}}};
                         {pstr_desc =
                           Pstr_type (Recursive,
                            [{ptype_name = {txt = "t"}; ptype_params = [];
                              ptype_cstrs = []; ptype_kind = Ptype_abstract;
                              ptype_private = Public;
                              ptype_manifest =
                               Some
                                {ptyp_desc =
                                  Ptyp_constr
                                   ({txt = Ldot (Lident "Store", "t")}, 
                                   [])}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat = {ppat_desc = Ppat_var {txt = "init"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Optional "root", None,
                                  {ppat_desc = Ppat_var {txt = "root"}},
                                  {pexp_desc =
                                    Pexp_fun (Optional "bare", None,
                                     {ppat_desc = Ppat_var {txt = "bare"}},
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc =
                                          Ppat_construct
                                           ({txt = Lident "()"}, None)},
                                        {pexp_desc =
                                          Pexp_let (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "config"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt =
                                                       Ldot
                                                        (Lident "Irmin_git",
                                                        "config")}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt =
                                                        Ldot
                                                         (Lident "Config",
                                                         "root")}})])}}],
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt =
                                                    Ldot
                                                     (Ldot (Lident "Store",
                                                       "Repo"),
                                                     "v")}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "config"}})])})})})})}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "master"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc =
                                    Ppat_constraint
                                     ({ppat_desc = Ppat_var {txt = "repo"}},
                                     {ptyp_desc =
                                       Ptyp_constr
                                        ({txt = Ldot (Lident "Store", "repo")},
                                        [])})},
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident
                                         {txt =
                                           Ldot (Lident "Store", "master")}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_ident {txt = Lident "repo"}})])})}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "clone"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc = Ppat_var {txt = "t"}},
                                  {pexp_desc =
                                    Pexp_fun (Nolabel, None,
                                     {ppat_desc = Ppat_var {txt = "name"}},
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident
                                            {txt =
                                              Ldot (Lident "Store", "clone")}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "t"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "name"}})])})})}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "get_branch"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc = Ppat_var {txt = "r"}},
                                  {pexp_desc =
                                    Pexp_fun (Labelled "branch_name", None,
                                     {ppat_desc =
                                       Ppat_var {txt = "branch_name"}},
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident
                                            {txt =
                                              Ldot (Lident "Store",
                                               "of_branch")}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "r"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident
                                             {txt = Lident "branch_name"}})])})})}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "merge"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc = Ppat_var {txt = "s"}},
                                  {pexp_desc =
                                    Pexp_fun (Labelled "into", None,
                                     {ppat_desc = Ppat_var {txt = "into"}},
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident
                                            {txt =
                                              Ldot (Lident "Store", "merge")}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "s"}});
                                         (Labelled "into",
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "into"}})])})})}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat =
                               {ppat_desc = Ppat_var {txt = "update"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc = Ppat_var {txt = "t"}},
                                  {pexp_desc =
                                    Pexp_fun (Nolabel, None,
                                     {ppat_desc = Ppat_var {txt = "k"}},
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc = Ppat_var {txt = "v"}},
                                        {pexp_desc =
                                          Pexp_apply
                                           ({pexp_desc =
                                              Pexp_ident
                                               {txt =
                                                 Ldot (Lident "Store", "set")}},
                                           [(Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "t"}});
                                            (Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "k"}});
                                            (Nolabel,
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "v"}})])})})})}}])};
                         {pstr_desc =
                           Pstr_value (Nonrecursive,
                            [{pvb_pat = {ppat_desc = Ppat_var {txt = "read"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_fun (Nolabel, None,
                                  {ppat_desc = Ppat_var {txt = "t"}},
                                  {pexp_desc =
                                    Pexp_fun (Nolabel, None,
                                     {ppat_desc = Ppat_var {txt = "k"}},
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident
                                            {txt =
                                              Ldot (Lident "Store", "find")}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "t"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "k"}})])})})}}])}]}}};
                {pstr_desc =
                  Pstr_module
                   {pmb_name = {txt = "Vpst"};
                    pmb_expr =
                     {pmod_desc =
                       Pmod_constraint
                        ({pmod_desc =
                           Pmod_structure
                            [{pstr_desc =
                               Pstr_type (Recursive,
                                [{ptype_name = {txt = "store"};
                                  ptype_params = []; ptype_cstrs = [];
                                  ptype_kind = Ptype_abstract;
                                  ptype_private = Public;
                                  ptype_manifest =
                                   Some
                                    {ptyp_desc =
                                      Ptyp_constr
                                       ({txt = Ldot (Lident "BC_store", "t")},
                                       [])}}])};
                             {pstr_desc =
                               Pstr_type (Recursive,
                                [{ptype_name = {txt = "st"};
                                  ptype_params = []; ptype_cstrs = [];
                                  ptype_kind =
                                   Ptype_record
                                    [{pld_name = {txt = "master"};
                                      pld_mutable = Immutable;
                                      pld_type =
                                       {ptyp_desc =
                                         Ptyp_constr ({txt = Lident "store"},
                                          [])}};
                                     {pld_name = {txt = "local"};
                                      pld_mutable = Immutable;
                                      pld_type =
                                       {ptyp_desc =
                                         Ptyp_constr ({txt = Lident "store"},
                                          [])}};
                                     {pld_name = {txt = "name"};
                                      pld_mutable = Immutable;
                                      pld_type =
                                       {ptyp_desc =
                                         Ptyp_constr
                                          ({txt = Lident "string"}, [])}};
                                     {pld_name = {txt = "next_id"};
                                      pld_mutable = Immutable;
                                      pld_type =
                                       {ptyp_desc =
                                         Ptyp_constr ({txt = Lident "int"},
                                          [])}}];
                                  ptype_private = Public;
                                  ptype_manifest = None}])};
                             {pstr_desc =
                               Pstr_type (Recursive,
                                [{ptype_name = {txt = "t"};
                                  ptype_params =
                                   [({ptyp_desc = Ptyp_var "a"}, Invariant)];
                                  ptype_cstrs = [];
                                  ptype_kind = Ptype_abstract;
                                  ptype_private = Public;
                                  ptype_manifest =
                                   Some
                                    {ptyp_desc =
                                      Ptyp_arrow (Nolabel,
                                       {ptyp_desc =
                                         Ptyp_constr ({txt = Lident "st"},
                                          [])},
                                       {ptyp_desc =
                                         Ptyp_constr
                                          ({txt = Ldot (Lident "Lwt", "t")},
                                          [{ptyp_desc =
                                             Ptyp_tuple
                                              [{ptyp_desc = Ptyp_var "a"};
                                               {ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt = Lident "st"}, 
                                                  [])}]}])})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc = Ppat_var {txt = "info"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc = Ppat_var {txt = "s"}},
                                      {pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident
                                             {txt =
                                               Ldot (Lident "Irmin_unix",
                                                "info")}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_constant
                                              (Pconst_string ("[repo %s] %s",
                                                None))});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_ident
                                              {txt =
                                                Ldot (Lident "Config",
                                                 "root")}});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_ident {txt = Lident "s"}})])})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc = Ppat_var {txt = "path"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_construct ({txt = Lident "::"},
                                      Some
                                       {pexp_desc =
                                         Pexp_tuple
                                          [{pexp_desc =
                                             Pexp_constant
                                              (Pconst_string ("state", None))};
                                           {pexp_desc =
                                             Pexp_construct
                                              ({txt = Lident "[]"}, None)}]})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc = Ppat_var {txt = "return"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc =
                                        Ppat_constraint
                                         ({ppat_desc = Ppat_var {txt = "x"}},
                                         {ptyp_desc = Ptyp_var "a"})},
                                      {pexp_desc =
                                        Pexp_constraint
                                         ({pexp_desc =
                                            Pexp_fun (Nolabel, None,
                                             {ppat_desc =
                                               Ppat_var {txt = "st"}},
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt =
                                                      Ldot (Lident "Lwt",
                                                       "return")}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_tuple
                                                     [{pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "x"}};
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "st"}}]})])})},
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [{ptyp_desc = Ptyp_var "a"}])})})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc = Ppat_var {txt = "bind"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc =
                                        Ppat_constraint
                                         ({ppat_desc = Ppat_var {txt = "m1"}},
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [{ptyp_desc = Ptyp_var "a"}])})},
                                      {pexp_desc =
                                        Pexp_fun (Nolabel, None,
                                         {ppat_desc =
                                           Ppat_constraint
                                            ({ppat_desc =
                                               Ppat_var {txt = "f"}},
                                            {ptyp_desc =
                                              Ptyp_arrow (Nolabel,
                                               {ptyp_desc = Ptyp_var "a"},
                                               {ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt = Lident "t"},
                                                  [{ptyp_desc = Ptyp_var "b"}])})})},
                                         {pexp_desc =
                                           Pexp_constraint
                                            ({pexp_desc =
                                               Pexp_fun (Nolabel, None,
                                                {ppat_desc =
                                                  Ppat_var {txt = "st"}},
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident ">>="}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_apply
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "m1"}},
                                                        [(Nolabel,
                                                          {pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "st"}})])});
                                                    (Nolabel,
                                                     {pexp_desc =
                                                       Pexp_fun (Nolabel,
                                                        None,
                                                        {ppat_desc =
                                                          Ppat_tuple
                                                           [{ppat_desc =
                                                              Ppat_var
                                                               {txt = "a"}};
                                                            {ppat_desc =
                                                              Ppat_var
                                                               {txt = "st'"}}]},
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "f"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "a"}});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "st'"}})])})})])})},
                                            {ptyp_desc =
                                              Ptyp_constr
                                               ({txt = Lident "t"},
                                               [{ptyp_desc = Ptyp_var "b"}])})})})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc =
                                     Ppat_var {txt = "with_init_version_do"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc =
                                        Ppat_constraint
                                         ({ppat_desc = Ppat_var {txt = "v"}},
                                         {ptyp_desc =
                                           Ptyp_constr
                                            ({txt = Ldot (Lident "OM", "t")},
                                            [])})},
                                      {pexp_desc =
                                        Pexp_fun (Nolabel, None,
                                         {ppat_desc =
                                           Ppat_constraint
                                            ({ppat_desc =
                                               Ppat_var {txt = "m"}},
                                            {ptyp_desc =
                                              Ptyp_constr
                                               ({txt = Lident "t"},
                                               [{ptyp_desc = Ptyp_var "a"}])})},
                                         {pexp_desc =
                                           Pexp_apply
                                            ({pexp_desc =
                                               Pexp_ident
                                                {txt =
                                                  Ldot (Lident "Lwt_main",
                                                   "run")}},
                                            [(Nolabel,
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident ">>="}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Ldot
                                                             (Lident
                                                               "BC_store",
                                                             "init")}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_construct
                                                           ({txt =
                                                              Lident "()"},
                                                           None)})])});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_fun (Nolabel, None,
                                                      {ppat_desc =
                                                        Ppat_var
                                                         {txt = "repo"}},
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident ">>="}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "master")}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "repo"}})])});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_fun
                                                              (Nolabel, None,
                                                              {ppat_desc =
                                                                Ppat_var
                                                                 {txt =
                                                                   "m_br"}},
                                                              {pexp_desc =
                                                                Pexp_apply
                                                                 ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                 [(Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "M",
                                                                    "of_adt")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}})])});
                                                                  (Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "k"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "cinfo"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("creating state of master",
                                                                    None))})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "update")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "path"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "k"}});
                                                                    (Labelled
                                                                    "info",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "()"},
                                                                    None)},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "clone")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("1_local",
                                                                    None))})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t_br"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "st"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "master"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "local"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "name"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("1",
                                                                    None))});
                                                                    ({txt =
                                                                    Lident
                                                                    "next_id"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})],
                                                                    None)}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "a"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any}]},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}})])})})])})})})])})})])})})})])})})])})})])})])})})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc =
                                     Ppat_var {txt = "with_init_forked_do"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc =
                                        Ppat_constraint
                                         ({ppat_desc = Ppat_var {txt = "m"}},
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [{ptyp_desc = Ptyp_var "a"}])})},
                                      {pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident {txt = Lident ">>="}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt =
                                                    Ldot (Lident "BC_store",
                                                     "init")}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_construct
                                                   ({txt = Lident "()"},
                                                   None)})])});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_fun (Nolabel, None,
                                              {ppat_desc =
                                                Ppat_var {txt = "repo"}},
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident ">>="}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Ldot
                                                             (Lident
                                                               "BC_store",
                                                             "master")}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "repo"}})])});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_fun (Nolabel, None,
                                                      {ppat_desc =
                                                        Ppat_var
                                                         {txt = "m_br"}},
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident ">>="}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "clone")}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_constant
                                                                   (Pconst_string
                                                                    ("1_local",
                                                                    None))})])});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_fun
                                                              (Nolabel, None,
                                                              {ppat_desc =
                                                                Ppat_var
                                                                 {txt =
                                                                   "t_br"}},
                                                              {pexp_desc =
                                                                Pexp_let
                                                                 (Nonrecursive,
                                                                 [{pvb_pat =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "st"}};
                                                                   pvb_expr =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "master"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "local"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "name"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("1",
                                                                    None))});
                                                                    ({txt =
                                                                    Lident
                                                                    "next_id"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})],
                                                                    None)}}],
                                                                 {pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "a"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any}]},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}})])})})])})})})])})})])})})])})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc =
                                     Ppat_var {txt = "fork_version"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc =
                                        Ppat_constraint
                                         ({ppat_desc = Ppat_var {txt = "m"}},
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [{ptyp_desc = Ptyp_var "a"}])})},
                                      {pexp_desc =
                                        Pexp_constraint
                                         ({pexp_desc =
                                            Pexp_fun (Nolabel, None,
                                             {ppat_desc =
                                               Ppat_constraint
                                                ({ppat_desc =
                                                   Ppat_var {txt = "st"}},
                                                {ptyp_desc =
                                                  Ptyp_constr
                                                   ({txt = Lident "st"}, 
                                                   [])})},
                                             {pexp_desc =
                                               Pexp_let (Nonrecursive,
                                                [{pvb_pat =
                                                   {ppat_desc =
                                                     Ppat_var
                                                      {txt = "thread_f"}};
                                                  pvb_expr =
                                                   {pexp_desc =
                                                     Pexp_fun (Nolabel, None,
                                                      {ppat_desc =
                                                        Ppat_construct
                                                         ({txt = Lident "()"},
                                                         None)},
                                                      {pexp_desc =
                                                        Pexp_let
                                                         (Nonrecursive,
                                                         [{pvb_pat =
                                                            {ppat_desc =
                                                              Ppat_var
                                                               {txt =
                                                                 "child_name"}};
                                                           pvb_expr =
                                                            {pexp_desc =
                                                              Pexp_apply
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "^"}},
                                                               [(Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_field
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "name"})});
                                                                (Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "^"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("_",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "string_of_int"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "next_id"})})])})])})])}}],
                                                         {pexp_desc =
                                                           Pexp_let
                                                            (Nonrecursive,
                                                            [{pvb_pat =
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt =
                                                                    "parent_m_br"}};
                                                              pvb_expr =
                                                               {pexp_desc =
                                                                 Pexp_field
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                  {txt =
                                                                    Lident
                                                                    "master"})}}],
                                                            {pexp_desc =
                                                              Pexp_let
                                                               (Nonrecursive,
                                                               [{pvb_pat =
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "m_br"}};
                                                                 pvb_expr =
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "parent_m_br"}}}],
                                                               {pexp_desc =
                                                                 Pexp_apply
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                  [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "clone")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "^"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "child_name"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("_local",
                                                                    None))})])})])});
                                                                   (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t_br"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "new_st"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "master"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "local"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "name"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "child_name"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "next_id"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})],
                                                                    None)}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "new_st"}})])})})})])})})})})}}],
                                                {pexp_desc =
                                                  Pexp_sequence
                                                   ({pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Ldot
                                                              (Lident "Lwt",
                                                              "async")}},
                                                       [(Nolabel,
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident
                                                               "thread_f"}})])},
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Ldot
                                                             (Lident "Lwt",
                                                             "return")}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_tuple
                                                           [{pexp_desc =
                                                              Pexp_construct
                                                               ({txt =
                                                                  Lident "()"},
                                                               None)};
                                                            {pexp_desc =
                                                              Pexp_record
                                                               ([({txt =
                                                                    Lident
                                                                    "next_id"},
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "next_id"})});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])})],
                                                               Some
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "st"}})}]})])})})})},
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [{ptyp_desc =
                                               Ptyp_constr
                                                ({txt = Lident "unit"}, 
                                                [])}])})})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc =
                                     Ppat_var {txt = "get_latest_version"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc =
                                        Ppat_construct ({txt = Lident "()"},
                                         None)},
                                      {pexp_desc =
                                        Pexp_constraint
                                         ({pexp_desc =
                                            Pexp_fun (Nolabel, None,
                                             {ppat_desc =
                                               Ppat_constraint
                                                ({ppat_desc =
                                                   Ppat_var {txt = "st"}},
                                                {ptyp_desc =
                                                  Ptyp_constr
                                                   ({txt = Lident "st"}, 
                                                   [])})},
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident ">>="}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_apply
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Ldot
                                                            (Lident
                                                              "BC_store",
                                                            "read")}},
                                                     [(Nolabel,
                                                       {pexp_desc =
                                                         Pexp_field
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "st"}},
                                                          {txt =
                                                            Lident "local"})});
                                                      (Nolabel,
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "path"}})])});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_fun (Nolabel, None,
                                                     {ppat_desc =
                                                       Ppat_var {txt = "k"}},
                                                     {pexp_desc =
                                                       Pexp_apply
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident ">>="}},
                                                        [(Nolabel,
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "@@"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "M",
                                                                    "to_adt")}});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_apply
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "from_just"}},
                                                                  [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "k"}})])})])});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_fun
                                                             (Nolabel, None,
                                                             {ppat_desc =
                                                               Ppat_var
                                                                {txt = "td"}},
                                                             {pexp_desc =
                                                               Pexp_apply
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                [(Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "td"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}}]})])})})])})})])})},
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [{ptyp_desc =
                                               Ptyp_constr
                                                ({txt =
                                                   Ldot (Lident "OM", "t")},
                                                [])}])})})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc =
                                     Ppat_var {txt = "sync_remote_version"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc =
                                        Ppat_var {txt = "remote_uri"}},
                                      {pexp_desc =
                                        Pexp_fun (Optional "v", None,
                                         {ppat_desc = Ppat_var {txt = "v"}},
                                         {pexp_desc =
                                           Pexp_constraint
                                            ({pexp_desc =
                                               Pexp_fun (Nolabel, None,
                                                {ppat_desc =
                                                  Ppat_constraint
                                                   ({ppat_desc =
                                                      Ppat_var {txt = "st"}},
                                                   {ptyp_desc =
                                                     Ptyp_constr
                                                      ({txt = Lident "st"},
                                                      [])})},
                                                {pexp_desc =
                                                  Pexp_let (Nonrecursive,
                                                   [{pvb_pat =
                                                      {ppat_desc =
                                                        Ppat_var
                                                         {txt = "cinfo"}};
                                                     pvb_expr =
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "info"}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_constant
                                                              (Pconst_string
                                                                ("committing local state",
                                                                None))})])}}],
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident ">>="}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_match
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "v"}},
                                                           [{pc_lhs =
                                                              {ppat_desc =
                                                                Ppat_construct
                                                                 ({txt =
                                                                    Lident
                                                                    "None"},
                                                                 None)};
                                                             pc_guard = None;
                                                             pc_rhs =
                                                              {pexp_desc =
                                                                Pexp_apply
                                                                 ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                 [(Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "()"},
                                                                    None)})])}};
                                                            {pc_lhs =
                                                              {ppat_desc =
                                                                Ppat_construct
                                                                 ({txt =
                                                                    Lident
                                                                    "Some"},
                                                                 Some
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v"}})};
                                                             pc_guard = None;
                                                             pc_rhs =
                                                              {pexp_desc =
                                                                Pexp_apply
                                                                 ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                 [(Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "M",
                                                                    "of_adt")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}})])});
                                                                  (Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "k"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "update")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "path"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "k"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])})})])}}])});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_fun (Nolabel,
                                                           None,
                                                           {ppat_desc =
                                                             Ppat_construct
                                                              ({txt =
                                                                 Lident "()"},
                                                              None)},
                                                           {pexp_desc =
                                                             Pexp_let
                                                              (Nonrecursive,
                                                              [{pvb_pat =
                                                                 {ppat_desc =
                                                                   Ppat_var
                                                                    {txt =
                                                                    "cinfo"}};
                                                                pvb_expr =
                                                                 {pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Printf",
                                                                    "sprintf")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("Merging remote: %s",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "remote_uri"}})])})])}}],
                                                              {pexp_desc =
                                                                Pexp_apply
                                                                 ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                 [(Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "Sync"),
                                                                    "pull")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "master"})});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Irmin",
                                                                    "remote_uri")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "remote_uri"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_variant
                                                                    ("Merge",
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})})])});
                                                                  (Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "cinfo"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("Merging master into local",
                                                                    None))})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "merge")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "master"})});
                                                                    (Labelled
                                                                    "into",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Labelled
                                                                    "info",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "cinfo"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("Merging local into master",
                                                                    None))})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "merge")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Labelled
                                                                    "into",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "master"})});
                                                                    (Labelled
                                                                    "info",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "get_latest_version"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "()"},
                                                                    None)});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}})])})})])})})})])})})})])})})})])})})},
                                            {ptyp_desc =
                                              Ptyp_constr
                                               ({txt = Lident "t"},
                                               [{ptyp_desc =
                                                  Ptyp_constr
                                                   ({txt =
                                                      Ldot (Lident "OM", "t")},
                                                   [])}])})})})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc =
                                     Ppat_var {txt = "sync_next_version"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Optional "v", None,
                                      {ppat_desc = Ppat_var {txt = "v"}},
                                      {pexp_desc =
                                        Pexp_constraint
                                         ({pexp_desc =
                                            Pexp_fun (Nolabel, None,
                                             {ppat_desc =
                                               Ppat_constraint
                                                ({ppat_desc =
                                                   Ppat_var {txt = "st"}},
                                                {ptyp_desc =
                                                  Ptyp_constr
                                                   ({txt = Lident "st"}, 
                                                   [])})},
                                             {pexp_desc =
                                               Pexp_let (Nonrecursive,
                                                [{pvb_pat =
                                                   {ppat_desc =
                                                     Ppat_var {txt = "cinfo"}};
                                                  pvb_expr =
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "info"}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_constant
                                                           (Pconst_string
                                                             ("committing local state",
                                                             None))})])}}],
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident ">>="}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_match
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt = Lident "v"}},
                                                        [{pc_lhs =
                                                           {ppat_desc =
                                                             Ppat_construct
                                                              ({txt =
                                                                 Lident
                                                                  "None"},
                                                              None)};
                                                          pc_guard = None;
                                                          pc_rhs =
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_construct
                                                                   ({txt =
                                                                    Lident
                                                                    "()"},
                                                                   None)})])}};
                                                         {pc_lhs =
                                                           {ppat_desc =
                                                             Ppat_construct
                                                              ({txt =
                                                                 Lident
                                                                  "Some"},
                                                              Some
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt = "v"}})};
                                                          pc_guard = None;
                                                          pc_rhs =
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    ">>="}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "M",
                                                                    "of_adt")}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}})])});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_fun
                                                                   (Nolabel,
                                                                   None,
                                                                   {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "k"}},
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "update")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "path"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "k"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])})})])}}])});
                                                    (Nolabel,
                                                     {pexp_desc =
                                                       Pexp_fun (Nolabel,
                                                        None,
                                                        {ppat_desc =
                                                          Ppat_construct
                                                           ({txt =
                                                              Lident "()"},
                                                           None)},
                                                        {pexp_desc =
                                                          Pexp_let
                                                           (Nonrecursive,
                                                           [{pvb_pat =
                                                              {ppat_desc =
                                                                Ppat_var
                                                                 {txt =
                                                                   "cinfo"}};
                                                             pvb_expr =
                                                              {pexp_desc =
                                                                Pexp_apply
                                                                 ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                 [(Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("Merging master into local",
                                                                    None))})])}}],
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    ">>="}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "merge")}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "master"})});
                                                                    (Labelled
                                                                    "into",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Labelled
                                                                    "info",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_fun
                                                                   (Nolabel,
                                                                   None,
                                                                   {ppat_desc
                                                                    =
                                                                    Ppat_any},
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "cinfo"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("Merging local into master",
                                                                    None))})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "merge")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Labelled
                                                                    "into",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "master"})});
                                                                    (Labelled
                                                                    "info",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "get_latest_version"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "()"},
                                                                    None)});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}})])})})])})})})])})})})])})})},
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [{ptyp_desc =
                                               Ptyp_constr
                                                ({txt =
                                                   Ldot (Lident "OM", "t")},
                                                [])}])})})}}])};
                             {pstr_desc =
                               Pstr_value (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc = Ppat_var {txt = "liftLwt"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc =
                                        Ppat_constraint
                                         ({ppat_desc = Ppat_var {txt = "m"}},
                                         {ptyp_desc =
                                           Ptyp_constr
                                            ({txt = Ldot (Lident "Lwt", "t")},
                                            [{ptyp_desc = Ptyp_var "a"}])})},
                                      {pexp_desc =
                                        Pexp_constraint
                                         ({pexp_desc =
                                            Pexp_fun (Nolabel, None,
                                             {ppat_desc =
                                               Ppat_var {txt = "st"}},
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident ">>="}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "m"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_fun (Nolabel, None,
                                                     {ppat_desc =
                                                       Ppat_var {txt = "a"}},
                                                     {pexp_desc =
                                                       Pexp_apply
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Ldot
                                                               (Lident "Lwt",
                                                               "return")}},
                                                        [(Nolabel,
                                                          {pexp_desc =
                                                            Pexp_tuple
                                                             [{pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident "a"}};
                                                              {pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "st"}}]})])})})])})},
                                         {ptyp_desc =
                                           Ptyp_constr ({txt = Lident "t"},
                                            [{ptyp_desc = Ptyp_var "a"}])})})}}])}]},
                        {pmty_desc =
                          Pmty_signature
                           [{psig_desc =
                              Psig_type (Recursive,
                               [{ptype_name = {txt = "t"};
                                 ptype_params =
                                  [({ptyp_desc = Ptyp_var "a"}, Invariant)];
                                 ptype_cstrs = [];
                                 ptype_kind = Ptype_abstract;
                                 ptype_private = Public;
                                 ptype_manifest = None}])};
                            {psig_desc =
                              Psig_value
                               {pval_name = {txt = "return"};
                                pval_type =
                                 {ptyp_desc =
                                   Ptyp_arrow (Nolabel,
                                    {ptyp_desc = Ptyp_var "a"},
                                    {ptyp_desc =
                                      Ptyp_constr ({txt = Lident "t"},
                                       [{ptyp_desc = Ptyp_var "a"}])})};
                                pval_prim = []}};
                            {psig_desc =
                              Psig_value
                               {pval_name = {txt = "bind"};
                                pval_type =
                                 {ptyp_desc =
                                   Ptyp_arrow (Nolabel,
                                    {ptyp_desc =
                                      Ptyp_constr ({txt = Lident "t"},
                                       [{ptyp_desc = Ptyp_var "a"}])},
                                    {ptyp_desc =
                                      Ptyp_arrow (Nolabel,
                                       {ptyp_desc =
                                         Ptyp_arrow (Nolabel,
                                          {ptyp_desc = Ptyp_var "a"},
                                          {ptyp_desc =
                                            Ptyp_constr ({txt = Lident "t"},
                                             [{ptyp_desc = Ptyp_var "b"}])})},
                                       {ptyp_desc =
                                         Ptyp_constr ({txt = Lident "t"},
                                          [{ptyp_desc = Ptyp_var "b"}])})})};
                                pval_prim = []}};
                            {psig_desc =
                              Psig_value
                               {pval_name = {txt = "with_init_version_do"};
                                pval_type =
                                 {ptyp_desc =
                                   Ptyp_arrow (Nolabel,
                                    {ptyp_desc =
                                      Ptyp_constr
                                       ({txt = Ldot (Lident "OM", "t")}, 
                                       [])},
                                    {ptyp_desc =
                                      Ptyp_arrow (Nolabel,
                                       {ptyp_desc =
                                         Ptyp_constr ({txt = Lident "t"},
                                          [{ptyp_desc = Ptyp_var "a"}])},
                                       {ptyp_desc = Ptyp_var "a"})})};
                                pval_prim = []}};
                            {psig_desc =
                              Psig_value
                               {pval_name = {txt = "fork_version"};
                                pval_type =
                                 {ptyp_desc =
                                   Ptyp_arrow (Nolabel,
                                    {ptyp_desc =
                                      Ptyp_constr ({txt = Lident "t"},
                                       [{ptyp_desc = Ptyp_var "a"}])},
                                    {ptyp_desc =
                                      Ptyp_constr ({txt = Lident "t"},
                                       [{ptyp_desc =
                                          Ptyp_constr ({txt = Lident "unit"},
                                           [])}])})};
                                pval_prim = []}};
                            {psig_desc =
                              Psig_value
                               {pval_name = {txt = "get_latest_version"};
                                pval_type =
                                 {ptyp_desc =
                                   Ptyp_arrow (Nolabel,
                                    {ptyp_desc =
                                      Ptyp_constr ({txt = Lident "unit"}, [])},
                                    {ptyp_desc =
                                      Ptyp_constr ({txt = Lident "t"},
                                       [{ptyp_desc =
                                          Ptyp_constr
                                           ({txt = Ldot (Lident "OM", "t")},
                                           [])}])})};
                                pval_prim = []}};
                            {psig_desc =
                              Psig_value
                               {pval_name = {txt = "sync_next_version"};
                                pval_type =
                                 {ptyp_desc =
                                   Ptyp_arrow (Optional "v",
                                    {ptyp_desc =
                                      Ptyp_constr
                                       ({txt = Ldot (Lident "OM", "t")}, 
                                       [])},
                                    {ptyp_desc =
                                      Ptyp_constr ({txt = Lident "t"},
                                       [{ptyp_desc =
                                          Ptyp_constr
                                           ({txt = Ldot (Lident "OM", "t")},
                                           [])}])})};
                                pval_prim = []}};
                            {psig_desc =
                              Psig_value
                               {pval_name = {txt = "liftLwt"};
                                pval_type =
                                 {ptyp_desc =
                                   Ptyp_arrow (Nolabel,
                                    {ptyp_desc =
                                      Ptyp_constr
                                       ({txt = Ldot (Lident "Lwt", "t")},
                                       [{ptyp_desc = Ptyp_var "a"}])},
                                    {ptyp_desc =
                                      Ptyp_constr ({txt = Lident "t"},
                                       [{ptyp_desc = Ptyp_var "a"}])})};
                                pval_prim = []}}]})}}}]})})}}}]
=========
