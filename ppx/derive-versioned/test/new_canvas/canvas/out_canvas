out.ml
==>
[{pstr_desc =
   Pstr_module
    {pmb_name = {txt = "Make"};
     pmb_expr =
      {pmod_desc =
        Pmod_structure
         [{pstr_desc =
            Pstr_type (Recursive,
             [{ptype_name = {txt = "pixel"}; ptype_params = [];
               ptype_cstrs = [];
               ptype_kind =
                Ptype_record
                 [{pld_name = {txt = "r"}; pld_mutable = Immutable;
                   pld_type =
                    {ptyp_desc = Ptyp_constr ({txt = Lident "char"}, [])}};
                  {pld_name = {txt = "g"}; pld_mutable = Immutable;
                   pld_type =
                    {ptyp_desc = Ptyp_constr ({txt = Lident "char"}, [])}};
                  {pld_name = {txt = "b"}; pld_mutable = Immutable;
                   pld_type =
                    {ptyp_desc = Ptyp_constr ({txt = Lident "char"}, [])}}];
               ptype_private = Public; ptype_manifest = None}])};
          {pstr_desc =
            Pstr_value (Nonrecursive,
             [{pvb_pat = {ppat_desc = Ppat_var {txt = "default_pixel"}};
               pvb_expr =
                {pexp_desc =
                  Pexp_record
                   ([({txt = Lident "r"},
                      {pexp_desc =
                        Pexp_apply
                         ({pexp_desc =
                            Pexp_ident {txt = Ldot (Lident "Char", "chr")}},
                         [(Nolabel,
                           {pexp_desc =
                             Pexp_constant (Pconst_integer ("255", None))})])});
                     ({txt = Lident "g"},
                      {pexp_desc =
                        Pexp_apply
                         ({pexp_desc =
                            Pexp_ident {txt = Ldot (Lident "Char", "chr")}},
                         [(Nolabel,
                           {pexp_desc =
                             Pexp_constant (Pconst_integer ("255", None))})])});
                     ({txt = Lident "b"},
                      {pexp_desc =
                        Pexp_apply
                         ({pexp_desc =
                            Pexp_ident {txt = Ldot (Lident "Char", "chr")}},
                         [(Nolabel,
                           {pexp_desc =
                             Pexp_constant (Pconst_integer ("255", None))})])})],
                   None)}}])};
          {pstr_desc =
            Pstr_type (Recursive,
             [{ptype_name = {txt = "node"}; ptype_params = [];
               ptype_cstrs = [];
               ptype_kind =
                Ptype_record
                 [{pld_name = {txt = "tl_t"}; pld_mutable = Immutable;
                   pld_type =
                    {ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])}};
                  {pld_name = {txt = "tr_t"}; pld_mutable = Immutable;
                   pld_type =
                    {ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])}};
                  {pld_name = {txt = "bl_t"}; pld_mutable = Immutable;
                   pld_type =
                    {ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])}};
                  {pld_name = {txt = "br_t"}; pld_mutable = Immutable;
                   pld_type =
                    {ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])}}];
               ptype_private = Public; ptype_manifest = None};
              {ptype_name = {txt = "t"}; ptype_params = []; ptype_cstrs = [];
               ptype_kind =
                Ptype_variant
                 [{pcd_name = {txt = "N"};
                   pcd_args =
                    Pcstr_tuple
                     [{ptyp_desc = Ptyp_constr ({txt = Lident "pixel"}, [])}];
                   pcd_res = None};
                  {pcd_name = {txt = "B"};
                   pcd_args =
                    Pcstr_tuple
                     [{ptyp_desc = Ptyp_constr ({txt = Lident "node"}, [])}];
                   pcd_res = None}];
               ptype_private = Public; ptype_manifest = None}])};
          {pstr_desc =
            Pstr_type (Recursive,
             [{ptype_name = {txt = "canvas"}; ptype_params = [];
               ptype_cstrs = [];
               ptype_kind =
                Ptype_record
                 [{pld_name = {txt = "max_x"}; pld_mutable = Immutable;
                   pld_type =
                    {ptyp_desc = Ptyp_constr ({txt = Lident "int"}, [])}};
                  {pld_name = {txt = "max_y"}; pld_mutable = Immutable;
                   pld_type =
                    {ptyp_desc = Ptyp_constr ({txt = Lident "int"}, [])}};
                  {pld_name = {txt = "t"}; pld_mutable = Immutable;
                   pld_type =
                    {ptyp_desc = Ptyp_constr ({txt = Lident "t"}, [])}}];
               ptype_private = Public; ptype_manifest = None}])};
          {pstr_desc =
            Pstr_type (Recursive,
             [{ptype_name = {txt = "loc"}; ptype_params = [];
               ptype_cstrs = [];
               ptype_kind =
                Ptype_record
                 [{pld_name = {txt = "x"}; pld_mutable = Immutable;
                   pld_type =
                    {ptyp_desc = Ptyp_constr ({txt = Lident "int"}, [])}};
                  {pld_name = {txt = "y"}; pld_mutable = Immutable;
                   pld_type =
                    {ptyp_desc = Ptyp_constr ({txt = Lident "int"}, [])}}];
               ptype_private = Public; ptype_manifest = None}])};
          {pstr_desc =
            Pstr_value (Nonrecursive,
             [{pvb_pat = {ppat_desc = Ppat_var {txt = "blank"}};
               pvb_expr =
                {pexp_desc =
                  Pexp_construct ({txt = Lident "N"},
                   Some
                    {pexp_desc = Pexp_ident {txt = Lident "default_pixel"}})}}])};
          {pstr_desc =
            Pstr_value (Nonrecursive,
             [{pvb_pat = {ppat_desc = Ppat_var {txt = "plain"}};
               pvb_expr =
                {pexp_desc =
                  Pexp_fun (Nolabel, None,
                   {ppat_desc = Ppat_var {txt = "px"}},
                   {pexp_desc =
                     Pexp_construct ({txt = Lident "N"},
                      Some {pexp_desc = Pexp_ident {txt = Lident "px"}})})}}])};
          {pstr_desc =
            Pstr_value (Nonrecursive,
             [{pvb_pat = {ppat_desc = Ppat_var {txt = "new_canvas"}};
               pvb_expr =
                {pexp_desc =
                  Pexp_fun (Nolabel, None,
                   {ppat_desc = Ppat_var {txt = "max_x"}},
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "max_y"}},
                      {pexp_desc =
                        Pexp_record
                         ([({txt = Lident "max_x"},
                            {pexp_desc = Pexp_ident {txt = Lident "max_x"}});
                           ({txt = Lident "max_y"},
                            {pexp_desc = Pexp_ident {txt = Lident "max_y"}});
                           ({txt = Lident "t"},
                            {pexp_desc = Pexp_ident {txt = Lident "blank"}})],
                         None)})})}}])};
          {pstr_desc =
            Pstr_value (Recursive,
             [{pvb_pat = {ppat_desc = Ppat_var {txt = "set_px"}};
               pvb_expr =
                {pexp_desc =
                  Pexp_fun (Nolabel, None,
                   {ppat_desc = Ppat_var {txt = "canvas"}},
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "loc"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "px"}},
                         {pexp_desc =
                           Pexp_ifthenelse
                            ({pexp_desc =
                               Pexp_apply
                                ({pexp_desc = Pexp_ident {txt = Lident "&&"}},
                                [(Nolabel,
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "<="}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_field
                                          ({pexp_desc =
                                             Pexp_ident
                                              {txt = Lident "canvas"}},
                                          {txt = Lident "max_x"})});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_field
                                          ({pexp_desc =
                                             Pexp_ident {txt = Lident "loc"}},
                                          {txt = Lident "x"})})])});
                                 (Nolabel,
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "<="}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_field
                                          ({pexp_desc =
                                             Pexp_ident
                                              {txt = Lident "canvas"}},
                                          {txt = Lident "max_y"})});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_field
                                          ({pexp_desc =
                                             Pexp_ident {txt = Lident "loc"}},
                                          {txt = Lident "y"})})])})])},
                            {pexp_desc =
                              Pexp_construct ({txt = Lident "N"},
                               Some
                                {pexp_desc = Pexp_ident {txt = Lident "px"}})},
                            Some
                             {pexp_desc =
                               Pexp_let (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc = Ppat_var {txt = "mid_x"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "/"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_field
                                           ({pexp_desc =
                                              Pexp_ident
                                               {txt = Lident "canvas"}},
                                           {txt = Lident "max_x"})});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_constant
                                           (Pconst_integer ("2", None))})])}}],
                                {pexp_desc =
                                  Pexp_let (Nonrecursive,
                                   [{pvb_pat =
                                      {ppat_desc = Ppat_var {txt = "mid_y"}};
                                     pvb_expr =
                                      {pexp_desc =
                                        Pexp_apply
                                         ({pexp_desc =
                                            Pexp_ident {txt = Lident "/"}},
                                         [(Nolabel,
                                           {pexp_desc =
                                             Pexp_field
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "canvas"}},
                                              {txt = Lident "max_y"})});
                                          (Nolabel,
                                           {pexp_desc =
                                             Pexp_constant
                                              (Pconst_integer ("2", None))})])}}],
                                   {pexp_desc =
                                     Pexp_match
                                      ({pexp_desc =
                                         Pexp_tuple
                                          [{pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "<="}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_field
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "loc"}},
                                                   {txt = Lident "x"})});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "mid_x"}})])};
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "<="}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_field
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "loc"}},
                                                   {txt = Lident "y"})});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "mid_y"}})])}]},
                                      [{pc_lhs =
                                         {ppat_desc =
                                           Ppat_tuple
                                            [{ppat_desc =
                                               Ppat_construct
                                                ({txt = Lident "true"}, None)};
                                             {ppat_desc =
                                               Ppat_construct
                                                ({txt = Lident "true"}, None)}]};
                                        pc_guard = None;
                                        pc_rhs =
                                         {pexp_desc =
                                           Pexp_let (Nonrecursive,
                                            [{pvb_pat =
                                               {ppat_desc =
                                                 Ppat_var {txt = "tl_t"}};
                                              pvb_expr =
                                               {pexp_desc =
                                                 Pexp_match
                                                  ({pexp_desc =
                                                     Pexp_field
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "canvas"}},
                                                      {txt = Lident "t"})},
                                                  [{pc_lhs =
                                                     {ppat_desc =
                                                       Ppat_construct
                                                        ({txt = Lident "N"},
                                                        Some
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "px"}})};
                                                    pc_guard = None;
                                                    pc_rhs =
                                                     {pexp_desc =
                                                       Pexp_construct
                                                        ({txt = Lident "N"},
                                                        Some
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "px"}})}};
                                                   {pc_lhs =
                                                     {ppat_desc =
                                                       Ppat_construct
                                                        ({txt = Lident "B"},
                                                        Some
                                                         {ppat_desc =
                                                           Ppat_record
                                                            ([({txt =
                                                                 Lident
                                                                  "tl_t"},
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt =
                                                                    "tl_t"}})],
                                                            Closed)})};
                                                    pc_guard = None;
                                                    pc_rhs =
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "tl_t"}}}])}}],
                                            {pexp_desc =
                                              Pexp_let (Nonrecursive,
                                               [{pvb_pat =
                                                  {ppat_desc =
                                                    Ppat_var {txt = "tl_c"}};
                                                 pvb_expr =
                                                  {pexp_desc =
                                                    Pexp_record
                                                     ([({txt = Lident "max_x"},
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "mid_x"}});
                                                       ({txt = Lident "max_y"},
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "mid_y"}});
                                                       ({txt = Lident "t"},
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "tl_t"}})],
                                                     None)}}],
                                               {pexp_desc =
                                                 Pexp_let (Nonrecursive,
                                                  [{pvb_pat =
                                                     {ppat_desc =
                                                       Ppat_var
                                                        {txt = "tl_t'"}};
                                                    pvb_expr =
                                                     {pexp_desc =
                                                       Pexp_apply
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "set_px"}},
                                                        [(Nolabel,
                                                          {pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "tl_c"}});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "loc"}});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "px"}})])}}],
                                                  {pexp_desc =
                                                    Pexp_let (Nonrecursive,
                                                     [{pvb_pat =
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "t'"}};
                                                       pvb_expr =
                                                        {pexp_desc =
                                                          Pexp_match
                                                           ({pexp_desc =
                                                              Pexp_field
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "canvas"}},
                                                               {txt =
                                                                 Lident "t"})},
                                                           [{pc_lhs =
                                                              {ppat_desc =
                                                                Ppat_construct
                                                                 ({txt =
                                                                    Lident
                                                                    "N"},
                                                                 Some
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "px"}})};
                                                             pc_guard = None;
                                                             pc_rhs =
                                                              {pexp_desc =
                                                                Pexp_construct
                                                                 ({txt =
                                                                    Lident
                                                                    "B"},
                                                                 Some
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "tl_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "tl_t'"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "tr_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "px"}})});
                                                                    ({txt =
                                                                    Lident
                                                                    "bl_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "px"}})});
                                                                    ({txt =
                                                                    Lident
                                                                    "br_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "px"}})})],
                                                                    None)})}};
                                                            {pc_lhs =
                                                              {ppat_desc =
                                                                Ppat_construct
                                                                 ({txt =
                                                                    Lident
                                                                    "B"},
                                                                 Some
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "y"}})};
                                                             pc_guard = None;
                                                             pc_rhs =
                                                              {pexp_desc =
                                                                Pexp_construct
                                                                 ({txt =
                                                                    Lident
                                                                    "B"},
                                                                 Some
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "tl_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "tl_t'"}})],
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})})}}])}}],
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "t'"}})})})})}};
                                       {pc_lhs =
                                         {ppat_desc =
                                           Ppat_tuple
                                            [{ppat_desc =
                                               Ppat_construct
                                                ({txt = Lident "false"},
                                                None)};
                                             {ppat_desc =
                                               Ppat_construct
                                                ({txt = Lident "true"}, None)}]};
                                        pc_guard = None;
                                        pc_rhs =
                                         {pexp_desc =
                                           Pexp_let (Nonrecursive,
                                            [{pvb_pat =
                                               {ppat_desc =
                                                 Ppat_var {txt = "tr_t"}};
                                              pvb_expr =
                                               {pexp_desc =
                                                 Pexp_match
                                                  ({pexp_desc =
                                                     Pexp_field
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "canvas"}},
                                                      {txt = Lident "t"})},
                                                  [{pc_lhs =
                                                     {ppat_desc =
                                                       Ppat_construct
                                                        ({txt = Lident "N"},
                                                        Some
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "px"}})};
                                                    pc_guard = None;
                                                    pc_rhs =
                                                     {pexp_desc =
                                                       Pexp_construct
                                                        ({txt = Lident "N"},
                                                        Some
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "px"}})}};
                                                   {pc_lhs =
                                                     {ppat_desc =
                                                       Ppat_construct
                                                        ({txt = Lident "B"},
                                                        Some
                                                         {ppat_desc =
                                                           Ppat_record
                                                            ([({txt =
                                                                 Lident
                                                                  "tr_t"},
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt =
                                                                    "tr_t"}})],
                                                            Closed)})};
                                                    pc_guard = None;
                                                    pc_rhs =
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "tr_t"}}}])}}],
                                            {pexp_desc =
                                              Pexp_let (Nonrecursive,
                                               [{pvb_pat =
                                                  {ppat_desc =
                                                    Ppat_var {txt = "tr_c"}};
                                                 pvb_expr =
                                                  {pexp_desc =
                                                    Pexp_record
                                                     ([({txt = Lident "max_x"},
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "-"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_field
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "canvas"}},
                                                                {txt =
                                                                  Lident
                                                                   "max_x"})});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "mid_x"}})])});
                                                       ({txt = Lident "max_y"},
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "mid_y"}});
                                                       ({txt = Lident "t"},
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "tr_t"}})],
                                                     None)}}],
                                               {pexp_desc =
                                                 Pexp_let (Nonrecursive,
                                                  [{pvb_pat =
                                                     {ppat_desc =
                                                       Ppat_var
                                                        {txt = "loc'"}};
                                                    pvb_expr =
                                                     {pexp_desc =
                                                       Pexp_record
                                                        ([({txt = Lident "x"},
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "-"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_field
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "loc"}},
                                                                   {txt =
                                                                    Lident
                                                                    "x"})});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "mid_x"}})])})],
                                                        Some
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "loc"}})}}],
                                                  {pexp_desc =
                                                    Pexp_let (Nonrecursive,
                                                     [{pvb_pat =
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "tr_t'"}};
                                                       pvb_expr =
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "set_px"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "tr_c"}});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "loc'"}});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "px"}})])}}],
                                                     {pexp_desc =
                                                       Pexp_let
                                                        (Nonrecursive,
                                                        [{pvb_pat =
                                                           {ppat_desc =
                                                             Ppat_var
                                                              {txt = "t'"}};
                                                          pvb_expr =
                                                           {pexp_desc =
                                                             Pexp_match
                                                              ({pexp_desc =
                                                                 Pexp_field
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "canvas"}},
                                                                  {txt =
                                                                    Lident
                                                                    "t"})},
                                                              [{pc_lhs =
                                                                 {ppat_desc =
                                                                   Ppat_construct
                                                                    (
                                                                    {txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "px"}})};
                                                                pc_guard =
                                                                 None;
                                                                pc_rhs =
                                                                 {pexp_desc =
                                                                   Pexp_construct
                                                                    (
                                                                    {txt =
                                                                    Lident
                                                                    "B"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "tl_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "px"}})});
                                                                    ({txt =
                                                                    Lident
                                                                    "tr_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "tr_t'"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "bl_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "px"}})});
                                                                    ({txt =
                                                                    Lident
                                                                    "br_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "px"}})})],
                                                                    None)})}};
                                                               {pc_lhs =
                                                                 {ppat_desc =
                                                                   Ppat_construct
                                                                    (
                                                                    {txt =
                                                                    Lident
                                                                    "B"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "y"}})};
                                                                pc_guard =
                                                                 None;
                                                                pc_rhs =
                                                                 {pexp_desc =
                                                                   Pexp_construct
                                                                    (
                                                                    {txt =
                                                                    Lident
                                                                    "B"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "tr_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "tr_t'"}})],
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})})}}])}}],
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "t'"}})})})})})}};
                                       {pc_lhs =
                                         {ppat_desc =
                                           Ppat_tuple
                                            [{ppat_desc =
                                               Ppat_construct
                                                ({txt = Lident "true"}, None)};
                                             {ppat_desc =
                                               Ppat_construct
                                                ({txt = Lident "false"},
                                                None)}]};
                                        pc_guard = None;
                                        pc_rhs =
                                         {pexp_desc =
                                           Pexp_let (Nonrecursive,
                                            [{pvb_pat =
                                               {ppat_desc =
                                                 Ppat_var {txt = "bl_t"}};
                                              pvb_expr =
                                               {pexp_desc =
                                                 Pexp_match
                                                  ({pexp_desc =
                                                     Pexp_field
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "canvas"}},
                                                      {txt = Lident "t"})},
                                                  [{pc_lhs =
                                                     {ppat_desc =
                                                       Ppat_construct
                                                        ({txt = Lident "N"},
                                                        Some
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "px"}})};
                                                    pc_guard = None;
                                                    pc_rhs =
                                                     {pexp_desc =
                                                       Pexp_construct
                                                        ({txt = Lident "N"},
                                                        Some
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "px"}})}};
                                                   {pc_lhs =
                                                     {ppat_desc =
                                                       Ppat_construct
                                                        ({txt = Lident "B"},
                                                        Some
                                                         {ppat_desc =
                                                           Ppat_record
                                                            ([({txt =
                                                                 Lident
                                                                  "bl_t"},
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt =
                                                                    "bl_t"}})],
                                                            Closed)})};
                                                    pc_guard = None;
                                                    pc_rhs =
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "bl_t"}}}])}}],
                                            {pexp_desc =
                                              Pexp_let (Nonrecursive,
                                               [{pvb_pat =
                                                  {ppat_desc =
                                                    Ppat_var {txt = "bl_c"}};
                                                 pvb_expr =
                                                  {pexp_desc =
                                                    Pexp_record
                                                     ([({txt = Lident "max_x"},
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "mid_x"}});
                                                       ({txt = Lident "max_y"},
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "-"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_field
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "canvas"}},
                                                                {txt =
                                                                  Lident
                                                                   "max_y"})});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "mid_y"}})])});
                                                       ({txt = Lident "t"},
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "bl_t"}})],
                                                     None)}}],
                                               {pexp_desc =
                                                 Pexp_let (Nonrecursive,
                                                  [{pvb_pat =
                                                     {ppat_desc =
                                                       Ppat_var
                                                        {txt = "loc'"}};
                                                    pvb_expr =
                                                     {pexp_desc =
                                                       Pexp_record
                                                        ([({txt = Lident "y"},
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "-"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_field
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "loc"}},
                                                                   {txt =
                                                                    Lident
                                                                    "y"})});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "mid_y"}})])})],
                                                        Some
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "loc"}})}}],
                                                  {pexp_desc =
                                                    Pexp_let (Nonrecursive,
                                                     [{pvb_pat =
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "bl_t'"}};
                                                       pvb_expr =
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "set_px"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "bl_c"}});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "loc'"}});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "px"}})])}}],
                                                     {pexp_desc =
                                                       Pexp_let
                                                        (Nonrecursive,
                                                        [{pvb_pat =
                                                           {ppat_desc =
                                                             Ppat_var
                                                              {txt = "t'"}};
                                                          pvb_expr =
                                                           {pexp_desc =
                                                             Pexp_match
                                                              ({pexp_desc =
                                                                 Pexp_field
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "canvas"}},
                                                                  {txt =
                                                                    Lident
                                                                    "t"})},
                                                              [{pc_lhs =
                                                                 {ppat_desc =
                                                                   Ppat_construct
                                                                    (
                                                                    {txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "px"}})};
                                                                pc_guard =
                                                                 None;
                                                                pc_rhs =
                                                                 {pexp_desc =
                                                                   Pexp_construct
                                                                    (
                                                                    {txt =
                                                                    Lident
                                                                    "B"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "tl_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "px"}})});
                                                                    ({txt =
                                                                    Lident
                                                                    "tr_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "px"}})});
                                                                    ({txt =
                                                                    Lident
                                                                    "bl_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "bl_t'"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "br_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "px"}})})],
                                                                    None)})}};
                                                               {pc_lhs =
                                                                 {ppat_desc =
                                                                   Ppat_construct
                                                                    (
                                                                    {txt =
                                                                    Lident
                                                                    "B"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "y"}})};
                                                                pc_guard =
                                                                 None;
                                                                pc_rhs =
                                                                 {pexp_desc =
                                                                   Pexp_construct
                                                                    (
                                                                    {txt =
                                                                    Lident
                                                                    "B"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "bl_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "bl_t'"}})],
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})})}}])}}],
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "t'"}})})})})})}};
                                       {pc_lhs =
                                         {ppat_desc =
                                           Ppat_tuple
                                            [{ppat_desc =
                                               Ppat_construct
                                                ({txt = Lident "false"},
                                                None)};
                                             {ppat_desc =
                                               Ppat_construct
                                                ({txt = Lident "false"},
                                                None)}]};
                                        pc_guard = None;
                                        pc_rhs =
                                         {pexp_desc =
                                           Pexp_let (Nonrecursive,
                                            [{pvb_pat =
                                               {ppat_desc =
                                                 Ppat_var {txt = "br_t"}};
                                              pvb_expr =
                                               {pexp_desc =
                                                 Pexp_match
                                                  ({pexp_desc =
                                                     Pexp_field
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "canvas"}},
                                                      {txt = Lident "t"})},
                                                  [{pc_lhs =
                                                     {ppat_desc =
                                                       Ppat_construct
                                                        ({txt = Lident "N"},
                                                        Some
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "px"}})};
                                                    pc_guard = None;
                                                    pc_rhs =
                                                     {pexp_desc =
                                                       Pexp_construct
                                                        ({txt = Lident "N"},
                                                        Some
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "px"}})}};
                                                   {pc_lhs =
                                                     {ppat_desc =
                                                       Ppat_construct
                                                        ({txt = Lident "B"},
                                                        Some
                                                         {ppat_desc =
                                                           Ppat_record
                                                            ([({txt =
                                                                 Lident
                                                                  "br_t"},
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt =
                                                                    "br_t"}})],
                                                            Closed)})};
                                                    pc_guard = None;
                                                    pc_rhs =
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "br_t"}}}])}}],
                                            {pexp_desc =
                                              Pexp_let (Nonrecursive,
                                               [{pvb_pat =
                                                  {ppat_desc =
                                                    Ppat_var {txt = "br_c"}};
                                                 pvb_expr =
                                                  {pexp_desc =
                                                    Pexp_record
                                                     ([({txt = Lident "max_x"},
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "-"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_field
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "canvas"}},
                                                                {txt =
                                                                  Lident
                                                                   "max_x"})});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "mid_x"}})])});
                                                       ({txt = Lident "max_y"},
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "-"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_field
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "canvas"}},
                                                                {txt =
                                                                  Lident
                                                                   "max_y"})});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "mid_y"}})])});
                                                       ({txt = Lident "t"},
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "br_t"}})],
                                                     None)}}],
                                               {pexp_desc =
                                                 Pexp_let (Nonrecursive,
                                                  [{pvb_pat =
                                                     {ppat_desc =
                                                       Ppat_var
                                                        {txt = "loc'"}};
                                                    pvb_expr =
                                                     {pexp_desc =
                                                       Pexp_record
                                                        ([({txt = Lident "x"},
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "-"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_field
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "loc"}},
                                                                   {txt =
                                                                    Lident
                                                                    "x"})});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "mid_x"}})])});
                                                          ({txt = Lident "y"},
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "-"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_field
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "loc"}},
                                                                   {txt =
                                                                    Lident
                                                                    "y"})});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "mid_y"}})])})],
                                                        None)}}],
                                                  {pexp_desc =
                                                    Pexp_let (Nonrecursive,
                                                     [{pvb_pat =
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "br_t'"}};
                                                       pvb_expr =
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "set_px"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "br_c"}});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "loc'"}});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "px"}})])}}],
                                                     {pexp_desc =
                                                       Pexp_let
                                                        (Nonrecursive,
                                                        [{pvb_pat =
                                                           {ppat_desc =
                                                             Ppat_var
                                                              {txt = "t'"}};
                                                          pvb_expr =
                                                           {pexp_desc =
                                                             Pexp_match
                                                              ({pexp_desc =
                                                                 Pexp_field
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "canvas"}},
                                                                  {txt =
                                                                    Lident
                                                                    "t"})},
                                                              [{pc_lhs =
                                                                 {ppat_desc =
                                                                   Ppat_construct
                                                                    (
                                                                    {txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "px"}})};
                                                                pc_guard =
                                                                 None;
                                                                pc_rhs =
                                                                 {pexp_desc =
                                                                   Pexp_construct
                                                                    (
                                                                    {txt =
                                                                    Lident
                                                                    "B"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "tl_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "px"}})});
                                                                    ({txt =
                                                                    Lident
                                                                    "tr_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "px"}})});
                                                                    ({txt =
                                                                    Lident
                                                                    "bl_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "px"}})});
                                                                    ({txt =
                                                                    Lident
                                                                    "br_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "br_t'"}})],
                                                                    None)})}};
                                                               {pc_lhs =
                                                                 {ppat_desc =
                                                                   Ppat_construct
                                                                    (
                                                                    {txt =
                                                                    Lident
                                                                    "B"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "y"}})};
                                                                pc_guard =
                                                                 None;
                                                                pc_rhs =
                                                                 {pexp_desc =
                                                                   Pexp_construct
                                                                    (
                                                                    {txt =
                                                                    Lident
                                                                    "B"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "br_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "br_t'"}})],
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})})}}])}}],
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "t'"}})})})})})}}])})})})})})})}}])};
          {pstr_desc =
            Pstr_value (Nonrecursive,
             [{pvb_pat = {ppat_desc = Ppat_var {txt = "set_px"}};
               pvb_expr =
                {pexp_desc =
                  Pexp_fun (Nolabel, None,
                   {ppat_desc = Ppat_var {txt = "canvas"}},
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "loc"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "px"}},
                         {pexp_desc =
                           Pexp_ifthenelse
                            ({pexp_desc =
                               Pexp_apply
                                ({pexp_desc = Pexp_ident {txt = Lident "||"}},
                                [(Nolabel,
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident ">"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_field
                                          ({pexp_desc =
                                             Pexp_ident {txt = Lident "loc"}},
                                          {txt = Lident "x"})});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_field
                                          ({pexp_desc =
                                             Pexp_ident
                                              {txt = Lident "canvas"}},
                                          {txt = Lident "max_x"})})])});
                                 (Nolabel,
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident ">"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_field
                                          ({pexp_desc =
                                             Pexp_ident {txt = Lident "loc"}},
                                          {txt = Lident "y"})});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_field
                                          ({pexp_desc =
                                             Pexp_ident
                                              {txt = Lident "canvas"}},
                                          {txt = Lident "max_y"})})])})])},
                            {pexp_desc =
                              Pexp_apply
                               ({pexp_desc =
                                  Pexp_ident {txt = Lident "failwith"}},
                               [(Nolabel,
                                 {pexp_desc =
                                   Pexp_constant
                                    (Pconst_string
                                      ("set_px: location out of canvas bounds",
                                      None))})])},
                            Some
                             {pexp_desc =
                               Pexp_let (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc = Ppat_var {txt = "t'"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "set_px"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "canvas"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "loc"}});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_ident {txt = Lident "px"}})])}}],
                                {pexp_desc =
                                  Pexp_record
                                   ([({txt = Lident "t"},
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "t'"}})],
                                   Some
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "canvas"}})})})})})})}}])};
          {pstr_desc =
            Pstr_value (Recursive,
             [{pvb_pat = {ppat_desc = Ppat_var {txt = "get_px"}};
               pvb_expr =
                {pexp_desc =
                  Pexp_fun (Nolabel, None,
                   {ppat_desc = Ppat_var {txt = "canvas"}},
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "loc"}},
                      {pexp_desc =
                        Pexp_match
                         ({pexp_desc =
                            Pexp_field
                             ({pexp_desc = Pexp_ident {txt = Lident "canvas"}},
                             {txt = Lident "t"})},
                         [{pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "N"},
                               Some {ppat_desc = Ppat_var {txt = "px"}})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc = Pexp_ident {txt = Lident "px"}}};
                          {pc_lhs =
                            {ppat_desc =
                              Ppat_construct ({txt = Lident "B"},
                               Some {ppat_desc = Ppat_var {txt = "y"}})};
                           pc_guard = None;
                           pc_rhs =
                            {pexp_desc =
                              Pexp_let (Nonrecursive,
                               [{pvb_pat =
                                  {ppat_desc = Ppat_var {txt = "mid_x"}};
                                 pvb_expr =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "/"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_field
                                          ({pexp_desc =
                                             Pexp_ident
                                              {txt = Lident "canvas"}},
                                          {txt = Lident "max_x"})});
                                      (Nolabel,
                                       {pexp_desc =
                                         Pexp_constant
                                          (Pconst_integer ("2", None))})])}}],
                               {pexp_desc =
                                 Pexp_let (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "mid_y"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "/"}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_field
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "canvas"}},
                                             {txt = Lident "max_y"})});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_constant
                                             (Pconst_integer ("2", None))})])}}],
                                  {pexp_desc =
                                    Pexp_match
                                     ({pexp_desc =
                                        Pexp_tuple
                                         [{pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "<="}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_field
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "loc"}},
                                                  {txt = Lident "x"})});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "mid_x"}})])};
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "<="}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_field
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "loc"}},
                                                  {txt = Lident "y"})});
                                              (Nolabel,
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "mid_y"}})])}]},
                                     [{pc_lhs =
                                        {ppat_desc =
                                          Ppat_tuple
                                           [{ppat_desc =
                                              Ppat_construct
                                               ({txt = Lident "true"}, None)};
                                            {ppat_desc =
                                              Ppat_construct
                                               ({txt = Lident "true"}, None)}]};
                                       pc_guard = None;
                                       pc_rhs =
                                        {pexp_desc =
                                          Pexp_let (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "tl_t"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_match
                                                 ({pexp_desc =
                                                    Pexp_field
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Lident "canvas"}},
                                                     {txt = Lident "t"})},
                                                 [{pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_construct
                                                       ({txt = Lident "N"},
                                                       Some
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "px"}})};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_construct
                                                       ({txt = Lident "N"},
                                                       Some
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "px"}})}};
                                                  {pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_construct
                                                       ({txt = Lident "B"},
                                                       Some
                                                        {ppat_desc =
                                                          Ppat_record
                                                           ([({txt =
                                                                Lident "tl_t"},
                                                              {ppat_desc =
                                                                Ppat_var
                                                                 {txt =
                                                                   "tl_t"}})],
                                                           Closed)})};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "tl_t"}}}])}}],
                                           {pexp_desc =
                                             Pexp_let (Nonrecursive,
                                              [{pvb_pat =
                                                 {ppat_desc =
                                                   Ppat_var {txt = "tl_c"}};
                                                pvb_expr =
                                                 {pexp_desc =
                                                   Pexp_record
                                                    ([({txt = Lident "max_x"},
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "mid_x"}});
                                                      ({txt = Lident "max_y"},
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "mid_y"}});
                                                      ({txt = Lident "t"},
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "tl_t"}})],
                                                    None)}}],
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "get_px"}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "tl_c"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "loc"}})])})})}};
                                      {pc_lhs =
                                        {ppat_desc =
                                          Ppat_tuple
                                           [{ppat_desc =
                                              Ppat_construct
                                               ({txt = Lident "false"}, None)};
                                            {ppat_desc =
                                              Ppat_construct
                                               ({txt = Lident "true"}, None)}]};
                                       pc_guard = None;
                                       pc_rhs =
                                        {pexp_desc =
                                          Pexp_let (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "tr_t"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_match
                                                 ({pexp_desc =
                                                    Pexp_field
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Lident "canvas"}},
                                                     {txt = Lident "t"})},
                                                 [{pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_construct
                                                       ({txt = Lident "N"},
                                                       Some
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "px"}})};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_construct
                                                       ({txt = Lident "N"},
                                                       Some
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "px"}})}};
                                                  {pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_construct
                                                       ({txt = Lident "B"},
                                                       Some
                                                        {ppat_desc =
                                                          Ppat_record
                                                           ([({txt =
                                                                Lident "tr_t"},
                                                              {ppat_desc =
                                                                Ppat_var
                                                                 {txt =
                                                                   "tr_t"}})],
                                                           Closed)})};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "tr_t"}}}])}}],
                                           {pexp_desc =
                                             Pexp_let (Nonrecursive,
                                              [{pvb_pat =
                                                 {ppat_desc =
                                                   Ppat_var {txt = "tr_c"}};
                                                pvb_expr =
                                                 {pexp_desc =
                                                   Pexp_record
                                                    ([({txt = Lident "max_x"},
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "-"}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_field
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "canvas"}},
                                                               {txt =
                                                                 Lident
                                                                  "max_x"})});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "mid_x"}})])});
                                                      ({txt = Lident "max_y"},
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "mid_y"}});
                                                      ({txt = Lident "t"},
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "tr_t"}})],
                                                    None)}}],
                                              {pexp_desc =
                                                Pexp_let (Nonrecursive,
                                                 [{pvb_pat =
                                                    {ppat_desc =
                                                      Ppat_var {txt = "loc'"}};
                                                   pvb_expr =
                                                    {pexp_desc =
                                                      Pexp_record
                                                       ([({txt = Lident "x"},
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident "-"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_field
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "loc"}},
                                                                  {txt =
                                                                    Lident
                                                                    "x"})});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "mid_x"}})])})],
                                                       Some
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "loc"}})}}],
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Lident "get_px"}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "tr_c"}});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "loc'"}})])})})})}};
                                      {pc_lhs =
                                        {ppat_desc =
                                          Ppat_tuple
                                           [{ppat_desc =
                                              Ppat_construct
                                               ({txt = Lident "true"}, None)};
                                            {ppat_desc =
                                              Ppat_construct
                                               ({txt = Lident "false"}, None)}]};
                                       pc_guard = None;
                                       pc_rhs =
                                        {pexp_desc =
                                          Pexp_let (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "bl_t"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_match
                                                 ({pexp_desc =
                                                    Pexp_field
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Lident "canvas"}},
                                                     {txt = Lident "t"})},
                                                 [{pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_construct
                                                       ({txt = Lident "N"},
                                                       Some
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "px"}})};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_construct
                                                       ({txt = Lident "N"},
                                                       Some
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "px"}})}};
                                                  {pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_construct
                                                       ({txt = Lident "B"},
                                                       Some
                                                        {ppat_desc =
                                                          Ppat_record
                                                           ([({txt =
                                                                Lident "bl_t"},
                                                              {ppat_desc =
                                                                Ppat_var
                                                                 {txt =
                                                                   "bl_t"}})],
                                                           Closed)})};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "bl_t"}}}])}}],
                                           {pexp_desc =
                                             Pexp_let (Nonrecursive,
                                              [{pvb_pat =
                                                 {ppat_desc =
                                                   Ppat_var {txt = "bl_c"}};
                                                pvb_expr =
                                                 {pexp_desc =
                                                   Pexp_record
                                                    ([({txt = Lident "max_x"},
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "mid_x"}});
                                                      ({txt = Lident "max_y"},
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "-"}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_field
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "canvas"}},
                                                               {txt =
                                                                 Lident
                                                                  "max_y"})});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "mid_y"}})])});
                                                      ({txt = Lident "t"},
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "bl_t"}})],
                                                    None)}}],
                                              {pexp_desc =
                                                Pexp_let (Nonrecursive,
                                                 [{pvb_pat =
                                                    {ppat_desc =
                                                      Ppat_var {txt = "loc'"}};
                                                   pvb_expr =
                                                    {pexp_desc =
                                                      Pexp_record
                                                       ([({txt = Lident "y"},
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident "-"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_field
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "loc"}},
                                                                  {txt =
                                                                    Lident
                                                                    "y"})});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "mid_y"}})])})],
                                                       Some
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "loc"}})}}],
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Lident "get_px"}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "bl_c"}});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "loc'"}})])})})})}};
                                      {pc_lhs =
                                        {ppat_desc =
                                          Ppat_tuple
                                           [{ppat_desc =
                                              Ppat_construct
                                               ({txt = Lident "false"}, None)};
                                            {ppat_desc =
                                              Ppat_construct
                                               ({txt = Lident "false"}, None)}]};
                                       pc_guard = None;
                                       pc_rhs =
                                        {pexp_desc =
                                          Pexp_let (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "br_t"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_match
                                                 ({pexp_desc =
                                                    Pexp_field
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Lident "canvas"}},
                                                     {txt = Lident "t"})},
                                                 [{pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_construct
                                                       ({txt = Lident "N"},
                                                       Some
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "px"}})};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_construct
                                                       ({txt = Lident "N"},
                                                       Some
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "px"}})}};
                                                  {pc_lhs =
                                                    {ppat_desc =
                                                      Ppat_construct
                                                       ({txt = Lident "B"},
                                                       Some
                                                        {ppat_desc =
                                                          Ppat_record
                                                           ([({txt =
                                                                Lident "br_t"},
                                                              {ppat_desc =
                                                                Ppat_var
                                                                 {txt =
                                                                   "br_t"}})],
                                                           Closed)})};
                                                   pc_guard = None;
                                                   pc_rhs =
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "br_t"}}}])}}],
                                           {pexp_desc =
                                             Pexp_let (Nonrecursive,
                                              [{pvb_pat =
                                                 {ppat_desc =
                                                   Ppat_var {txt = "br_c"}};
                                                pvb_expr =
                                                 {pexp_desc =
                                                   Pexp_record
                                                    ([({txt = Lident "max_x"},
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "-"}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_field
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "canvas"}},
                                                               {txt =
                                                                 Lident
                                                                  "max_x"})});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "mid_x"}})])});
                                                      ({txt = Lident "max_y"},
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "-"}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_field
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "canvas"}},
                                                               {txt =
                                                                 Lident
                                                                  "max_y"})});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident
                                                                  "mid_y"}})])});
                                                      ({txt = Lident "t"},
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "br_t"}})],
                                                    None)}}],
                                              {pexp_desc =
                                                Pexp_let (Nonrecursive,
                                                 [{pvb_pat =
                                                    {ppat_desc =
                                                      Ppat_var {txt = "loc'"}};
                                                   pvb_expr =
                                                    {pexp_desc =
                                                      Pexp_record
                                                       ([({txt = Lident "x"},
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident "-"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_field
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "loc"}},
                                                                  {txt =
                                                                    Lident
                                                                    "x"})});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "mid_x"}})])});
                                                         ({txt = Lident "y"},
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident "-"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_field
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "loc"}},
                                                                  {txt =
                                                                    Lident
                                                                    "y"})});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "mid_y"}})])})],
                                                       None)}}],
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Lident "get_px"}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "br_c"}});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "loc'"}})])})})})}}])})})}}])})})}}])};
          {pstr_desc =
            Pstr_value (Nonrecursive,
             [{pvb_pat = {ppat_desc = Ppat_var {txt = "color_mix"}};
               pvb_expr =
                {pexp_desc =
                  Pexp_fun (Nolabel, None,
                   {ppat_desc = Ppat_var {txt = "px1"}},
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "px2"}},
                      {pexp_desc =
                        Pexp_constraint
                         ({pexp_desc =
                            Pexp_let (Nonrecursive,
                             [{pvb_pat = {ppat_desc = Ppat_var {txt = "f"}};
                               pvb_expr =
                                {pexp_desc =
                                  Pexp_ident
                                   {txt = Ldot (Lident "Char", "code")}}}],
                             {pexp_desc =
                               Pexp_let (Nonrecursive,
                                [{pvb_pat =
                                   {ppat_desc = Ppat_var {txt = "h"}};
                                  pvb_expr =
                                   {pexp_desc =
                                     Pexp_fun (Nolabel, None,
                                      {ppat_desc = Ppat_var {txt = "x"}},
                                      {pexp_desc =
                                        Pexp_fun (Nolabel, None,
                                         {ppat_desc = Ppat_var {txt = "y"}},
                                         {pexp_desc =
                                           Pexp_apply
                                            ({pexp_desc =
                                               Pexp_ident {txt = Lident "@@"}},
                                            [(Nolabel,
                                              {pexp_desc =
                                                Pexp_ident
                                                 {txt =
                                                   Ldot (Lident "Char",
                                                    "chr")}});
                                             (Nolabel,
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "/"}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident "+"}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "x"}});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "y"}})])});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_constant
                                                      (Pconst_integer ("2",
                                                        None))})])})])})})}}],
                                {pexp_desc =
                                  Pexp_let (Nonrecursive,
                                   [{pvb_pat =
                                      {ppat_desc =
                                        Ppat_tuple
                                         [{ppat_desc = Ppat_var {txt = "r1"}};
                                          {ppat_desc = Ppat_var {txt = "g1"}};
                                          {ppat_desc = Ppat_var {txt = "b1"}}]};
                                     pvb_expr =
                                      {pexp_desc =
                                        Pexp_tuple
                                         [{pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident {txt = Lident "f"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_field
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "px1"}},
                                                  {txt = Lident "r"})})])};
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident {txt = Lident "f"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_field
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "px1"}},
                                                  {txt = Lident "g"})})])};
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident {txt = Lident "f"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_field
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "px1"}},
                                                  {txt = Lident "b"})})])}]}}],
                                   {pexp_desc =
                                     Pexp_let (Nonrecursive,
                                      [{pvb_pat =
                                         {ppat_desc =
                                           Ppat_tuple
                                            [{ppat_desc =
                                               Ppat_var {txt = "r2"}};
                                             {ppat_desc =
                                               Ppat_var {txt = "g2"}};
                                             {ppat_desc =
                                               Ppat_var {txt = "b2"}}]};
                                        pvb_expr =
                                         {pexp_desc =
                                           Pexp_tuple
                                            [{pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "f"}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_field
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "px2"}},
                                                     {txt = Lident "r"})})])};
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "f"}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_field
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "px2"}},
                                                     {txt = Lident "g"})})])};
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "f"}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_field
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "px2"}},
                                                     {txt = Lident "b"})})])}]}}],
                                      {pexp_desc =
                                        Pexp_let (Nonrecursive,
                                         [{pvb_pat =
                                            {ppat_desc =
                                              Ppat_tuple
                                               [{ppat_desc =
                                                  Ppat_var {txt = "r"}};
                                                {ppat_desc =
                                                  Ppat_var {txt = "g"}};
                                                {ppat_desc =
                                                  Ppat_var {txt = "b"}}]};
                                           pvb_expr =
                                            {pexp_desc =
                                              Pexp_tuple
                                               [{pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "h"}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "r1"}});
                                                    (Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "r2"}})])};
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "h"}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "g1"}});
                                                    (Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "g2"}})])};
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "h"}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "b1"}});
                                                    (Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "b2"}})])}]}}],
                                         {pexp_desc =
                                           Pexp_record
                                            ([({txt = Lident "r"},
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "r"}});
                                              ({txt = Lident "g"},
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "g"}});
                                              ({txt = Lident "b"},
                                               {pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "b"}})],
                                            None)})})})})})},
                         {ptyp_desc =
                           Ptyp_constr ({txt = Lident "pixel"}, [])})})})}}])};
          {pstr_desc =
            Pstr_value (Nonrecursive,
             [{pvb_pat = {ppat_desc = Ppat_var {txt = "b_of_n"}};
               pvb_expr =
                {pexp_desc =
                  Pexp_fun (Nolabel, None,
                   {ppat_desc = Ppat_var {txt = "px"}},
                   {pexp_desc =
                     Pexp_construct ({txt = Lident "B"},
                      Some
                       {pexp_desc =
                         Pexp_record
                          ([({txt = Lident "tl_t"},
                             {pexp_desc =
                               Pexp_construct ({txt = Lident "N"},
                                Some
                                 {pexp_desc = Pexp_ident {txt = Lident "px"}})});
                            ({txt = Lident "tr_t"},
                             {pexp_desc =
                               Pexp_construct ({txt = Lident "N"},
                                Some
                                 {pexp_desc = Pexp_ident {txt = Lident "px"}})});
                            ({txt = Lident "bl_t"},
                             {pexp_desc =
                               Pexp_construct ({txt = Lident "N"},
                                Some
                                 {pexp_desc = Pexp_ident {txt = Lident "px"}})});
                            ({txt = Lident "br_t"},
                             {pexp_desc =
                               Pexp_construct ({txt = Lident "N"},
                                Some
                                 {pexp_desc = Pexp_ident {txt = Lident "px"}})})],
                          None)})})}}])};
          {pstr_desc =
            Pstr_value (Nonrecursive,
             [{pvb_pat = {ppat_desc = Ppat_var {txt = "make_b"}};
               pvb_expr =
                {pexp_desc =
                  Pexp_fun (Nolabel, None,
                   {ppat_desc =
                     Ppat_tuple
                      [{ppat_desc = Ppat_var {txt = "tl"}};
                       {ppat_desc = Ppat_var {txt = "tr"}};
                       {ppat_desc = Ppat_var {txt = "bl"}};
                       {ppat_desc = Ppat_var {txt = "br"}}]},
                   {pexp_desc =
                     Pexp_construct ({txt = Lident "B"},
                      Some
                       {pexp_desc =
                         Pexp_record
                          ([({txt = Lident "tl_t"},
                             {pexp_desc = Pexp_ident {txt = Lident "tl"}});
                            ({txt = Lident "tr_t"},
                             {pexp_desc = Pexp_ident {txt = Lident "tr"}});
                            ({txt = Lident "bl_t"},
                             {pexp_desc = Pexp_ident {txt = Lident "bl"}});
                            ({txt = Lident "br_t"},
                             {pexp_desc = Pexp_ident {txt = Lident "br"}})],
                          None)})})}}])};
          {pstr_desc =
            Pstr_value (Nonrecursive,
             [{pvb_pat = {ppat_desc = Ppat_var {txt = "rgb"}};
               pvb_expr =
                {pexp_desc =
                  Pexp_fun (Nolabel, None,
                   {ppat_desc = Ppat_var {txt = "px"}},
                   {pexp_desc =
                     Pexp_record
                      ([({txt = Lident "r"},
                         {pexp_desc = Pexp_ident {txt = Lident "px"}});
                        ({txt = Lident "g"},
                         {pexp_desc = Pexp_ident {txt = Lident "px"}});
                        ({txt = Lident "b"},
                         {pexp_desc = Pexp_ident {txt = Lident "px"}})],
                      None)})}}])};
          {pstr_desc =
            Pstr_value (Recursive,
             [{pvb_pat = {ppat_desc = Ppat_var {txt = "merge"}};
               pvb_expr =
                {pexp_desc =
                  Pexp_fun (Nolabel, None,
                   {ppat_desc = Ppat_var {txt = "old"}},
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "v1"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "v2"}},
                         {pexp_desc =
                           Pexp_ifthenelse
                            ({pexp_desc =
                               Pexp_apply
                                ({pexp_desc = Pexp_ident {txt = Lident "="}},
                                [(Nolabel,
                                  {pexp_desc = Pexp_ident {txt = Lident "v1"}});
                                 (Nolabel,
                                  {pexp_desc = Pexp_ident {txt = Lident "v2"}})])},
                            {pexp_desc = Pexp_ident {txt = Lident "v1"}},
                            Some
                             {pexp_desc =
                               Pexp_ifthenelse
                                ({pexp_desc =
                                   Pexp_apply
                                    ({pexp_desc =
                                       Pexp_ident {txt = Lident "="}},
                                    [(Nolabel,
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "v1"}});
                                     (Nolabel,
                                      {pexp_desc =
                                        Pexp_ident {txt = Lident "old"}})])},
                                {pexp_desc = Pexp_ident {txt = Lident "v2"}},
                                Some
                                 {pexp_desc =
                                   Pexp_ifthenelse
                                    ({pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "="}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "v2"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "old"}})])},
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "v1"}},
                                    Some
                                     {pexp_desc =
                                       Pexp_match
                                        ({pexp_desc =
                                           Pexp_tuple
                                            [{pexp_desc =
                                               Pexp_ident
                                                {txt = Lident "old"}};
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "v1"}};
                                             {pexp_desc =
                                               Pexp_ident {txt = Lident "v2"}}]},
                                        [{pc_lhs =
                                           {ppat_desc =
                                             Ppat_tuple
                                              [{ppat_desc = Ppat_any};
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "B"},
                                                  Some {ppat_desc = Ppat_any})};
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "N"},
                                                  Some
                                                   {ppat_desc =
                                                     Ppat_var {txt = "px2"}})}]};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "@@"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "merge"}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "old"}});
                                                    (Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "v1"}})])});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "b_of_n"}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "px2"}})])})])}};
                                         {pc_lhs =
                                           {ppat_desc =
                                             Ppat_tuple
                                              [{ppat_desc = Ppat_any};
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "N"},
                                                  Some
                                                   {ppat_desc =
                                                     Ppat_var {txt = "px1"}})};
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "B"},
                                                  Some {ppat_desc = Ppat_any})}]};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "merge"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "old"}});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "b_of_n"}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "px1"}})])});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "v2"}})])}};
                                         {pc_lhs =
                                           {ppat_desc =
                                             Ppat_tuple
                                              [{ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "N"},
                                                  Some
                                                   {ppat_desc =
                                                     Ppat_var {txt = "px"}})};
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "B"},
                                                  Some {ppat_desc = Ppat_any})};
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "B"},
                                                  Some {ppat_desc = Ppat_any})}]};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt = Lident "merge"}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "b_of_n"}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "px"}})])});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "v1"}});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "v2"}})])}};
                                         {pc_lhs =
                                           {ppat_desc =
                                             Ppat_tuple
                                              [{ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "B"},
                                                  Some
                                                   {ppat_desc =
                                                     Ppat_var {txt = "x"}})};
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "B"},
                                                  Some
                                                   {ppat_desc =
                                                     Ppat_var {txt = "x1"}})};
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "B"},
                                                  Some
                                                   {ppat_desc =
                                                     Ppat_var {txt = "x2"}})}]};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_let (Nonrecursive,
                                              [{pvb_pat =
                                                 {ppat_desc =
                                                   Ppat_var {txt = "tl_t'"}};
                                                pvb_expr =
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "merge"}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_field
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "x"}},
                                                         {txt = Lident "tl_t"})});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_field
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "x1"}},
                                                         {txt = Lident "tl_t"})});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_field
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "x2"}},
                                                         {txt = Lident "tl_t"})})])}}],
                                              {pexp_desc =
                                                Pexp_let (Nonrecursive,
                                                 [{pvb_pat =
                                                    {ppat_desc =
                                                      Ppat_var
                                                       {txt = "tr_t'"}};
                                                   pvb_expr =
                                                    {pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "merge"}},
                                                       [(Nolabel,
                                                         {pexp_desc =
                                                           Pexp_field
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "x"}},
                                                            {txt =
                                                              Lident "tr_t"})});
                                                        (Nolabel,
                                                         {pexp_desc =
                                                           Pexp_field
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "x1"}},
                                                            {txt =
                                                              Lident "tr_t"})});
                                                        (Nolabel,
                                                         {pexp_desc =
                                                           Pexp_field
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident "x2"}},
                                                            {txt =
                                                              Lident "tr_t"})})])}}],
                                                 {pexp_desc =
                                                   Pexp_let (Nonrecursive,
                                                    [{pvb_pat =
                                                       {ppat_desc =
                                                         Ppat_var
                                                          {txt = "bl_t'"}};
                                                      pvb_expr =
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident
                                                                 "merge"}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_field
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "x"}},
                                                               {txt =
                                                                 Lident
                                                                  "bl_t"})});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_field
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "x1"}},
                                                               {txt =
                                                                 Lident
                                                                  "bl_t"})});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_field
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "x2"}},
                                                               {txt =
                                                                 Lident
                                                                  "bl_t"})})])}}],
                                                    {pexp_desc =
                                                      Pexp_let (Nonrecursive,
                                                       [{pvb_pat =
                                                          {ppat_desc =
                                                            Ppat_var
                                                             {txt = "br_t'"}};
                                                         pvb_expr =
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "merge"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_field
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}},
                                                                  {txt =
                                                                    Lident
                                                                    "br_t"})});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_field
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x1"}},
                                                                  {txt =
                                                                    Lident
                                                                    "br_t"})});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_field
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x2"}},
                                                                  {txt =
                                                                    Lident
                                                                    "br_t"})})])}}],
                                                       {pexp_desc =
                                                         Pexp_construct
                                                          ({txt = Lident "B"},
                                                          Some
                                                           {pexp_desc =
                                                             Pexp_record
                                                              ([({txt =
                                                                   Lident
                                                                    "tl_t"},
                                                                 {pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "tl_t'"}});
                                                                ({txt =
                                                                   Lident
                                                                    "tr_t"},
                                                                 {pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "tr_t'"}});
                                                                ({txt =
                                                                   Lident
                                                                    "bl_t"},
                                                                 {pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "bl_t'"}});
                                                                ({txt =
                                                                   Lident
                                                                    "br_t"},
                                                                 {pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "br_t'"}})],
                                                              None)})})})})})}};
                                         {pc_lhs =
                                           {ppat_desc =
                                             Ppat_tuple
                                              [{ppat_desc = Ppat_any};
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "N"},
                                                  Some
                                                   {ppat_desc =
                                                     Ppat_var {txt = "px1"}})};
                                               {ppat_desc =
                                                 Ppat_construct
                                                  ({txt = Lident "N"},
                                                  Some
                                                   {ppat_desc =
                                                     Ppat_var {txt = "px2"}})}]};
                                          pc_guard = None;
                                          pc_rhs =
                                           {pexp_desc =
                                             Pexp_let (Nonrecursive,
                                              [{pvb_pat =
                                                 {ppat_desc =
                                                   Ppat_var {txt = "px'"}};
                                                pvb_expr =
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Lident "color_mix"}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "px1"}});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "px2"}})])}}],
                                              {pexp_desc =
                                                Pexp_construct
                                                 ({txt = Lident "N"},
                                                 Some
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "px'"}})})}}])})})})})})})}}])};
          {pstr_desc =
            Pstr_value (Recursive,
             [{pvb_pat = {ppat_desc = Ppat_var {txt = "print"}};
               pvb_expr =
                {pexp_desc =
                  Pexp_fun (Nolabel, None,
                   {ppat_desc = Ppat_var {txt = "min_x"}},
                   {pexp_desc =
                     Pexp_fun (Nolabel, None,
                      {ppat_desc = Ppat_var {txt = "min_y"}},
                      {pexp_desc =
                        Pexp_fun (Nolabel, None,
                         {ppat_desc = Ppat_var {txt = "max_x"}},
                         {pexp_desc =
                           Pexp_fun (Nolabel, None,
                            {ppat_desc = Ppat_var {txt = "max_y"}},
                            {pexp_desc =
                              Pexp_fun (Nolabel, None,
                               {ppat_desc = Ppat_var {txt = "t"}},
                               {pexp_desc =
                                 Pexp_ifthenelse
                                  ({pexp_desc =
                                     Pexp_apply
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "||"}},
                                      [(Nolabel,
                                        {pexp_desc =
                                          Pexp_apply
                                           ({pexp_desc =
                                              Pexp_ident {txt = Lident ">"}},
                                           [(Nolabel,
                                             {pexp_desc =
                                               Pexp_ident
                                                {txt = Lident "min_x"}});
                                            (Nolabel,
                                             {pexp_desc =
                                               Pexp_ident
                                                {txt = Lident "max_x"}})])});
                                       (Nolabel,
                                        {pexp_desc =
                                          Pexp_apply
                                           ({pexp_desc =
                                              Pexp_ident {txt = Lident ">"}},
                                           [(Nolabel,
                                             {pexp_desc =
                                               Pexp_ident
                                                {txt = Lident "min_y"}});
                                            (Nolabel,
                                             {pexp_desc =
                                               Pexp_ident
                                                {txt = Lident "max_y"}})])})])},
                                  {pexp_desc =
                                    Pexp_construct ({txt = Lident "()"},
                                     None)},
                                  Some
                                   {pexp_desc =
                                     Pexp_match
                                      ({pexp_desc =
                                         Pexp_ident {txt = Lident "t"}},
                                      [{pc_lhs =
                                         {ppat_desc =
                                           Ppat_construct
                                            ({txt = Lident "N"},
                                            Some
                                             {ppat_desc =
                                               Ppat_var {txt = "px"}})};
                                        pc_guard =
                                         Some
                                          {pexp_desc =
                                            Pexp_apply
                                             ({pexp_desc =
                                                Pexp_ident
                                                 {txt = Lident "not"}},
                                             [(Nolabel,
                                               {pexp_desc =
                                                 Pexp_apply
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "="}},
                                                  [(Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "px"}});
                                                   (Nolabel,
                                                    {pexp_desc =
                                                      Pexp_ident
                                                       {txt =
                                                         Lident
                                                          "default_pixel"}})])})])};
                                        pc_rhs =
                                         {pexp_desc =
                                           Pexp_ifthenelse
                                            ({pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "&&"}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_apply
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "="}},
                                                     [(Nolabel,
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "min_x"}});
                                                      (Nolabel,
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "max_x"}})])});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_apply
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "="}},
                                                     [(Nolabel,
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "min_y"}});
                                                      (Nolabel,
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "max_y"}})])})])},
                                            {pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt =
                                                     Ldot (Lident "Printf",
                                                      "printf")}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_constant
                                                    (Pconst_string
                                                      ("<%d,%d>: (%d,%d,%d)\n",
                                                      None))});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "min_x"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "min_y"}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Ldot
                                                           (Lident "Char",
                                                           "code")}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_field
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "px"}},
                                                         {txt = Lident "r"})})])});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Ldot
                                                           (Lident "Char",
                                                           "code")}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_field
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "px"}},
                                                         {txt = Lident "g"})})])});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Ldot
                                                           (Lident "Char",
                                                           "code")}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_field
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "px"}},
                                                         {txt = Lident "b"})})])})])},
                                            Some
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt =
                                                      Ldot (Lident "Printf",
                                                       "printf")}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_constant
                                                     (Pconst_string
                                                       ("<%d,%d> to <%d,%d>: (%d,%d,%d)\n",
                                                       None))});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "min_x"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "min_y"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "max_x"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "max_y"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_apply
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Ldot
                                                            (Lident "Char",
                                                            "code")}},
                                                     [(Nolabel,
                                                       {pexp_desc =
                                                         Pexp_field
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "px"}},
                                                          {txt = Lident "r"})})])});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_apply
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Ldot
                                                            (Lident "Char",
                                                            "code")}},
                                                     [(Nolabel,
                                                       {pexp_desc =
                                                         Pexp_field
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "px"}},
                                                          {txt = Lident "g"})})])});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_apply
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Ldot
                                                            (Lident "Char",
                                                            "code")}},
                                                     [(Nolabel,
                                                       {pexp_desc =
                                                         Pexp_field
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "px"}},
                                                          {txt = Lident "b"})})])})])})}};
                                       {pc_lhs =
                                         {ppat_desc =
                                           Ppat_construct
                                            ({txt = Lident "N"},
                                            Some
                                             {ppat_desc =
                                               Ppat_var {txt = "px"}})};
                                        pc_guard = None;
                                        pc_rhs =
                                         {pexp_desc =
                                           Pexp_construct
                                            ({txt = Lident "()"}, None)}};
                                       {pc_lhs =
                                         {ppat_desc =
                                           Ppat_construct
                                            ({txt = Lident "B"},
                                            Some
                                             {ppat_desc =
                                               Ppat_record
                                                ([({txt = Lident "tl_t"},
                                                   {ppat_desc =
                                                     Ppat_var {txt = "tl_t"}});
                                                  ({txt = Lident "tr_t"},
                                                   {ppat_desc =
                                                     Ppat_var {txt = "tr_t"}});
                                                  ({txt = Lident "bl_t"},
                                                   {ppat_desc =
                                                     Ppat_var {txt = "bl_t"}});
                                                  ({txt = Lident "br_t"},
                                                   {ppat_desc =
                                                     Ppat_var {txt = "br_t"}})],
                                                Closed)})};
                                        pc_guard = None;
                                        pc_rhs =
                                         {pexp_desc =
                                           Pexp_let (Nonrecursive,
                                            [{pvb_pat =
                                               {ppat_desc =
                                                 Ppat_tuple
                                                  [{ppat_desc =
                                                     Ppat_var {txt = "mid_x"}};
                                                   {ppat_desc =
                                                     Ppat_var {txt = "mid_y"}}]};
                                              pvb_expr =
                                               {pexp_desc =
                                                 Pexp_tuple
                                                  [{pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident "+"}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "min_x"}});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "/"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_apply
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                [(Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "max_x"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "min_x"}})])});
                                                                 (Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_constant
                                                                (Pconst_integer
                                                                  ("2", None))})])})])};
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident "+"}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "min_y"}});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "/"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_apply
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                [(Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "-"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "max_y"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "min_y"}})])});
                                                                 (Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_constant
                                                                (Pconst_integer
                                                                  ("2", None))})])})])}]}}],
                                            {pexp_desc =
                                              Pexp_sequence
                                               ({pexp_desc =
                                                  Pexp_apply
                                                   ({pexp_desc =
                                                      Pexp_ident
                                                       {txt = Lident "print"}},
                                                   [(Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "min_x"}});
                                                    (Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "min_y"}});
                                                    (Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "mid_x"}});
                                                    (Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "mid_y"}});
                                                    (Nolabel,
                                                     {pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "tl_t"}})])},
                                               {pexp_desc =
                                                 Pexp_sequence
                                                  ({pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident "print"}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "+"}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "mid_x"}});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_constant
                                                                (Pconst_integer
                                                                  ("1", None))})])});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "min_y"}});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "max_x"}});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "mid_y"}});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident "tr_t"}})])},
                                                  {pexp_desc =
                                                    Pexp_sequence
                                                     ({pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "print"}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident
                                                                 "min_x"}});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "+"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "mid_y"}});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_constant
                                                                   (Pconst_integer
                                                                    ("1",
                                                                    None))})])});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident
                                                                 "mid_x"}});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident
                                                                 "max_y"}});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "bl_t"}})])},
                                                     {pexp_desc =
                                                       Pexp_apply
                                                        ({pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident "print"}},
                                                        [(Nolabel,
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident "+"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "mid_x"}});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_constant
                                                                  (Pconst_integer
                                                                    ("1",
                                                                    None))})])});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident "+"}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "mid_y"}});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_constant
                                                                  (Pconst_integer
                                                                    ("1",
                                                                    None))})])});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "max_x"}});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "max_y"}});
                                                         (Nolabel,
                                                          {pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "br_t"}})])})})})})}}])})})})})})})}}])};
          {pstr_desc =
            Pstr_value (Nonrecursive,
             [{pvb_pat = {ppat_desc = Ppat_var {txt = "print"}};
               pvb_expr =
                {pexp_desc =
                  Pexp_fun (Nolabel, None,
                   {ppat_desc =
                     Ppat_record
                      ([({txt = Lident "max_x"},
                         {ppat_desc = Ppat_var {txt = "max_x"}});
                        ({txt = Lident "max_y"},
                         {ppat_desc = Ppat_var {txt = "max_y"}});
                        ({txt = Lident "t"},
                         {ppat_desc = Ppat_var {txt = "t"}})],
                      Closed)},
                   {pexp_desc =
                     Pexp_apply
                      ({pexp_desc = Pexp_ident {txt = Lident "print"}},
                      [(Nolabel,
                        {pexp_desc =
                          Pexp_constant (Pconst_integer ("0", None))});
                       (Nolabel,
                        {pexp_desc =
                          Pexp_constant (Pconst_integer ("0", None))});
                       (Nolabel,
                        {pexp_desc = Pexp_ident {txt = Lident "max_x"}});
                       (Nolabel,
                        {pexp_desc = Pexp_ident {txt = Lident "max_y"}});
                       (Nolabel, {pexp_desc = Pexp_ident {txt = Lident "t"}})])})}}])};
          {pstr_desc =
            Pstr_value (Nonrecursive,
             [{pvb_pat = {ppat_desc = Ppat_var {txt = "print"}};
               pvb_expr =
                {pexp_desc =
                  Pexp_fun (Nolabel, None,
                   {ppat_desc = Ppat_var {txt = "c"}},
                   {pexp_desc =
                     Pexp_for ({ppat_desc = Ppat_var {txt = "x"}},
                      {pexp_desc = Pexp_constant (Pconst_integer ("1", None))},
                      {pexp_desc =
                        Pexp_field
                         ({pexp_desc = Pexp_ident {txt = Lident "c"}},
                         {txt = Lident "max_x"})},
                      Upto,
                      {pexp_desc =
                        Pexp_for ({ppat_desc = Ppat_var {txt = "y"}},
                         {pexp_desc =
                           Pexp_constant (Pconst_integer ("1", None))},
                         {pexp_desc =
                           Pexp_field
                            ({pexp_desc = Pexp_ident {txt = Lident "c"}},
                            {txt = Lident "max_y"})},
                         Upto,
                         {pexp_desc =
                           Pexp_let (Nonrecursive,
                            [{pvb_pat = {ppat_desc = Ppat_var {txt = "px"}};
                              pvb_expr =
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident {txt = Lident "get_px"}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "c"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_record
                                       ([({txt = Lident "x"},
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "x"}});
                                         ({txt = Lident "y"},
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "y"}})],
                                       None)})])}}],
                            {pexp_desc =
                              Pexp_ifthenelse
                               ({pexp_desc =
                                  Pexp_apply
                                   ({pexp_desc =
                                      Pexp_ident {txt = Lident "not"}},
                                   [(Nolabel,
                                     {pexp_desc =
                                       Pexp_apply
                                        ({pexp_desc =
                                           Pexp_ident {txt = Lident "="}},
                                        [(Nolabel,
                                          {pexp_desc =
                                            Pexp_ident {txt = Lident "px"}});
                                         (Nolabel,
                                          {pexp_desc =
                                            Pexp_ident
                                             {txt = Lident "default_pixel"}})])})])},
                               {pexp_desc =
                                 Pexp_apply
                                  ({pexp_desc =
                                     Pexp_ident
                                      {txt = Ldot (Lident "Printf", "printf")}},
                                  [(Nolabel,
                                    {pexp_desc =
                                      Pexp_constant
                                       (Pconst_string
                                         ("<%d,%d>: (%d,%d,%d)\n", None))});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "x"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_ident {txt = Lident "y"}});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_apply
                                       ({pexp_desc =
                                          Pexp_ident
                                           {txt =
                                             Ldot (Lident "Char", "code")}},
                                       [(Nolabel,
                                         {pexp_desc =
                                           Pexp_field
                                            ({pexp_desc =
                                               Pexp_ident {txt = Lident "px"}},
                                            {txt = Lident "r"})})])});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_apply
                                       ({pexp_desc =
                                          Pexp_ident
                                           {txt =
                                             Ldot (Lident "Char", "code")}},
                                       [(Nolabel,
                                         {pexp_desc =
                                           Pexp_field
                                            ({pexp_desc =
                                               Pexp_ident {txt = Lident "px"}},
                                            {txt = Lident "g"})})])});
                                   (Nolabel,
                                    {pexp_desc =
                                      Pexp_apply
                                       ({pexp_desc =
                                          Pexp_ident
                                           {txt =
                                             Ldot (Lident "Char", "code")}},
                                       [(Nolabel,
                                         {pexp_desc =
                                           Pexp_field
                                            ({pexp_desc =
                                               Pexp_ident {txt = Lident "px"}},
                                            {txt = Lident "b"})})])})])},
                               Some
                                {pexp_desc =
                                  Pexp_construct ({txt = Lident "()"}, None)})})})})})}}])}]};
     pmb_attributes = [({txt = "derive_versioned"}, PStr [])]}};
 {pstr_desc =
   Pstr_module
    {pmb_name = {txt = "ICanvas"};
     pmb_expr =
      {pmod_desc =
        Pmod_structure
         [{pstr_desc =
            Pstr_open
             {popen_lid = {txt = Ldot (Lident "Lwt", "Infix")};
              popen_override = Fresh}};
          {pstr_desc =
            Pstr_open
             {popen_lid = {txt = Lident "Irmin_unix"};
              popen_override = Fresh}};
          {pstr_desc =
            Pstr_modtype
             {pmtd_name = {txt = "Config"};
              pmtd_type =
               Some
                {pmty_desc =
                  Pmty_signature
                   [{psig_desc =
                      Psig_value
                       {pval_name = {txt = "root"};
                        pval_type =
                         {ptyp_desc =
                           Ptyp_constr ({txt = Lident "string"}, [])};
                        pval_prim = []}};
                    {psig_desc =
                      Psig_value
                       {pval_name = {txt = "shared"};
                        pval_type =
                         {ptyp_desc =
                           Ptyp_constr ({txt = Lident "string"}, [])};
                        pval_prim = []}};
                    {psig_desc =
                      Psig_value
                       {pval_name = {txt = "init"};
                        pval_type =
                         {ptyp_desc =
                           Ptyp_arrow (Nolabel,
                            {ptyp_desc =
                              Ptyp_constr ({txt = Lident "unit"}, [])},
                            {ptyp_desc =
                              Ptyp_constr ({txt = Lident "unit"}, [])})};
                        pval_prim = []}}]}}};
          {pstr_desc =
            Pstr_module
             {pmb_name = {txt = "MakeVersioned"};
              pmb_expr =
               {pmod_desc =
                 Pmod_functor ({txt = "Config"},
                  Some {pmty_desc = Pmty_ident {txt = Lident "Config"}},
                  {pmod_desc =
                    Pmod_structure
                     [{pstr_desc =
                        Pstr_module
                         {pmb_name = {txt = "OM"};
                          pmb_expr =
                           {pmod_desc =
                             Pmod_ident
                              {txt = Ldot (Lident "Canvas", "Make")}}}};
                      {pstr_desc =
                        Pstr_module
                         {pmb_name = {txt = "K"};
                          pmb_expr =
                           {pmod_desc =
                             Pmod_ident
                              {txt =
                                Ldot (Ldot (Lident "Irmin", "Hash"), "SHA1")}}}};
                      {pstr_desc =
                        Pstr_value (Nonrecursive,
                         [{pvb_pat =
                            {ppat_desc = Ppat_var {txt = "from_just"}};
                           pvb_expr =
                            {pexp_desc =
                              Pexp_function
                               [{pc_lhs =
                                  {ppat_desc =
                                    Ppat_construct ({txt = Lident "Some"},
                                     Some {ppat_desc = Ppat_var {txt = "x"}})};
                                 pc_guard = None;
                                 pc_rhs =
                                  {pexp_desc = Pexp_ident {txt = Lident "x"}}};
                                {pc_lhs =
                                  {ppat_desc =
                                    Ppat_construct ({txt = Lident "None"},
                                     None)};
                                 pc_guard = None;
                                 pc_rhs =
                                  {pexp_desc =
                                    Pexp_apply
                                     ({pexp_desc =
                                        Pexp_ident {txt = Lident "failwith"}},
                                     [(Nolabel,
                                       {pexp_desc =
                                         Pexp_constant
                                          (Pconst_string
                                            ("Expected Some. Got None.",
                                            None))})])}}]}}])};
                      {pstr_desc =
                        Pstr_type (Recursive,
                         [{ptype_name = {txt = "vpixel"}; ptype_params = [];
                           ptype_cstrs = [];
                           ptype_kind =
                            Ptype_record
                             [{pld_name = {txt = "r"};
                               pld_mutable = Immutable;
                               pld_type =
                                {ptyp_desc =
                                  Ptyp_constr ({txt = Lident "char"}, [])}};
                              {pld_name = {txt = "g"};
                               pld_mutable = Immutable;
                               pld_type =
                                {ptyp_desc =
                                  Ptyp_constr ({txt = Lident "char"}, [])}};
                              {pld_name = {txt = "b"};
                               pld_mutable = Immutable;
                               pld_type =
                                {ptyp_desc =
                                  Ptyp_constr ({txt = Lident "char"}, [])}}];
                           ptype_private = Public; ptype_manifest = None}])};
                      {pstr_desc =
                        Pstr_type (Recursive,
                         [{ptype_name = {txt = "vnode"}; ptype_params = [];
                           ptype_cstrs = [];
                           ptype_kind =
                            Ptype_record
                             [{pld_name = {txt = "tl_t"};
                               pld_mutable = Immutable;
                               pld_type =
                                {ptyp_desc =
                                  Ptyp_constr
                                   ({txt = Ldot (Lident "K", "t")}, [])}};
                              {pld_name = {txt = "tr_t"};
                               pld_mutable = Immutable;
                               pld_type =
                                {ptyp_desc =
                                  Ptyp_constr
                                   ({txt = Ldot (Lident "K", "t")}, [])}};
                              {pld_name = {txt = "bl_t"};
                               pld_mutable = Immutable;
                               pld_type =
                                {ptyp_desc =
                                  Ptyp_constr
                                   ({txt = Ldot (Lident "K", "t")}, [])}};
                              {pld_name = {txt = "br_t"};
                               pld_mutable = Immutable;
                               pld_type =
                                {ptyp_desc =
                                  Ptyp_constr
                                   ({txt = Ldot (Lident "K", "t")}, [])}}];
                           ptype_private = Public; ptype_manifest = None}])};
                      {pstr_desc =
                        Pstr_type (Recursive,
                         [{ptype_name = {txt = "vt"}; ptype_params = [];
                           ptype_cstrs = [];
                           ptype_kind =
                            Ptype_variant
                             [{pcd_name = {txt = "N"};
                               pcd_args =
                                Pcstr_tuple
                                 [{ptyp_desc =
                                    Ptyp_constr ({txt = Lident "vpixel"}, [])}];
                               pcd_res = None};
                              {pcd_name = {txt = "B"};
                               pcd_args =
                                Pcstr_tuple
                                 [{ptyp_desc =
                                    Ptyp_constr ({txt = Lident "vnode"}, [])}];
                               pcd_res = None}];
                           ptype_private = Public; ptype_manifest = None}])};
                      {pstr_desc =
                        Pstr_type (Recursive,
                         [{ptype_name = {txt = "vcanvas"}; ptype_params = [];
                           ptype_cstrs = [];
                           ptype_kind =
                            Ptype_record
                             [{pld_name = {txt = "max_x"};
                               pld_mutable = Immutable;
                               pld_type =
                                {ptyp_desc =
                                  Ptyp_constr ({txt = Lident "int64"}, [])}};
                              {pld_name = {txt = "max_y"};
                               pld_mutable = Immutable;
                               pld_type =
                                {ptyp_desc =
                                  Ptyp_constr ({txt = Lident "int64"}, [])}};
                              {pld_name = {txt = "vt"};
                               pld_mutable = Immutable;
                               pld_type =
                                {ptyp_desc =
                                  Ptyp_constr ({txt = Lident "vt"}, [])}}];
                           ptype_private = Public; ptype_manifest = None}])};
                      {pstr_desc =
                        Pstr_type (Recursive,
                         [{ptype_name = {txt = "vloc"}; ptype_params = [];
                           ptype_cstrs = [];
                           ptype_kind =
                            Ptype_record
                             [{pld_name = {txt = "x"};
                               pld_mutable = Immutable;
                               pld_type =
                                {ptyp_desc =
                                  Ptyp_constr ({txt = Lident "int64"}, [])}};
                              {pld_name = {txt = "y"};
                               pld_mutable = Immutable;
                               pld_type =
                                {ptyp_desc =
                                  Ptyp_constr ({txt = Lident "int64"}, [])}}];
                           ptype_private = Public; ptype_manifest = None}])};
                      {pstr_desc =
                        Pstr_module
                         {pmb_name = {txt = "M"};
                          pmb_expr =
                           {pmod_desc =
                             Pmod_structure
                              [{pstr_desc =
                                 Pstr_module
                                  {pmb_name = {txt = "AO_value"};
                                   pmb_expr =
                                    {pmod_desc =
                                      Pmod_structure
                                       [{pstr_desc =
                                          Pstr_type (Recursive,
                                           [{ptype_name = {txt = "t"};
                                             ptype_params = [];
                                             ptype_cstrs = [];
                                             ptype_kind = Ptype_abstract;
                                             ptype_private = Public;
                                             ptype_manifest =
                                              Some
                                               {ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt = Lident "vt"}, 
                                                  [])}}])};
                                        {pstr_desc =
                                          Pstr_value (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "vpixel"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_open (Fresh,
                                                 {txt =
                                                   Ldot (Lident "Irmin",
                                                    "Type")},
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "|>"}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "|+"}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "|+"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "|+"}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "record"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("vpixel",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "r"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "g"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "b"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "r"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "r"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "g"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "g"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "b"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}})],
                                                                    None)})})})})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "field"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("r",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Ldot
                                                                    (Lident
                                                                    "Irmin",
                                                                    "Type"),
                                                                    "char")}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                    {txt =
                                                                    Lident
                                                                    "r"})})})])})])});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "field"}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("g",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Ldot
                                                                    (Lident
                                                                    "Irmin",
                                                                    "Type"),
                                                                    "char")}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                    {txt =
                                                                    Lident
                                                                    "g"})})})])})])});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "field"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_constant
                                                                   (Pconst_string
                                                                    ("b",
                                                                    None))});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Ldot
                                                                    (Ldot
                                                                    (Lident
                                                                    "Irmin",
                                                                    "Type"),
                                                                    "char")}});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_fun
                                                                   (Nolabel,
                                                                   None,
                                                                   {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t"}},
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                    {txt =
                                                                    Lident
                                                                    "b"})})})])})])});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Lident "sealr"}})])})}}])};
                                        {pstr_desc =
                                          Pstr_value (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "vnode"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_open (Fresh,
                                                 {txt =
                                                   Ldot (Lident "Irmin",
                                                    "Type")},
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "|>"}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "|+"}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "|+"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "|+"}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "|+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "record"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("vnode",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "tl_t"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "tr_t"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "bl_t"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "br_t"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "tl_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "tl_t"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "tr_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "tr_t"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "bl_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "bl_t"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "br_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "br_t"}})],
                                                                    None)})})})})})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "field"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("tl_t",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "K", "t")}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                    {txt =
                                                                    Lident
                                                                    "tl_t"})})})])})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "field"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("tr_t",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "K", "t")}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                    {txt =
                                                                    Lident
                                                                    "tr_t"})})})])})])});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "field"}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("bl_t",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "K", "t")}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                    {txt =
                                                                    Lident
                                                                    "bl_t"})})})])})])});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "field"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_constant
                                                                   (Pconst_string
                                                                    ("br_t",
                                                                    None))});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "K", "t")}});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_fun
                                                                   (Nolabel,
                                                                   None,
                                                                   {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t"}},
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                    {txt =
                                                                    Lident
                                                                    "br_t"})})})])})])});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Lident "sealr"}})])})}}])};
                                        {pstr_desc =
                                          Pstr_value (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "t"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_open (Fresh,
                                                 {txt =
                                                   Ldot (Lident "Irmin",
                                                    "Type")},
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "|>"}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "|~"}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "|~"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "variant"}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("t",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "vp"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "np"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_function
                                                                    [{pc_lhs
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v"}})};
                                                                    pc_guard
                                                                    = None;
                                                                    pc_rhs =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "vp"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}})])}};
                                                                    {pc_lhs =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "B"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "n"}})};
                                                                    pc_guard
                                                                    = None;
                                                                    pc_rhs =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "np"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "n"}})])}}]})})})])});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "case1"}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("N",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "vpixel"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "x"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}})})})])})])});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "case1"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_constant
                                                                   (Pconst_string
                                                                    ("B",
                                                                    None))});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "vnode"}});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_fun
                                                                   (Nolabel,
                                                                   None,
                                                                   {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "x"}},
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "B"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}})})})])})])});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Lident "sealv"}})])})}}])};
                                        {pstr_desc =
                                          Pstr_value (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "vcanvas"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_open (Fresh,
                                                 {txt =
                                                   Ldot (Lident "Irmin",
                                                    "Type")},
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "|>"}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "|+"}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "|+"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "|+"}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "record"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("vcanvas",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "max_x"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "max_y"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "vt"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "max_x"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "max_x"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "max_y"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "max_y"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "vt"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "vt"}})],
                                                                    None)})})})})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "field"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("max_x",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "int64"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                    {txt =
                                                                    Lident
                                                                    "max_x"})})})])})])});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "field"}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("max_y",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "int64"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                    {txt =
                                                                    Lident
                                                                    "max_y"})})})])})])});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "field"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_constant
                                                                   (Pconst_string
                                                                    ("vt",
                                                                    None))});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "t"}});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_fun
                                                                   (Nolabel,
                                                                   None,
                                                                   {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t"}},
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                    {txt =
                                                                    Lident
                                                                    "vt"})})})])})])});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Lident "sealr"}})])})}}])};
                                        {pstr_desc =
                                          Pstr_value (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "vloc"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_open (Fresh,
                                                 {txt =
                                                   Ldot (Lident "Irmin",
                                                    "Type")},
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "|>"}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "|+"}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "|+"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "record"}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("vloc",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "x"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "y"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "x"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "x"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "y"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "y"}})],
                                                                    None)})})})])});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "field"}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("x",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "int64"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                    {txt =
                                                                    Lident
                                                                    "x"})})})])})])});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "field"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_constant
                                                                   (Pconst_string
                                                                    ("y",
                                                                    None))});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "int64"}});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_fun
                                                                   (Nolabel,
                                                                   None,
                                                                   {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t"}},
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                    {txt =
                                                                    Lident
                                                                    "y"})})})])})])});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Lident "sealr"}})])})}}])};
                                        {pstr_desc =
                                          Pstr_value (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "pp"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt =
                                                       Ldot
                                                        (Ldot
                                                          (Lident "Irmin",
                                                          "Type"),
                                                        "pp_json")}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "t"}})])}}])};
                                        {pstr_desc =
                                          Pstr_value (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "of_string"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_fun (Nolabel, None,
                                                 {ppat_desc =
                                                   Ppat_var {txt = "s"}},
                                                 {pexp_desc =
                                                   Pexp_let (Nonrecursive,
                                                    [{pvb_pat =
                                                       {ppat_desc =
                                                         Ppat_var
                                                          {txt = "decoder"}};
                                                      pvb_expr =
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Ldot
                                                                 (Lident
                                                                   "Jsonm",
                                                                 "decoder")}},
                                                          [(Nolabel,
                                                            {pexp_desc =
                                                              Pexp_variant
                                                               ("String",
                                                               Some
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "s"}})})])}}],
                                                    {pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Ldot
                                                              (Ldot
                                                                (Lident
                                                                  "Irmin",
                                                                "Type"),
                                                              "decode_json")}},
                                                       [(Nolabel,
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt = Lident "t"}});
                                                        (Nolabel,
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Lident
                                                               "decoder"}})])})})}}])}]}}};
                               {pstr_desc =
                                 Pstr_module
                                  {pmb_name = {txt = "AO_store"};
                                   pmb_expr =
                                    {pmod_desc =
                                      Pmod_structure
                                       [{pstr_desc =
                                          Pstr_module
                                           {pmb_name = {txt = "S"};
                                            pmb_expr =
                                             {pmod_desc =
                                               Pmod_apply
                                                ({pmod_desc =
                                                   Pmod_apply
                                                    ({pmod_desc =
                                                       Pmod_ident
                                                        {txt =
                                                          Ldot
                                                           (Lident
                                                             "Irmin_git",
                                                           "AO")}},
                                                    {pmod_desc =
                                                      Pmod_ident
                                                       {txt =
                                                         Ldot
                                                          (Lident "Git_unix",
                                                          "FS")}})},
                                                {pmod_desc =
                                                  Pmod_ident
                                                   {txt = Lident "AO_value"}})}}};
                                        {pstr_desc =
                                          Pstr_include
                                           {pincl_mod =
                                             {pmod_desc =
                                               Pmod_ident {txt = Lident "S"}}}};
                                        {pstr_desc =
                                          Pstr_value (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "create"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_fun (Nolabel, None,
                                                 {ppat_desc =
                                                   Ppat_var {txt = "config"}},
                                                 {pexp_desc =
                                                   Pexp_let (Nonrecursive,
                                                    [{pvb_pat =
                                                       {ppat_desc =
                                                         Ppat_var
                                                          {txt = "level"}};
                                                      pvb_expr =
                                                       {pexp_desc =
                                                         Pexp_apply
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Ldot
                                                                 (Ldot
                                                                   (Ldot
                                                                    (Lident
                                                                    "Irmin",
                                                                    "Private"),
                                                                   "Conf"),
                                                                 "key")}},
                                                          [(Labelled "doc",
                                                            {pexp_desc =
                                                              Pexp_constant
                                                               (Pconst_string
                                                                 ("The Zlib compression level.",
                                                                 None))});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_constant
                                                               (Pconst_string
                                                                 ("level",
                                                                 None))});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_open
                                                               (Fresh,
                                                               {txt =
                                                                 Ldot
                                                                  (Ldot
                                                                    (
                                                                    Lident
                                                                    "Irmin",
                                                                    "Private"),
                                                                  "Conf")},
                                                               {pexp_desc =
                                                                 Pexp_apply
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "some"}},
                                                                  [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "int"}})])})});
                                                           (Nolabel,
                                                            {pexp_desc =
                                                              Pexp_construct
                                                               ({txt =
                                                                  Lident
                                                                   "None"},
                                                               None)})])}}],
                                                    {pexp_desc =
                                                      Pexp_let (Nonrecursive,
                                                       [{pvb_pat =
                                                          {ppat_desc =
                                                            Ppat_var
                                                             {txt = "root"}};
                                                         pvb_expr =
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Ldot
                                                                    (
                                                                    Ldot
                                                                    (Ldot
                                                                    (Lident
                                                                    "Irmin",
                                                                    "Private"),
                                                                    "Conf"),
                                                                    "get")}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "config"}});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Ldot
                                                                    (Ldot
                                                                    (Ldot
                                                                    (Lident
                                                                    "Irmin",
                                                                    "Private"),
                                                                    "Conf"),
                                                                    "root")}})])}}],
                                                       {pexp_desc =
                                                         Pexp_let
                                                          (Nonrecursive,
                                                          [{pvb_pat =
                                                             {ppat_desc =
                                                               Ppat_var
                                                                {txt =
                                                                  "level"}};
                                                            pvb_expr =
                                                             {pexp_desc =
                                                               Pexp_apply
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Ldot
                                                                    (Ldot
                                                                    (Lident
                                                                    "Irmin",
                                                                    "Private"),
                                                                    "Conf"),
                                                                    "get")}},
                                                                [(Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "config"}});
                                                                 (Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "level"}})])}}],
                                                          {pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Ldot
                                                                    (
                                                                    Ldot
                                                                    (Lident
                                                                    "Git_unix",
                                                                    "FS"),
                                                                    "create")}},
                                                             [(Optional
                                                                "root",
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "root"}});
                                                              (Optional
                                                                "level",
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "level"}});
                                                              (Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_construct
                                                                  ({txt =
                                                                    Lident
                                                                    "()"},
                                                                  None)})])})})})})}}])};
                                        {pstr_desc =
                                          Pstr_value (Nonrecursive,
                                           [{pvb_pat =
                                              {ppat_desc =
                                                Ppat_var {txt = "create"}};
                                             pvb_expr =
                                              {pexp_desc =
                                                Pexp_fun (Nolabel, None,
                                                 {ppat_desc =
                                                   Ppat_construct
                                                    ({txt = Lident "()"},
                                                    None)},
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident "@@"}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Lident "create"}});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Ldot
                                                                (Lident
                                                                  "Irmin_git",
                                                                "config")}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Ldot
                                                                 (Lident
                                                                   "Config",
                                                                 "shared")}})])})])})}}])}]}}};
                               {pstr_desc =
                                 Pstr_type (Recursive,
                                  [{ptype_name = {txt = "t"};
                                    ptype_params = []; ptype_cstrs = [];
                                    ptype_kind = Ptype_abstract;
                                    ptype_private = Public;
                                    ptype_manifest =
                                     Some
                                      {ptyp_desc =
                                        Ptyp_constr
                                         ({txt = Ldot (Lident "K", "t")}, 
                                         [])}}])};
                               {pstr_desc =
                                 Pstr_value (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc =
                                       Ppat_var {txt = "default_pixel"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_record
                                        ([({txt = Lident "r"},
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt =
                                                    Ldot (Lident "Char",
                                                     "chr")}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_constant
                                                   (Pconst_integer ("255",
                                                     None))})])});
                                          ({txt = Lident "g"},
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt =
                                                    Ldot (Lident "Char",
                                                     "chr")}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_constant
                                                   (Pconst_integer ("255",
                                                     None))})])});
                                          ({txt = Lident "b"},
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt =
                                                    Ldot (Lident "Char",
                                                     "chr")}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_constant
                                                   (Pconst_integer ("255",
                                                     None))})])})],
                                        None)}}])};
                               {pstr_desc =
                                 Pstr_value (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "blank"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_construct ({txt = Lident "N"},
                                        Some
                                         {pexp_desc =
                                           Pexp_ident
                                            {txt = Lident "default_pixel"}})}}])};
                               {pstr_desc =
                                 Pstr_value (Recursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "of_adt"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc =
                                          Ppat_constraint
                                           ({ppat_desc = Ppat_var {txt = "a"}},
                                           {ptyp_desc =
                                             Ptyp_constr
                                              ({txt = Ldot (Lident "OM", "t")},
                                              [])})},
                                        {pexp_desc =
                                          Pexp_constraint
                                           ({pexp_desc =
                                              Pexp_let (Nonrecursive,
                                               [{pvb_pat =
                                                  {ppat_desc =
                                                    Ppat_var
                                                     {txt = "aostore"}};
                                                 pvb_expr =
                                                  {pexp_desc =
                                                    Pexp_apply
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Ldot
                                                            (Lident
                                                              "AO_store",
                                                            "create")}},
                                                     [(Nolabel,
                                                       {pexp_desc =
                                                         Pexp_construct
                                                          ({txt = Lident "()"},
                                                          None)})])}}],
                                               {pexp_desc =
                                                 Pexp_let (Nonrecursive,
                                                  [{pvb_pat =
                                                     {ppat_desc =
                                                       Ppat_var
                                                        {txt = "aostore_add"}};
                                                    pvb_expr =
                                                     {pexp_desc =
                                                       Pexp_fun (Nolabel,
                                                        None,
                                                        {ppat_desc =
                                                          Ppat_var
                                                           {txt = "value"}},
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident ">>="}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "aostore"}});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_fun
                                                                (Nolabel,
                                                                None,
                                                                {ppat_desc =
                                                                  Ppat_var
                                                                   {txt =
                                                                    "ao_store"}},
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "AO_store",
                                                                    "add")}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "ao_store"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "value"}})])})})])})}}],
                                                  {pexp_desc =
                                                    Pexp_apply
                                                     ({pexp_desc =
                                                        Pexp_ident
                                                         {txt = Lident "=<<"}},
                                                     [(Nolabel,
                                                       {pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Lident
                                                             "aostore_add"}});
                                                      (Nolabel,
                                                       {pexp_desc =
                                                         Pexp_match
                                                          ({pexp_desc =
                                                             Pexp_ident
                                                              {txt =
                                                                Lident "a"}},
                                                          [{pc_lhs =
                                                             {ppat_desc =
                                                               Ppat_construct
                                                                ({txt =
                                                                   Ldot
                                                                    (
                                                                    Lident
                                                                    "OM",
                                                                    "N")},
                                                                Some
                                                                 {ppat_desc =
                                                                   Ppat_record
                                                                    (
                                                                    [({txt =
                                                                    Lident
                                                                    "r"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "r"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "g"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "g"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "b"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "b"}})],
                                                                    Closed)})};
                                                            pc_guard = None;
                                                            pc_rhs =
                                                             {pexp_desc =
                                                               Pexp_apply
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "@@"}},
                                                                [(Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}});
                                                                 (Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "r"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "r"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "g"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "g"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "b"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}})],
                                                                    None)})})])}};
                                                           {pc_lhs =
                                                             {ppat_desc =
                                                               Ppat_construct
                                                                ({txt =
                                                                   Ldot
                                                                    (
                                                                    Lident
                                                                    "OM",
                                                                    "B")},
                                                                Some
                                                                 {ppat_desc =
                                                                   Ppat_record
                                                                    (
                                                                    [({txt =
                                                                    Lident
                                                                    "tl_t"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "tl_t"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "tr_t"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "tr_t"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "bl_t"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "bl_t"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "br_t"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "br_t"}})],
                                                                    Closed)})};
                                                            pc_guard = None;
                                                            pc_rhs =
                                                             {pexp_desc =
                                                               Pexp_apply
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                [(Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "of_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "tl_t"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "tl_t'"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "of_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "tr_t"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "tr_t'"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "of_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "bl_t"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "bl_t'"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "of_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "br_t"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "br_t'"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "tl_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "tl_t'"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "tr_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "tr_t'"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "bl_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "bl_t'"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "br_t"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "br_t'"}})],
                                                                    None)})])})})])})})])})})])})})])});
                                                                 (Nolabel,
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "n"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "@@"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "B"},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "n"}})})])})})])}}])})])})})},
                                           {ptyp_desc =
                                             Ptyp_constr
                                              ({txt =
                                                 Ldot (Lident "Lwt", "t")},
                                              [{ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt = Lident "t"}, 
                                                  [])}])})})}}])};
                               {pstr_desc =
                                 Pstr_value (Recursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "to_adt"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc =
                                          Ppat_constraint
                                           ({ppat_desc = Ppat_var {txt = "k"}},
                                           {ptyp_desc =
                                             Ptyp_constr ({txt = Lident "t"},
                                              [])})},
                                        {pexp_desc =
                                          Pexp_constraint
                                           ({pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident ">>="}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Ldot
                                                           (Lident "AO_store",
                                                           "create")}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_construct
                                                         ({txt = Lident "()"},
                                                         None)})])});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_fun (Nolabel, None,
                                                    {ppat_desc =
                                                      Ppat_var
                                                       {txt = "ao_store"}},
                                                    {pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident ">>="}},
                                                       [(Nolabel,
                                                         {pexp_desc =
                                                           Pexp_apply
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Ldot
                                                                   (Lident
                                                                    "AO_store",
                                                                   "find")}},
                                                            [(Nolabel,
                                                              {pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "ao_store"}});
                                                             (Nolabel,
                                                              {pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident "k"}})])});
                                                        (Nolabel,
                                                         {pexp_desc =
                                                           Pexp_fun (Nolabel,
                                                            None,
                                                            {ppat_desc =
                                                              Ppat_var
                                                               {txt = "t"}},
                                                            {pexp_desc =
                                                              Pexp_let
                                                               (Nonrecursive,
                                                               [{pvb_pat =
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t"}};
                                                                 pvb_expr =
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "from_just"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}})])}}],
                                                               {pexp_desc =
                                                                 Pexp_match
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t"}},
                                                                  [{pc_lhs =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "N"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "r"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "r"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "g"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "g"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "b"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "b"}})],
                                                                    Closed)})};
                                                                    pc_guard
                                                                    = None;
                                                                    pc_rhs =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "@@"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "OM",
                                                                    "N")},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "r"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "r"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "g"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "g"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "b"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "b"}})],
                                                                    None)})})])}};
                                                                   {pc_lhs =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "B"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "tl_t"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "tl_t"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "tr_t"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "tr_t"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "bl_t"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "bl_t"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "br_t"},
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "br_t"}})],
                                                                    Closed)})};
                                                                    pc_guard
                                                                    = None;
                                                                    pc_rhs =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "to_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "tl_t"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "tl_t'"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "to_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "tr_t"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "tr_t'"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "to_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "bl_t"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "bl_t'"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "to_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "br_t"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "br_t'"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "OM",
                                                                    "tl_t")},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "tl_t'"}});
                                                                    ({txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "OM",
                                                                    "tr_t")},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "tr_t'"}});
                                                                    ({txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "OM",
                                                                    "bl_t")},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "bl_t'"}});
                                                                    ({txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "OM",
                                                                    "br_t")},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "br_t'"}})],
                                                                    None)})])})})])})})])})})])})})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "n"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "@@"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "OM",
                                                                    "B")},
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "n"}})})])})})])}}])})})})])})})])},
                                           {ptyp_desc =
                                             Ptyp_constr
                                              ({txt =
                                                 Ldot (Lident "Lwt", "t")},
                                              [{ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt =
                                                     Ldot (Lident "OM", "t")},
                                                  [])}])})})}}])};
                               {pstr_desc =
                                 Pstr_value (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "t"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_ident
                                        {txt = Ldot (Lident "K", "t")}}}])};
                               {pstr_desc =
                                 Pstr_value (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "pp"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_ident
                                        {txt = Ldot (Lident "K", "pp")}}}])};
                               {pstr_desc =
                                 Pstr_value (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc =
                                       Ppat_var {txt = "of_string"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_ident
                                        {txt = Ldot (Lident "K", "of_string")}}}])};
                               {pstr_desc =
                                 Pstr_value (Recursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "merge"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_fun (Labelled "old", None,
                                        {ppat_desc =
                                          Ppat_constraint
                                           ({ppat_desc =
                                              Ppat_var {txt = "old"}},
                                           {ptyp_desc =
                                             Ptyp_constr
                                              ({txt =
                                                 Ldot
                                                  (Ldot (Lident "Irmin",
                                                    "Merge"),
                                                  "promise")},
                                              [{ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt = Lident "t"}, 
                                                  [])}])})},
                                        {pexp_desc =
                                          Pexp_fun (Nolabel, None,
                                           {ppat_desc =
                                             Ppat_var {txt = "v1_k"}},
                                           {pexp_desc =
                                             Pexp_fun (Nolabel, None,
                                              {ppat_desc =
                                                Ppat_var {txt = "v2_k"}},
                                              {pexp_desc =
                                                Pexp_open (Fresh,
                                                 {txt =
                                                   Ldot
                                                    (Ldot (Lident "Irmin",
                                                      "Merge"),
                                                    "Infix")},
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt = Lident ">>=*"}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident "old"}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_construct
                                                              ({txt =
                                                                 Lident "()"},
                                                              None)})])});
                                                     (Nolabel,
                                                      {pexp_desc =
                                                        Pexp_fun (Nolabel,
                                                         None,
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "old_k"}},
                                                         {pexp_desc =
                                                           Pexp_let
                                                            (Nonrecursive,
                                                            [{pvb_pat =
                                                               {ppat_desc =
                                                                 Ppat_var
                                                                  {txt =
                                                                    "old_k"}};
                                                              pvb_expr =
                                                               {pexp_desc =
                                                                 Pexp_apply
                                                                  ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "from_just"}},
                                                                  [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "old_k"}})])}}],
                                                            {pexp_desc =
                                                              Pexp_apply
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    ">>="}},
                                                               [(Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "to_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "old_k"}})])});
                                                                (Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "oldv"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "to_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v1_k"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v1"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "to_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v2_k"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v2"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "OM",
                                                                    "merge")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "oldv"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v1"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v2"}})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "of_adt"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "merged_k"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Ldot
                                                                    (Lident
                                                                    "Irmin",
                                                                    "Merge"),
                                                                    "ok")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "merged_k"}})])})})])})})})])})})])})})])})})})])})})})})}}])};
                               {pstr_desc =
                                 Pstr_value (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "merge"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_open (Fresh,
                                        {txt = Ldot (Lident "Irmin", "Merge")},
                                        {pexp_desc =
                                          Pexp_apply
                                           ({pexp_desc =
                                              Pexp_ident
                                               {txt = Lident "option"}},
                                           [(Nolabel,
                                             {pexp_desc =
                                               Pexp_apply
                                                ({pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "v"}},
                                                [(Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "t"}});
                                                 (Nolabel,
                                                  {pexp_desc =
                                                    Pexp_ident
                                                     {txt = Lident "merge"}})])})])})}}])}]}}};
                      {pstr_desc =
                        Pstr_module
                         {pmb_name = {txt = "BC_store"};
                          pmb_expr =
                           {pmod_desc =
                             Pmod_structure
                              [{pstr_desc =
                                 Pstr_module
                                  {pmb_name = {txt = "Store"};
                                   pmb_expr =
                                    {pmod_desc =
                                      Pmod_apply
                                       ({pmod_desc =
                                          Pmod_ident
                                           {txt =
                                             Ldot
                                              (Ldot
                                                (Ldot (Lident "Irmin_unix",
                                                  "Git"),
                                                "FS"),
                                              "KV")}},
                                       {pmod_desc =
                                         Pmod_ident {txt = Lident "M"}})}}};
                               {pstr_desc =
                                 Pstr_module
                                  {pmb_name = {txt = "Sync"};
                                   pmb_expr =
                                    {pmod_desc =
                                      Pmod_apply
                                       ({pmod_desc =
                                          Pmod_ident
                                           {txt =
                                             Ldot (Lident "Irmin", "Sync")}},
                                       {pmod_desc =
                                         Pmod_ident {txt = Lident "Store"}})}}};
                               {pstr_desc =
                                 Pstr_type (Recursive,
                                  [{ptype_name = {txt = "t"};
                                    ptype_params = []; ptype_cstrs = [];
                                    ptype_kind = Ptype_abstract;
                                    ptype_private = Public;
                                    ptype_manifest =
                                     Some
                                      {ptyp_desc =
                                        Ptyp_constr
                                         ({txt = Ldot (Lident "Store", "t")},
                                         [])}}])};
                               {pstr_desc =
                                 Pstr_value (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "init"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_fun (Optional "root", None,
                                        {ppat_desc = Ppat_var {txt = "root"}},
                                        {pexp_desc =
                                          Pexp_fun (Optional "bare", None,
                                           {ppat_desc =
                                             Ppat_var {txt = "bare"}},
                                           {pexp_desc =
                                             Pexp_fun (Nolabel, None,
                                              {ppat_desc =
                                                Ppat_construct
                                                 ({txt = Lident "()"}, None)},
                                              {pexp_desc =
                                                Pexp_let (Nonrecursive,
                                                 [{pvb_pat =
                                                    {ppat_desc =
                                                      Ppat_var
                                                       {txt = "config"}};
                                                   pvb_expr =
                                                    {pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Ldot
                                                              (Lident
                                                                "Irmin_git",
                                                              "config")}},
                                                       [(Nolabel,
                                                         {pexp_desc =
                                                           Pexp_ident
                                                            {txt =
                                                              Ldot
                                                               (Lident
                                                                 "Config",
                                                               "root")}})])}}],
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Ldot
                                                           (Ldot
                                                             (Lident "Store",
                                                             "Repo"),
                                                           "v")}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_ident
                                                         {txt =
                                                           Lident "config"}})])})})})})}}])};
                               {pstr_desc =
                                 Pstr_value (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "master"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc =
                                          Ppat_constraint
                                           ({ppat_desc =
                                              Ppat_var {txt = "repo"}},
                                           {ptyp_desc =
                                             Ptyp_constr
                                              ({txt =
                                                 Ldot (Lident "Store",
                                                  "repo")},
                                              [])})},
                                        {pexp_desc =
                                          Pexp_apply
                                           ({pexp_desc =
                                              Pexp_ident
                                               {txt =
                                                 Ldot (Lident "Store",
                                                  "master")}},
                                           [(Nolabel,
                                             {pexp_desc =
                                               Pexp_ident
                                                {txt = Lident "repo"}})])})}}])};
                               {pstr_desc =
                                 Pstr_value (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "clone"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc = Ppat_var {txt = "t"}},
                                        {pexp_desc =
                                          Pexp_fun (Nolabel, None,
                                           {ppat_desc =
                                             Ppat_var {txt = "name"}},
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt =
                                                    Ldot (Lident "Store",
                                                     "clone")}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "t"}});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "name"}})])})})}}])};
                               {pstr_desc =
                                 Pstr_value (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc =
                                       Ppat_var {txt = "get_branch"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc = Ppat_var {txt = "r"}},
                                        {pexp_desc =
                                          Pexp_fun (Labelled "branch_name",
                                           None,
                                           {ppat_desc =
                                             Ppat_var {txt = "branch_name"}},
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt =
                                                    Ldot (Lident "Store",
                                                     "of_branch")}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "r"}});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt =
                                                     Lident "branch_name"}})])})})}}])};
                               {pstr_desc =
                                 Pstr_value (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "merge"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc = Ppat_var {txt = "s"}},
                                        {pexp_desc =
                                          Pexp_fun (Labelled "into", None,
                                           {ppat_desc =
                                             Ppat_var {txt = "into"}},
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt =
                                                    Ldot (Lident "Store",
                                                     "merge")}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "s"}});
                                               (Labelled "into",
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "into"}})])})})}}])};
                               {pstr_desc =
                                 Pstr_value (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "update"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc = Ppat_var {txt = "t"}},
                                        {pexp_desc =
                                          Pexp_fun (Nolabel, None,
                                           {ppat_desc = Ppat_var {txt = "k"}},
                                           {pexp_desc =
                                             Pexp_fun (Nolabel, None,
                                              {ppat_desc =
                                                Ppat_var {txt = "v"}},
                                              {pexp_desc =
                                                Pexp_apply
                                                 ({pexp_desc =
                                                    Pexp_ident
                                                     {txt =
                                                       Ldot (Lident "Store",
                                                        "set")}},
                                                 [(Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "t"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "k"}});
                                                  (Nolabel,
                                                   {pexp_desc =
                                                     Pexp_ident
                                                      {txt = Lident "v"}})])})})})}}])};
                               {pstr_desc =
                                 Pstr_value (Nonrecursive,
                                  [{pvb_pat =
                                     {ppat_desc = Ppat_var {txt = "read"}};
                                    pvb_expr =
                                     {pexp_desc =
                                       Pexp_fun (Nolabel, None,
                                        {ppat_desc = Ppat_var {txt = "t"}},
                                        {pexp_desc =
                                          Pexp_fun (Nolabel, None,
                                           {ppat_desc = Ppat_var {txt = "k"}},
                                           {pexp_desc =
                                             Pexp_apply
                                              ({pexp_desc =
                                                 Pexp_ident
                                                  {txt =
                                                    Ldot (Lident "Store",
                                                     "find")}},
                                              [(Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "t"}});
                                               (Nolabel,
                                                {pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident "k"}})])})})}}])}]}}};
                      {pstr_desc =
                        Pstr_module
                         {pmb_name = {txt = "Vpst"};
                          pmb_expr =
                           {pmod_desc =
                             Pmod_constraint
                              ({pmod_desc =
                                 Pmod_structure
                                  [{pstr_desc =
                                     Pstr_type (Recursive,
                                      [{ptype_name = {txt = "store"};
                                        ptype_params = []; ptype_cstrs = [];
                                        ptype_kind = Ptype_abstract;
                                        ptype_private = Public;
                                        ptype_manifest =
                                         Some
                                          {ptyp_desc =
                                            Ptyp_constr
                                             ({txt =
                                                Ldot (Lident "BC_store", "t")},
                                             [])}}])};
                                   {pstr_desc =
                                     Pstr_type (Recursive,
                                      [{ptype_name = {txt = "st"};
                                        ptype_params = []; ptype_cstrs = [];
                                        ptype_kind =
                                         Ptype_record
                                          [{pld_name = {txt = "master"};
                                            pld_mutable = Immutable;
                                            pld_type =
                                             {ptyp_desc =
                                               Ptyp_constr
                                                ({txt = Lident "store"}, 
                                                [])}};
                                           {pld_name = {txt = "local"};
                                            pld_mutable = Immutable;
                                            pld_type =
                                             {ptyp_desc =
                                               Ptyp_constr
                                                ({txt = Lident "store"}, 
                                                [])}};
                                           {pld_name = {txt = "name"};
                                            pld_mutable = Immutable;
                                            pld_type =
                                             {ptyp_desc =
                                               Ptyp_constr
                                                ({txt = Lident "string"}, 
                                                [])}};
                                           {pld_name = {txt = "next_id"};
                                            pld_mutable = Immutable;
                                            pld_type =
                                             {ptyp_desc =
                                               Ptyp_constr
                                                ({txt = Lident "int"}, 
                                                [])}}];
                                        ptype_private = Public;
                                        ptype_manifest = None}])};
                                   {pstr_desc =
                                     Pstr_type (Recursive,
                                      [{ptype_name = {txt = "t"};
                                        ptype_params =
                                         [({ptyp_desc = Ptyp_var "a"},
                                           Invariant)];
                                        ptype_cstrs = [];
                                        ptype_kind = Ptype_abstract;
                                        ptype_private = Public;
                                        ptype_manifest =
                                         Some
                                          {ptyp_desc =
                                            Ptyp_arrow (Nolabel,
                                             {ptyp_desc =
                                               Ptyp_constr
                                                ({txt = Lident "st"}, 
                                                [])},
                                             {ptyp_desc =
                                               Ptyp_constr
                                                ({txt =
                                                   Ldot (Lident "Lwt", "t")},
                                                [{ptyp_desc =
                                                   Ptyp_tuple
                                                    [{ptyp_desc =
                                                       Ptyp_var "a"};
                                                     {ptyp_desc =
                                                       Ptyp_constr
                                                        ({txt = Lident "st"},
                                                        [])}]}])})}}])};
                                   {pstr_desc =
                                     Pstr_value (Nonrecursive,
                                      [{pvb_pat =
                                         {ppat_desc = Ppat_var {txt = "info"}};
                                        pvb_expr =
                                         {pexp_desc =
                                           Pexp_fun (Nolabel, None,
                                            {ppat_desc = Ppat_var {txt = "s"}},
                                            {pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt =
                                                     Ldot
                                                      (Lident "Irmin_unix",
                                                      "info")}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_constant
                                                    (Pconst_string
                                                      ("[repo %s] %s", None))});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt =
                                                      Ldot (Lident "Config",
                                                       "root")}});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_ident
                                                    {txt = Lident "s"}})])})}}])};
                                   {pstr_desc =
                                     Pstr_value (Nonrecursive,
                                      [{pvb_pat =
                                         {ppat_desc = Ppat_var {txt = "path"}};
                                        pvb_expr =
                                         {pexp_desc =
                                           Pexp_construct
                                            ({txt = Lident "::"},
                                            Some
                                             {pexp_desc =
                                               Pexp_tuple
                                                [{pexp_desc =
                                                   Pexp_constant
                                                    (Pconst_string ("state",
                                                      None))};
                                                 {pexp_desc =
                                                   Pexp_construct
                                                    ({txt = Lident "[]"},
                                                    None)}]})}}])};
                                   {pstr_desc =
                                     Pstr_value (Nonrecursive,
                                      [{pvb_pat =
                                         {ppat_desc =
                                           Ppat_var {txt = "return"}};
                                        pvb_expr =
                                         {pexp_desc =
                                           Pexp_fun (Nolabel, None,
                                            {ppat_desc =
                                              Ppat_constraint
                                               ({ppat_desc =
                                                  Ppat_var {txt = "x"}},
                                               {ptyp_desc = Ptyp_var "a"})},
                                            {pexp_desc =
                                              Pexp_constraint
                                               ({pexp_desc =
                                                  Pexp_fun (Nolabel, None,
                                                   {ppat_desc =
                                                     Ppat_var {txt = "st"}},
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt =
                                                            Ldot
                                                             (Lident "Lwt",
                                                             "return")}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_tuple
                                                           [{pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "x"}};
                                                            {pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Lident "st"}}]})])})},
                                               {ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt = Lident "t"},
                                                  [{ptyp_desc = Ptyp_var "a"}])})})}}])};
                                   {pstr_desc =
                                     Pstr_value (Nonrecursive,
                                      [{pvb_pat =
                                         {ppat_desc = Ppat_var {txt = "bind"}};
                                        pvb_expr =
                                         {pexp_desc =
                                           Pexp_fun (Nolabel, None,
                                            {ppat_desc =
                                              Ppat_constraint
                                               ({ppat_desc =
                                                  Ppat_var {txt = "m1"}},
                                               {ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt = Lident "t"},
                                                  [{ptyp_desc = Ptyp_var "a"}])})},
                                            {pexp_desc =
                                              Pexp_fun (Nolabel, None,
                                               {ppat_desc =
                                                 Ppat_constraint
                                                  ({ppat_desc =
                                                     Ppat_var {txt = "f"}},
                                                  {ptyp_desc =
                                                    Ptyp_arrow (Nolabel,
                                                     {ptyp_desc =
                                                       Ptyp_var "a"},
                                                     {ptyp_desc =
                                                       Ptyp_constr
                                                        ({txt = Lident "t"},
                                                        [{ptyp_desc =
                                                           Ptyp_var "b"}])})})},
                                               {pexp_desc =
                                                 Pexp_constraint
                                                  ({pexp_desc =
                                                     Pexp_fun (Nolabel, None,
                                                      {ppat_desc =
                                                        Ppat_var {txt = "st"}},
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident ">>="}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "m1"}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "st"}})])});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_fun
                                                              (Nolabel, None,
                                                              {ppat_desc =
                                                                Ppat_tuple
                                                                 [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "a"}};
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "st'"}}]},
                                                              {pexp_desc =
                                                                Pexp_apply
                                                                 ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "f"}},
                                                                 [(Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}});
                                                                  (Nolabel,
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st'"}})])})})])})},
                                                  {ptyp_desc =
                                                    Ptyp_constr
                                                     ({txt = Lident "t"},
                                                     [{ptyp_desc =
                                                        Ptyp_var "b"}])})})})}}])};
                                   {pstr_desc =
                                     Pstr_value (Nonrecursive,
                                      [{pvb_pat =
                                         {ppat_desc =
                                           Ppat_var
                                            {txt = "with_init_version_do"}};
                                        pvb_expr =
                                         {pexp_desc =
                                           Pexp_fun (Nolabel, None,
                                            {ppat_desc =
                                              Ppat_constraint
                                               ({ppat_desc =
                                                  Ppat_var {txt = "v"}},
                                               {ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt =
                                                     Ldot (Lident "OM", "t")},
                                                  [])})},
                                            {pexp_desc =
                                              Pexp_fun (Nolabel, None,
                                               {ppat_desc =
                                                 Ppat_constraint
                                                  ({ppat_desc =
                                                     Ppat_var {txt = "m"}},
                                                  {ptyp_desc =
                                                    Ptyp_constr
                                                     ({txt = Lident "t"},
                                                     [{ptyp_desc =
                                                        Ptyp_var "a"}])})},
                                               {pexp_desc =
                                                 Pexp_apply
                                                  ({pexp_desc =
                                                     Pexp_ident
                                                      {txt =
                                                        Ldot
                                                         (Lident "Lwt_main",
                                                         "run")}},
                                                  [(Nolabel,
                                                    {pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident ">>="}},
                                                       [(Nolabel,
                                                         {pexp_desc =
                                                           Pexp_apply
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Ldot
                                                                   (Lident
                                                                    "BC_store",
                                                                   "init")}},
                                                            [(Nolabel,
                                                              {pexp_desc =
                                                                Pexp_construct
                                                                 ({txt =
                                                                    Lident
                                                                    "()"},
                                                                 None)})])});
                                                        (Nolabel,
                                                         {pexp_desc =
                                                           Pexp_fun (Nolabel,
                                                            None,
                                                            {ppat_desc =
                                                              Ppat_var
                                                               {txt = "repo"}},
                                                            {pexp_desc =
                                                              Pexp_apply
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    ">>="}},
                                                               [(Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "master")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "repo"}})])});
                                                                (Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "m_br"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "M",
                                                                    "of_adt")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "k"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "cinfo"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("creating state of master",
                                                                    None))})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "update")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "path"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "k"}});
                                                                    (Labelled
                                                                    "info",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "()"},
                                                                    None)},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "clone")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("1_local",
                                                                    None))})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t_br"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "st"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "master"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "local"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "name"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("1",
                                                                    None))});
                                                                    ({txt =
                                                                    Lident
                                                                    "next_id"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})],
                                                                    None)}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "a"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any}]},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}})])})})])})})})])})})])})})})])})})])})})])})])})})}}])};
                                   {pstr_desc =
                                     Pstr_value (Nonrecursive,
                                      [{pvb_pat =
                                         {ppat_desc =
                                           Ppat_var
                                            {txt = "with_init_forked_do"}};
                                        pvb_expr =
                                         {pexp_desc =
                                           Pexp_fun (Nolabel, None,
                                            {ppat_desc =
                                              Ppat_constraint
                                               ({ppat_desc =
                                                  Ppat_var {txt = "m"}},
                                               {ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt = Lident "t"},
                                                  [{ptyp_desc = Ptyp_var "a"}])})},
                                            {pexp_desc =
                                              Pexp_apply
                                               ({pexp_desc =
                                                  Pexp_ident
                                                   {txt = Lident ">>="}},
                                               [(Nolabel,
                                                 {pexp_desc =
                                                   Pexp_apply
                                                    ({pexp_desc =
                                                       Pexp_ident
                                                        {txt =
                                                          Ldot
                                                           (Lident "BC_store",
                                                           "init")}},
                                                    [(Nolabel,
                                                      {pexp_desc =
                                                        Pexp_construct
                                                         ({txt = Lident "()"},
                                                         None)})])});
                                                (Nolabel,
                                                 {pexp_desc =
                                                   Pexp_fun (Nolabel, None,
                                                    {ppat_desc =
                                                      Ppat_var {txt = "repo"}},
                                                    {pexp_desc =
                                                      Pexp_apply
                                                       ({pexp_desc =
                                                          Pexp_ident
                                                           {txt =
                                                             Lident ">>="}},
                                                       [(Nolabel,
                                                         {pexp_desc =
                                                           Pexp_apply
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Ldot
                                                                   (Lident
                                                                    "BC_store",
                                                                   "master")}},
                                                            [(Nolabel,
                                                              {pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Lident
                                                                    "repo"}})])});
                                                        (Nolabel,
                                                         {pexp_desc =
                                                           Pexp_fun (Nolabel,
                                                            None,
                                                            {ppat_desc =
                                                              Ppat_var
                                                               {txt = "m_br"}},
                                                            {pexp_desc =
                                                              Pexp_apply
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    ">>="}},
                                                               [(Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "clone")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("1_local",
                                                                    None))})])});
                                                                (Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t_br"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "st"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "master"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "local"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "name"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("1",
                                                                    None))});
                                                                    ({txt =
                                                                    Lident
                                                                    "next_id"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})],
                                                                    None)}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_tuple
                                                                    [{ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "a"}};
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any}]},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}})])})})])})})})])})})])})})])})}}])};
                                   {pstr_desc =
                                     Pstr_value (Nonrecursive,
                                      [{pvb_pat =
                                         {ppat_desc =
                                           Ppat_var {txt = "fork_version"}};
                                        pvb_expr =
                                         {pexp_desc =
                                           Pexp_fun (Nolabel, None,
                                            {ppat_desc =
                                              Ppat_constraint
                                               ({ppat_desc =
                                                  Ppat_var {txt = "m"}},
                                               {ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt = Lident "t"},
                                                  [{ptyp_desc = Ptyp_var "a"}])})},
                                            {pexp_desc =
                                              Pexp_constraint
                                               ({pexp_desc =
                                                  Pexp_fun (Nolabel, None,
                                                   {ppat_desc =
                                                     Ppat_constraint
                                                      ({ppat_desc =
                                                         Ppat_var
                                                          {txt = "st"}},
                                                      {ptyp_desc =
                                                        Ptyp_constr
                                                         ({txt = Lident "st"},
                                                         [])})},
                                                   {pexp_desc =
                                                     Pexp_let (Nonrecursive,
                                                      [{pvb_pat =
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "thread_f"}};
                                                        pvb_expr =
                                                         {pexp_desc =
                                                           Pexp_fun (Nolabel,
                                                            None,
                                                            {ppat_desc =
                                                              Ppat_construct
                                                               ({txt =
                                                                  Lident "()"},
                                                               None)},
                                                            {pexp_desc =
                                                              Pexp_let
                                                               (Nonrecursive,
                                                               [{pvb_pat =
                                                                  {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "child_name"}};
                                                                 pvb_expr =
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "^"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "name"})});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "^"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("_",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "string_of_int"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "next_id"})})])})])})])}}],
                                                               {pexp_desc =
                                                                 Pexp_let
                                                                  (Nonrecursive,
                                                                  [{pvb_pat =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "parent_m_br"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "master"})}}],
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "m_br"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "parent_m_br"}}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "clone")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "^"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "child_name"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("_local",
                                                                    None))})])})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "t_br"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "new_st"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "master"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "local"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "t_br"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "name"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "child_name"}});
                                                                    ({txt =
                                                                    Lident
                                                                    "next_id"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})],
                                                                    None)}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "m"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "new_st"}})])})})})])})})})})}}],
                                                      {pexp_desc =
                                                        Pexp_sequence
                                                         ({pexp_desc =
                                                            Pexp_apply
                                                             ({pexp_desc =
                                                                Pexp_ident
                                                                 {txt =
                                                                   Ldot
                                                                    (
                                                                    Lident
                                                                    "Lwt",
                                                                    "async")}},
                                                             [(Nolabel,
                                                               {pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "thread_f"}})])},
                                                         {pexp_desc =
                                                           Pexp_apply
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Ldot
                                                                   (Lident
                                                                    "Lwt",
                                                                   "return")}},
                                                            [(Nolabel,
                                                              {pexp_desc =
                                                                Pexp_tuple
                                                                 [{pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "()"},
                                                                    None)};
                                                                  {pexp_desc
                                                                    =
                                                                    Pexp_record
                                                                    ([({txt =
                                                                    Lident
                                                                    "next_id"},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "+"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "next_id"})});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_integer
                                                                    ("1",
                                                                    None))})])})],
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}})}]})])})})})},
                                               {ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt = Lident "t"},
                                                  [{ptyp_desc =
                                                     Ptyp_constr
                                                      ({txt = Lident "unit"},
                                                      [])}])})})}}])};
                                   {pstr_desc =
                                     Pstr_value (Nonrecursive,
                                      [{pvb_pat =
                                         {ppat_desc =
                                           Ppat_var
                                            {txt = "get_latest_version"}};
                                        pvb_expr =
                                         {pexp_desc =
                                           Pexp_fun (Nolabel, None,
                                            {ppat_desc =
                                              Ppat_construct
                                               ({txt = Lident "()"}, None)},
                                            {pexp_desc =
                                              Pexp_constraint
                                               ({pexp_desc =
                                                  Pexp_fun (Nolabel, None,
                                                   {ppat_desc =
                                                     Ppat_constraint
                                                      ({ppat_desc =
                                                         Ppat_var
                                                          {txt = "st"}},
                                                      {ptyp_desc =
                                                        Ptyp_constr
                                                         ({txt = Lident "st"},
                                                         [])})},
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident ">>="}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_apply
                                                           ({pexp_desc =
                                                              Pexp_ident
                                                               {txt =
                                                                 Ldot
                                                                  (Lident
                                                                    "BC_store",
                                                                  "read")}},
                                                           [(Nolabel,
                                                             {pexp_desc =
                                                               Pexp_field
                                                                ({pexp_desc =
                                                                   Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                {txt =
                                                                  Lident
                                                                   "local"})});
                                                            (Nolabel,
                                                             {pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "path"}})])});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_fun (Nolabel,
                                                           None,
                                                           {ppat_desc =
                                                             Ppat_var
                                                              {txt = "k"}},
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    ">>="}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_apply
                                                                   ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "@@"}},
                                                                   [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "M",
                                                                    "to_adt")}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "from_just"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "k"}})])})])});
                                                               (Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_fun
                                                                   (Nolabel,
                                                                   None,
                                                                   {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "td"}},
                                                                   {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_tuple
                                                                    [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "td"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}}]})])})})])})})])})},
                                               {ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt = Lident "t"},
                                                  [{ptyp_desc =
                                                     Ptyp_constr
                                                      ({txt =
                                                         Ldot (Lident "OM",
                                                          "t")},
                                                      [])}])})})}}])};
                                   {pstr_desc =
                                     Pstr_value (Nonrecursive,
                                      [{pvb_pat =
                                         {ppat_desc =
                                           Ppat_var
                                            {txt = "sync_remote_version"}};
                                        pvb_expr =
                                         {pexp_desc =
                                           Pexp_fun (Nolabel, None,
                                            {ppat_desc =
                                              Ppat_var {txt = "remote_uri"}},
                                            {pexp_desc =
                                              Pexp_fun (Optional "v", None,
                                               {ppat_desc =
                                                 Ppat_var {txt = "v"}},
                                               {pexp_desc =
                                                 Pexp_constraint
                                                  ({pexp_desc =
                                                     Pexp_fun (Nolabel, None,
                                                      {ppat_desc =
                                                        Ppat_constraint
                                                         ({ppat_desc =
                                                            Ppat_var
                                                             {txt = "st"}},
                                                         {ptyp_desc =
                                                           Ptyp_constr
                                                            ({txt =
                                                               Lident "st"},
                                                            [])})},
                                                      {pexp_desc =
                                                        Pexp_let
                                                         (Nonrecursive,
                                                         [{pvb_pat =
                                                            {ppat_desc =
                                                              Ppat_var
                                                               {txt = "cinfo"}};
                                                           pvb_expr =
                                                            {pexp_desc =
                                                              Pexp_apply
                                                               ({pexp_desc =
                                                                  Pexp_ident
                                                                   {txt =
                                                                    Lident
                                                                    "info"}},
                                                               [(Nolabel,
                                                                 {pexp_desc =
                                                                   Pexp_constant
                                                                    (Pconst_string
                                                                    ("committing local state",
                                                                    None))})])}}],
                                                         {pexp_desc =
                                                           Pexp_apply
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   ">>="}},
                                                            [(Nolabel,
                                                              {pexp_desc =
                                                                Pexp_match
                                                                 ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}},
                                                                 [{pc_lhs =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "None"},
                                                                    None)};
                                                                   pc_guard =
                                                                    None;
                                                                   pc_rhs =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "()"},
                                                                    None)})])}};
                                                                  {pc_lhs =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "Some"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v"}})};
                                                                   pc_guard =
                                                                    None;
                                                                   pc_rhs =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "M",
                                                                    "of_adt")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "k"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "update")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "path"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "k"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])})})])}}])});
                                                             (Nolabel,
                                                              {pexp_desc =
                                                                Pexp_fun
                                                                 (Nolabel,
                                                                 None,
                                                                 {ppat_desc =
                                                                   Ppat_construct
                                                                    (
                                                                    {txt =
                                                                    Lident
                                                                    "()"},
                                                                    None)},
                                                                 {pexp_desc =
                                                                   Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "cinfo"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Printf",
                                                                    "sprintf")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("Merging remote: %s",
                                                                    None))});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "remote_uri"}})])})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "Sync"),
                                                                    "pull")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "master"})});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Irmin",
                                                                    "remote_uri")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "remote_uri"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_variant
                                                                    ("Merge",
                                                                    Some
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "cinfo"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("Merging master into local",
                                                                    None))})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "merge")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "master"})});
                                                                    (Labelled
                                                                    "into",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Labelled
                                                                    "info",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "cinfo"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("Merging local into master",
                                                                    None))})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "merge")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Labelled
                                                                    "into",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "master"})});
                                                                    (Labelled
                                                                    "info",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "get_latest_version"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "()"},
                                                                    None)});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}})])})})])})})})])})})})])})})})])})})},
                                                  {ptyp_desc =
                                                    Ptyp_constr
                                                     ({txt = Lident "t"},
                                                     [{ptyp_desc =
                                                        Ptyp_constr
                                                         ({txt =
                                                            Ldot
                                                             (Lident "OM",
                                                             "t")},
                                                         [])}])})})})}}])};
                                   {pstr_desc =
                                     Pstr_value (Nonrecursive,
                                      [{pvb_pat =
                                         {ppat_desc =
                                           Ppat_var
                                            {txt = "sync_next_version"}};
                                        pvb_expr =
                                         {pexp_desc =
                                           Pexp_fun (Optional "v", None,
                                            {ppat_desc = Ppat_var {txt = "v"}},
                                            {pexp_desc =
                                              Pexp_constraint
                                               ({pexp_desc =
                                                  Pexp_fun (Nolabel, None,
                                                   {ppat_desc =
                                                     Ppat_constraint
                                                      ({ppat_desc =
                                                         Ppat_var
                                                          {txt = "st"}},
                                                      {ptyp_desc =
                                                        Ptyp_constr
                                                         ({txt = Lident "st"},
                                                         [])})},
                                                   {pexp_desc =
                                                     Pexp_let (Nonrecursive,
                                                      [{pvb_pat =
                                                         {ppat_desc =
                                                           Ppat_var
                                                            {txt = "cinfo"}};
                                                        pvb_expr =
                                                         {pexp_desc =
                                                           Pexp_apply
                                                            ({pexp_desc =
                                                               Pexp_ident
                                                                {txt =
                                                                  Lident
                                                                   "info"}},
                                                            [(Nolabel,
                                                              {pexp_desc =
                                                                Pexp_constant
                                                                 (Pconst_string
                                                                   ("committing local state",
                                                                   None))})])}}],
                                                      {pexp_desc =
                                                        Pexp_apply
                                                         ({pexp_desc =
                                                            Pexp_ident
                                                             {txt =
                                                               Lident ">>="}},
                                                         [(Nolabel,
                                                           {pexp_desc =
                                                             Pexp_match
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Lident
                                                                    "v"}},
                                                              [{pc_lhs =
                                                                 {ppat_desc =
                                                                   Ppat_construct
                                                                    (
                                                                    {txt =
                                                                    Lident
                                                                    "None"},
                                                                    None)};
                                                                pc_guard =
                                                                 None;
                                                                pc_rhs =
                                                                 {pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "()"},
                                                                    None)})])}};
                                                               {pc_lhs =
                                                                 {ppat_desc =
                                                                   Ppat_construct
                                                                    (
                                                                    {txt =
                                                                    Lident
                                                                    "Some"},
                                                                    Some
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "v"}})};
                                                                pc_guard =
                                                                 None;
                                                                pc_rhs =
                                                                 {pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "M",
                                                                    "of_adt")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "v"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "k"}},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "update")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "path"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "k"}});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])})})])}}])});
                                                          (Nolabel,
                                                           {pexp_desc =
                                                             Pexp_fun
                                                              (Nolabel, None,
                                                              {ppat_desc =
                                                                Ppat_construct
                                                                 ({txt =
                                                                    Lident
                                                                    "()"},
                                                                 None)},
                                                              {pexp_desc =
                                                                Pexp_let
                                                                 (Nonrecursive,
                                                                 [{pvb_pat =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "cinfo"}};
                                                                   pvb_expr =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("Merging master into local",
                                                                    None))})])}}],
                                                                 {pexp_desc =
                                                                   Pexp_apply
                                                                    (
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "merge")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "master"})});
                                                                    (Labelled
                                                                    "into",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Labelled
                                                                    "info",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_let
                                                                    (Nonrecursive,
                                                                    [{pvb_pat
                                                                    =
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_var
                                                                    {txt =
                                                                    "cinfo"}};
                                                                    pvb_expr
                                                                    =
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "info"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_constant
                                                                    (Pconst_string
                                                                    ("Merging local into master",
                                                                    None))})])}}],
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    ">>="}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "BC_store",
                                                                    "merge")}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "local"})});
                                                                    (Labelled
                                                                    "into",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_field
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}},
                                                                    {txt =
                                                                    Lident
                                                                    "master"})});
                                                                    (Labelled
                                                                    "info",
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "cinfo"}})])});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_fun
                                                                    (Nolabel,
                                                                    None,
                                                                    {ppat_desc
                                                                    =
                                                                    Ppat_any},
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_apply
                                                                    ({pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "get_latest_version"}},
                                                                    [(Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_construct
                                                                    ({txt =
                                                                    Lident
                                                                    "()"},
                                                                    None)});
                                                                    (Nolabel,
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}})])})})])})})})])})})})])})})},
                                               {ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt = Lident "t"},
                                                  [{ptyp_desc =
                                                     Ptyp_constr
                                                      ({txt =
                                                         Ldot (Lident "OM",
                                                          "t")},
                                                      [])}])})})}}])};
                                   {pstr_desc =
                                     Pstr_value (Nonrecursive,
                                      [{pvb_pat =
                                         {ppat_desc =
                                           Ppat_var {txt = "liftLwt"}};
                                        pvb_expr =
                                         {pexp_desc =
                                           Pexp_fun (Nolabel, None,
                                            {ppat_desc =
                                              Ppat_constraint
                                               ({ppat_desc =
                                                  Ppat_var {txt = "m"}},
                                               {ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt =
                                                     Ldot (Lident "Lwt", "t")},
                                                  [{ptyp_desc = Ptyp_var "a"}])})},
                                            {pexp_desc =
                                              Pexp_constraint
                                               ({pexp_desc =
                                                  Pexp_fun (Nolabel, None,
                                                   {ppat_desc =
                                                     Ppat_var {txt = "st"}},
                                                   {pexp_desc =
                                                     Pexp_apply
                                                      ({pexp_desc =
                                                         Pexp_ident
                                                          {txt = Lident ">>="}},
                                                      [(Nolabel,
                                                        {pexp_desc =
                                                          Pexp_ident
                                                           {txt = Lident "m"}});
                                                       (Nolabel,
                                                        {pexp_desc =
                                                          Pexp_fun (Nolabel,
                                                           None,
                                                           {ppat_desc =
                                                             Ppat_var
                                                              {txt = "a"}},
                                                           {pexp_desc =
                                                             Pexp_apply
                                                              ({pexp_desc =
                                                                 Pexp_ident
                                                                  {txt =
                                                                    Ldot
                                                                    (Lident
                                                                    "Lwt",
                                                                    "return")}},
                                                              [(Nolabel,
                                                                {pexp_desc =
                                                                  Pexp_tuple
                                                                   [{pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "a"}};
                                                                    {pexp_desc
                                                                    =
                                                                    Pexp_ident
                                                                    {txt =
                                                                    Lident
                                                                    "st"}}]})])})})])})},
                                               {ptyp_desc =
                                                 Ptyp_constr
                                                  ({txt = Lident "t"},
                                                  [{ptyp_desc = Ptyp_var "a"}])})})}}])}]},
                              {pmty_desc =
                                Pmty_signature
                                 [{psig_desc =
                                    Psig_type (Recursive,
                                     [{ptype_name = {txt = "t"};
                                       ptype_params =
                                        [({ptyp_desc = Ptyp_var "a"},
                                          Invariant)];
                                       ptype_cstrs = [];
                                       ptype_kind = Ptype_abstract;
                                       ptype_private = Public;
                                       ptype_manifest = None}])};
                                  {psig_desc =
                                    Psig_value
                                     {pval_name = {txt = "return"};
                                      pval_type =
                                       {ptyp_desc =
                                         Ptyp_arrow (Nolabel,
                                          {ptyp_desc = Ptyp_var "a"},
                                          {ptyp_desc =
                                            Ptyp_constr ({txt = Lident "t"},
                                             [{ptyp_desc = Ptyp_var "a"}])})};
                                      pval_prim = []}};
                                  {psig_desc =
                                    Psig_value
                                     {pval_name = {txt = "bind"};
                                      pval_type =
                                       {ptyp_desc =
                                         Ptyp_arrow (Nolabel,
                                          {ptyp_desc =
                                            Ptyp_constr ({txt = Lident "t"},
                                             [{ptyp_desc = Ptyp_var "a"}])},
                                          {ptyp_desc =
                                            Ptyp_arrow (Nolabel,
                                             {ptyp_desc =
                                               Ptyp_arrow (Nolabel,
                                                {ptyp_desc = Ptyp_var "a"},
                                                {ptyp_desc =
                                                  Ptyp_constr
                                                   ({txt = Lident "t"},
                                                   [{ptyp_desc = Ptyp_var "b"}])})},
                                             {ptyp_desc =
                                               Ptyp_constr
                                                ({txt = Lident "t"},
                                                [{ptyp_desc = Ptyp_var "b"}])})})};
                                      pval_prim = []}};
                                  {psig_desc =
                                    Psig_value
                                     {pval_name =
                                       {txt = "with_init_version_do"};
                                      pval_type =
                                       {ptyp_desc =
                                         Ptyp_arrow (Nolabel,
                                          {ptyp_desc =
                                            Ptyp_constr
                                             ({txt = Ldot (Lident "OM", "t")},
                                             [])},
                                          {ptyp_desc =
                                            Ptyp_arrow (Nolabel,
                                             {ptyp_desc =
                                               Ptyp_constr
                                                ({txt = Lident "t"},
                                                [{ptyp_desc = Ptyp_var "a"}])},
                                             {ptyp_desc = Ptyp_var "a"})})};
                                      pval_prim = []}};
                                  {psig_desc =
                                    Psig_value
                                     {pval_name = {txt = "fork_version"};
                                      pval_type =
                                       {ptyp_desc =
                                         Ptyp_arrow (Nolabel,
                                          {ptyp_desc =
                                            Ptyp_constr ({txt = Lident "t"},
                                             [{ptyp_desc = Ptyp_var "a"}])},
                                          {ptyp_desc =
                                            Ptyp_constr ({txt = Lident "t"},
                                             [{ptyp_desc =
                                                Ptyp_constr
                                                 ({txt = Lident "unit"}, 
                                                 [])}])})};
                                      pval_prim = []}};
                                  {psig_desc =
                                    Psig_value
                                     {pval_name =
                                       {txt = "get_latest_version"};
                                      pval_type =
                                       {ptyp_desc =
                                         Ptyp_arrow (Nolabel,
                                          {ptyp_desc =
                                            Ptyp_constr
                                             ({txt = Lident "unit"}, 
                                             [])},
                                          {ptyp_desc =
                                            Ptyp_constr ({txt = Lident "t"},
                                             [{ptyp_desc =
                                                Ptyp_constr
                                                 ({txt =
                                                    Ldot (Lident "OM", "t")},
                                                 [])}])})};
                                      pval_prim = []}};
                                  {psig_desc =
                                    Psig_value
                                     {pval_name = {txt = "sync_next_version"};
                                      pval_type =
                                       {ptyp_desc =
                                         Ptyp_arrow (Optional "v",
                                          {ptyp_desc =
                                            Ptyp_constr
                                             ({txt = Ldot (Lident "OM", "t")},
                                             [])},
                                          {ptyp_desc =
                                            Ptyp_constr ({txt = Lident "t"},
                                             [{ptyp_desc =
                                                Ptyp_constr
                                                 ({txt =
                                                    Ldot (Lident "OM", "t")},
                                                 [])}])})};
                                      pval_prim = []}};
                                  {psig_desc =
                                    Psig_value
                                     {pval_name = {txt = "liftLwt"};
                                      pval_type =
                                       {ptyp_desc =
                                         Ptyp_arrow (Nolabel,
                                          {ptyp_desc =
                                            Ptyp_constr
                                             ({txt = Ldot (Lident "Lwt", "t")},
                                             [{ptyp_desc = Ptyp_var "a"}])},
                                          {ptyp_desc =
                                            Ptyp_constr ({txt = Lident "t"},
                                             [{ptyp_desc = Ptyp_var "a"}])})};
                                      pval_prim = []}}]})}}}]})}}}]}}}]
=========
